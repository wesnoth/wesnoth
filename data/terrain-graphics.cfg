
# The following flags are defined to have a meaning
#
# * terrain-$name : the corresponding tile has already graphics for the terrain
# named $name. No other one should be added.
# * transition-$direction : the corresponding tile already has the transition
# in the given direction (or should not have one). No other one should be
# added.
# * keep-of-$castle : castle being a tile letter. The corresponding tile is the
# keep correspoding to the given castle tile

# Use the following layers:
# -1000                : terrain base graphics
# -200 to -101         : stacked flat adjacent transitions
# -100                 : buildings
# -80                  : "northern" transitions
# -50                  : castle walls
# -30                  : castle transitions

# Loads the macros used in the file
{terrain-graphics}

# Castle-specific transitions. Those are placed before base terrains, as they
# override the normal base terrain.
{CASTLE_TRANSITION CK f dirt forest-ctrans}
#Special cases for encampment (nw, nw-n-ne and ne)
{CASTLE_TRANSITION nK f dark_grass forest-etrans}
#On the rest fall back on forest-castle
{CASTLE_TRANSITION nK f dark_grass forest-ctrans}

#
# Attachs graphics to each known terrain types
#

{TERRAIN_BASE_PROBABILITY     u cave-floor4         10}
{TERRAIN_BASE_PROBABILITY     u cave-floor3         2}
{TERRAIN_BASE_PROBABILITY     u cave-floor2         10}
{TERRAIN_BASE                 u cave-floor1}
{TERRAIN_BASE                 W cavewall}
{TERRAIN_BASE                 F snow-forest}
{TERRAIN_BASE_PROBABILITY     f forest2             10}
{TERRAIN_BASE_PROBABILITY     f forest3             10}
{TERRAIN_BASE_PROBABILITY     f forest4             10}
{TERRAIN_BASE_PROBABILITY     f forest5             10}
{TERRAIN_BASE_PROBABILITY     f forest6             10}
{TERRAIN_BASE_PROBABILITY     f forest7             10}
{TERRAIN_BASE_PROBABILITY     f forest8             10}
{TERRAIN_BASE_PROBABILITY     f forest-stones1      1}
{TERRAIN_BASE_PROBABILITY     f forest-stones2      2}
{TERRAIN_BASE_PROBABILITY     f forest-stones3      1}
{TERRAIN_BASE_PROBABILITY     f forest-stones4      1}
{TERRAIN_BASE                 f forest}
{TERRAIN_BASE_PROBABILITY     m mountains-peak1     33}
{TERRAIN_BASE_PROBABILITY     m mountains-peak2     33}
{TERRAIN_BASE                 m mountains}
{TERRAIN_BASE                 H snow-hills}
{TERRAIN_BASE_PROBABILITY     h hills-variation1    15}
{TERRAIN_BASE_PROBABILITY     h hills-variation2    15}
{TERRAIN_BASE_PROBABILITY     h hills-variation3    30}
{TERRAIN_BASE                 h hills}
{TERRAIN_BASE_PROBABILITY     S snow2 30}
{TERRAIN_BASE_PROBABILITY     S snow3 30}
{TERRAIN_BASE                 S snow}
{TERRAIN_BASE_PROBABILITY     g grassland-rocks1    2}
{TERRAIN_BASE_PROBABILITY     g grassland-rocks2    2}
{TERRAIN_BASE_PROBABILITY     g grassland-flowers1  3}
{TERRAIN_BASE_PROBABILITY     g grassland-flowers2  3}
{TERRAIN_BASE_PROBABILITY     g grassland-r1 20}
{TERRAIN_BASE_PROBABILITY     g grassland-r2 20}
{TERRAIN_BASE_PROBABILITY     g grassland-r3 20}
{TERRAIN_BASE                 g grassland-r4}
{TERRAIN_BASE                 r dirt}
{TERRAIN_BASE                 R road}
{TERRAIN_BASE_PROBABILITY     d desert-plant        10}
{TERRAIN_BASE                 d desert}
{TERRAIN_BASE                 \ bridge-se-nw}
{TERRAIN_BASE                 / bridge-ne-sw}
{TERRAIN_BASE                 | bridge-n-s}
{TERRAIN_BASE_PROBABILITY     w swampwater2         30}
{TERRAIN_BASE_PROBABILITY     w swampwater3         30}
{TERRAIN_BASE                 w swampwater}
{TERRAIN_BASE                 i ice}
{TERRAIN_BASE                 p pier}
{TERRAIN_BASE                 c coast}
{TERRAIN_BASE                 s ocean}
{TERRAIN_BASE                 ~ fog}

{CANYON X canyon}

#
# Villages
#

{TERRAIN_BASE Y swampwater}
{TERRAIN_BASE V snow}
{TERRAIN_BASE Z coast}
{TERRAIN_BASE v grassland-r1}
{TERRAIN_BASE D cave-floor1}
{TERRAIN_BASE t grassland-r1}

{BUILDING Y ({IMG       -100 village-swampwater })}
{BUILDING V ({IMG       -100 village-snow       })}
{BUILDING Z ({IMG       -100 village-coast      })}
{BUILDING v ({IMG       -100 village-human      })}
{BUILDING D ({IMG       -100 dwarven-village    })}
{BUILDING t ({IMG_NIGHT -100 village village-dusk,village-dusk2,village-dusk3,village-dusk4})} 

#
# Transition between terrains
#

# Special transitions go first

# Castle and keeps. Always use the same letter for keeps: the CASTLE_AND_KEEP
# macro will determine the correct graphics to use, according to the adjacent
# castle letter.

# Flags the keep, they must be flagged to be recognized by the
# {CASTLE_AND_foo_KEEP} macros

{FLAG_IF_ADJACENT K C keep-of-C keep-flag}
{FLAG_IF_ADJACENT K n keep-of-n keep-flag}
{FLAG_IF_ADJACENT K o keep-of-o keep-flag}
{FLAG_REMAINING   K   keep-of-C keep-flag}

#
# Castles base terrains
#

{TERRAIN_BASE C castle}
{TERRAIN_BASE o dwarven-castle-floor}
{TERRAIN_BASE n dirt}
{TERRAIN_BASE_FLAG K keep-of-C castle}
{TERRAIN_BASE_FLAG K keep-of-o dwarven-keep-floor}
{TERRAIN_BASE_FLAG K keep-of-n dirt}

{CASTLE_AND_COMPOSED_KEEP C K castle keep}
{CASTLE_AND_SIMPLE_KEEP   n K encampment}

# Castle decorations and castle floors. Those must always be after the castles
# are defined.
{BUILDING_FLAG K ({IMG -100 tent}) keep-of-n}
{BUILDING_FLAG K ({IMG -100 dwarven-keep}) keep-of-o}

# Forest, hills and mountains should always overlay on northern sides
{TERRAIN_ADJACENT_NORTH    -80        m  !m   mountains}
{TERRAIN_ADJACENT_NORTH    -80        H  !H   snow-hills}
{TERRAIN_ADJACENT_NORTH    -80        h  !hm  hills} # No adj-north between hills and mountains
{TERRAIN_ADJACENT_NORTH    -80        F  !F   snow-forest}

# Cave and dwarven castles
{DISABLE_TRANSITIONS W}
{DISABLE_TRANSITIONS o}
{TERRAIN_ADJACENT_CORNER -185        W      !WoK   !WoK    cavewall-convex}
{TERRAIN_ADJACENT_CORNER -185        !WoK   W      W       cavewall-concave}
{TERRAIN_ADJACENT_CORNER -185        o      !WoK   !WoK    dwarven-castle-convex}
{TERRAIN_ADJACENT_CORNER -185        !WoK   o      o       dwarven-castle-concave}
{TERRAIN_ADJACENT_CORNER_FLAG1 -185  K      !WoK   !WoK keep-of-o dwarven-castle-convex}
{TERRAIN_ADJACENT_CORNER_FLAG2 -185  !WoK   K      o    keep-of-o dwarven-castle-concave}
{TERRAIN_ADJACENT_CORNER_FLAG3 -185  !WoK   o      K    keep-of-o dwarven-castle-concave}
{TERRAIN_ADJACENT_CORNER -185        oK     W      W       dwarven-castle-wall-convex}
{TERRAIN_ADJACENT_CORNER -185        W      oK     oK      dwarven-castle-wall-concave}
{TERRAIN_ADJACENT_CORNER -185        oK     W      !WoK    dwarven-castle-wall-cw}
{TERRAIN_ADJACENT_CORNER -185        oK     !WoK   W       dwarven-castle-wall-ccw}


# forest-to-water transitions. Place before forest-to-any.
{TERRAIN_ADJACENT_123   -186        f      cZp\|/  forest-to-water}
{TERRAIN_ADJACENT_123   -186        f      s       forest-to-water}
# use forest-to-water for forest-to-dirt and forest-to-desert too
#{TERRAIN_ADJACENT_123   -187        f      r        forest-to-water}
{TERRAIN_ADJACENT_123   -186        f      d        forest-to-water}

{TERRAIN_ADJACENT_123   -186        f      !f      forest}
{TERRAIN_ADJACENT_1     -187        F      !F      snow-forest}
{TERRAIN_ADJACENT_1     -188        m      !m      mountains}
{TERRAIN_ADJACENT_12    -189        H      !H      snow-hills}
{TERRAIN_ADJACENT_12    -190        h      !h      hills}
{TERRAIN_ADJACENT_1234  -191        uD     !uD      cave-floor}
{TERRAIN_ADJACENT_1234  -192        SV     !SV     snow}
{TERRAIN_ADJACENT_1234  -193        tgvX   !tgvX   grassland}
{TERRAIN_ADJACENT_1     -194        r      !r      dirt}
{TERRAIN_ADJACENT_1     -195        R      !R      road}        # Missing gfx
{TERRAIN_ADJACENT_1     -196        d      !d      desert}
{TERRAIN_ADJACENT_1     -197        Yw     !Yw     swampwater}
{TERRAIN_ADJACENT_1     -198        i      !i      ice}
{TERRAIN_ADJACENT_1     -199        cZp\|/ !cZp\|/ coast}
{TERRAIN_ADJACENT_1     -200        s      !s      ocean}

{TERRAIN_BASE_DEFAULT void}

