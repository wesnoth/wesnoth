#textdomain wesnoth-pap
[textdomain]
    name="wesnoth-pap"
[/textdomain]

#ifdef CAMPAIGN_PEARLS_AND_PIRATES
{internal/Weather}
[binary_path]
    path=data/campaigns/Of_Pearls_and_Pirates/
[/binary_path]
[lua]
    code=<<
            wesnoth.require 'campaigns/Of_Pearls_and_Pirates/lua/popups'
            wesnoth.dofile('lua/skip_animations.lua')
        >>
[/lua]
{campaigns/Of_Pearls_and_Pirates/utils}
[units]
    {campaigns/Of_Pearls_and_Pirates/units/}
[/units]
{campaigns/Of_Pearls_and_Pirates/scenarios/}
#endif

# wmlscope: set export=no
[campaign]
    id=Pearls_and_Pirates
    icon="units/transport/pirate-galleon.png"
    name= _ "Of Pearls and Pirates"
    abbrev= _ "PaP"
    rank=15 # second new player campaign
    start_year="471 YW"
    end_year="472 YW"
    define=CAMPAIGN_PEARLS_AND_PIRATES
    first_scenario=01_Pirates

    {CAMPAIGN_DIFFICULTY EASY      "units/human-peasants/woodsman.png~RC(magenta>red)"      ( _ "Easy"  ) ( _ "1x enemies, 70% XP")}
    {CAMPAIGN_DIFFICULTY NORMAL    "units/human-loyalists/bowman.png~RC(magenta>red)"       ( _ "Normal") ( _ "2x enemies, 90% XP")} {DEFAULT_DIFFICULTY}
    {CAMPAIGN_DIFFICULTY HARD      "units/human-loyalists/longbowman.png~RC(magenta>red)"   ( _ "Hard"  ) ( _ "3x enemies, 100% XP")}
    {CAMPAIGN_DIFFICULTY NIGHTMARE "units/human-loyalists/masterbowman.png~RC(magenta>red)" ( _ "Deadly") ( _ "4x enemies, 100% XP")}

    description= _ "A sleepy fishing village on Wesnoth’s west coast finds itself suddenly beset by corsairs. With requests for royal aid falling on deaf ears, the villagers must join forces with the local merfolk and bring the fight to the pirates." + "

" + _"(Novice level, 5 scenarios.)"

    end_text_duration=5000
    #po: this campaign is not a direct continuation of the story and characters, but is next chronologically and is the recommended next campaign
    end_text= _ "The saga continues in
<i>The Deceiver’s Gambit</i>"

    [about]
        title = _ "Author"
        [entry]
            name = "Dalas"
        [/entry]
    [/about]
    [about]
        title = _ "Art"
        [entry]
            name = "Doofus-01"
            comment = "Thea portrait"
        [/entry]
        [entry]
            name = "Refumee"
            comment = "Black-sailed ship variations"
        [/entry]
    [/about]

    [load_resource]
        id=stronger_amlas
    [/load_resource]

#ifdef CAMPAIGN_PEARLS_AND_PIRATES
    {EXPERIENCE_MODIFIER_GLOBAL}
    {TRACK_SAVELOADS}

    # if an inexperienced player has a small army and is banking large amounts of gold,
    # remind them that Wesnoth is a game of armies - not a Fire Emblem-style game of heroes
    [event]
        name=side 1 turn refresh
        first_time_only=no
        [filter_condition]
            {VARIABLE_CONDITIONAL enable_tutorial_elements equals yes}
            {VARIABLE_CONDITIONAL turn_number greater_than 8}
            {VARIABLE_CONDITIONAL explained_high_gold not_equals yes}
        [/filter_condition]

        [store_unit]
            [filter]
                side=1
                formula="( $this_unit.hitpoints>$this_unit.max_hitpoints/2 )"
            [/filter]
            variable=player_healthy_army
        [/store_unit]
        [store_unit]
            [filter]
                [not]
                    side=1
                [/not]
                [not]
                    type=Cage
                [/not]
            [/filter]
            variable=enemy_army
        [/store_unit]

        [store_gold]
            side=1
        [/store_gold]
        [if]
            {VARIABLE_CONDITIONAL gold greater_than 100}
            {VARIABLE_CONDITIONAL enemy_army.length greater_than "$( 2 * $player_healthy_army.length )"}
            [then]
                [message]
                    speaker=Thea
                    message= _ "I have so much gold! Unless I’m already winning easily, I should make sure to take full advantage of our treasury."
                [/message]
                [message]
                    speaker=Thea
                    message= _ "Many hands make light work, in war as well as peace. Even the most experienced fighter will fall in the face of numbers."
                [/message]
                {VARIABLE explained_high_gold yes}
            [/then]
        [/if]
        {CLEAR_VARIABLE player_healthy_army,enemy_army,gold}
    [/event]

    [event]
        name=last breath
        [filter]
            id=Thea
        [/filter]
        [message]
            speaker=Thea
            message= _ "No! Not like this..."
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]
    [event]
        name=last breath
        [filter]
            id=Rael
        [/filter]
        [message]
            speaker=Rael
            message= _ "What will Thea do without me..."
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]
    [event]
        name=last breath
        [filter]
            id=Elyn
        [/filter]
        [message]
            speaker=Elyn
            message= _ "Argh! I’ve breathed my last!"
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]
    [event]
        name=last breath
        [filter]
            id=Diondra
        [/filter]
        [message]
            speaker=Diondra
            message= _ "The depths have taken me..."
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]
#endif
[/campaign]
