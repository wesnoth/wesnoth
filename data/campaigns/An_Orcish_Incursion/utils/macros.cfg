#textdomain wesnoth-aoi

#define HINT MESSAGE
    notes_string= _ "Hint:"

    [note]
        description={MESSAGE}
    [/note]
#enddef

#define IS_MAGE
    side=1
    type="Red Mage,White Mage,Mage,Arch Mage,Silver Mage,Mage of Light,Great Mage"
    [not]
        canrecruit=yes
    [/not]
#enddef

#define CAN_ADVISE
    side=1
    race=elf
    [not]
        canrecruit=yes
    [/not]
#enddef

#define PROMOTE_MAGE
    [if]
        [have_unit]
            side=1
            role=mage
        [/have_unit]
        [else]
            [if]
                [have_unit]
                    {IS_MAGE}
                [/have_unit]
                [then]
                    [role]
                        {IS_MAGE}
                        role=mage
                    [/role]
                [/then]
                [else]
                    {RECALL_MAGE}
                [/else]
            [/if]
        [/else]
    [/if]
#enddef

#define PROMOTE_ADVISOR
    [if]
        [have_unit]
            side=1
            role=advisor
        [/have_unit]
        [else]
            [if]
                [have_unit]
                    {CAN_ADVISE}
                [/have_unit]
                [then]
                    [role]
                        {CAN_ADVISE}
                        role=advisor
                    [/role]
                [/then]
                [else]
                    {RECALL_ADVISOR}
                [/else]
            [/if]
        [/else]
    [/if]
#enddef

#define RECALL_MAGE
    [if]
        [have_unit]
            side=1
            role=mage
            search_recall_list=yes
        [/have_unit]
        [then]
            [recall]
                side=1
                role=mage
            [/recall]
        [/then]
        [elseif]
            [have_unit]
                {IS_MAGE}
                search_recall_list=yes
            [/have_unit]
            [then]
                [role]
                    {IS_MAGE}
                    role=mage
                [/role]

                [recall]
                    side=1
                    role=mage
                [/recall]
            [/then]
        [/elseif]
        [else]
            [unit]
                type=Mage
                side=1
                role=mage
                animate=yes
                placement=leader
            [/unit]
        [/else]
    [/if]
#enddef

#define RECALL_ADVISOR
    [if]
        [have_unit]
            side=1
            role=advisor
            search_recall_list=yes
        [/have_unit]
        [then]
            # Recall an advisor if we have one to do so
            [recall]
                role=advisor
            [/recall]
        [/then]
        [elseif]
            # Else, make a new advisor from an elf unit
            [have_unit]
                {CAN_ADVISE}
                search_recall_list=yes
            [/have_unit]
            [then]
                [role]
                    {CAN_ADVISE}
                    role=advisor
                [/role]

                [recall]
                    role=advisor
                [/recall]
            [/then]
        [/elseif]
        [else]
            # If that fails too, make a brand new advisor
            [unit]
                type=Elvish Fighter
                side=1
                role=advisor
                animate=yes
                placement=leader
            [/unit]
        [/else]
    [/if]
#enddef
