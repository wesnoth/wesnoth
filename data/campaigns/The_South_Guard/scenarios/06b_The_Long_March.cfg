#textdomain wesnoth-tsg
[scenario]
    id=6b_The_Long_March

    name= _ "The Long March"
    next_scenario=7b_Pebbles_In_The_Flood
    [music]
        name=revelation.ogg
        ms_before=500
    [/music]
    [music]
        name=northerners.ogg
        ms_before=500
        append=yes
    [/music]

    map_data="{campaigns/The_South_Guard/maps/6b_The_Long_March.map}"

    {campaigns/The_South_Guard/utils/sg_deaths.cfg}

    {DUSK}
    {FIRST_WATCH}
    {SECOND_WATCH}
    {DAWN}
    {MORNING}
    {AFTERNOON}

    victory_when_enemies_defeated=no
    turns=40

    # The South Guard

    [side]
        side=1
        type=Horseman Commander
        description=Deoran
        user_description= _ "Deoran"
        unrenamable=yes
        team_name=South_Guard
        controller=human
        {CUSTOM_SG_FLAG}

        fog=no
        shroud=yes
        share_view=yes
        share_maps=yes

        {GOLD 125 100 80}
        {INCOME 6 4 2}

        canrecruit=1
        recruit=Bowman, Spearman, Cavalryman, Thug, Footpad, Poacher
    [/side]

    #Urza Afalas

    [side]
        side=2

        team_name=South_Guard
        no_leader=yes
        share_view=yes
        share_maps=yes
        controller=ai
    [/side]

    # The Undead Hordes (Part II)

    [side]
        side=3
        no_leader=yes

        team_name=the_undead_hordes
        controller=ai

        {GOLD 10 20 30}
        {INCOME 1 2 3}

        canrecruit=1
        [ai]
            recruitment_pattern=scout
            aggression=-0.25
        [/ai]
        recruit=Vampire Bat
    [/side]

    [side]
        side=4
        no_leader=yes
        team_name=elves
        gold=100
        income=0
    [/side]

    #prestart
    [event]
        name=prestart

        {PLACE_IMAGE (items/gohere.png) 16 3}

        {SG_GUARD (Naga Warrior) (Fssth) (_"Fssth") 4 9 14}

#ifdef NORMAL
        {SG_GUARD (Naga Fighter) (Wizzi) (_"Wizzi") 4 10 14}
#endif

#ifdef HARD
        {SG_GUARD (Naga Warrior) (Wizzi) (_"Wizzi") 4 10 14}
#endif

#ifdef EASY
        {GENERIC_UNIT 3 Ghost 24 25}
#else
        {GENERIC_UNIT 3 Wraith 24 25}
#endif

#ifdef HARD
        {GENERIC_UNIT 3 Wraith 26 22}
#else
        {GENERIC_UNIT 3 Ghost 26 22}
#endif

#ifdef EASY
        {GENERIC_UNIT 3 Ghost 33 27}
#else
        {GENERIC_UNIT 3 Wraith 33 27}
#endif

#ifdef HARD
        {GENERIC_UNIT 3 Shadow 20 28}
#else
        {GENERIC_UNIT 3 Ghost 20 28}
#endif

#ifdef EASY
        {GENERIC_UNIT 3 Ghost 24 19}
#else
        {GENERIC_UNIT 3 Shadow 24 19}
#endif

#ifdef HARD
        {GENERIC_UNIT 3 Shadow 29 37}
#else
        {GENERIC_UNIT 3 Ghost 29 37}
#endif

        [recall]
            description=Sir Gerrick
        [/recall]
        [recall]
            description=Minister Hylas
        [/recall]
        [recall]
            description=Jarek
        [/recall]
        [recall]
            description=Urza Afalas
        [/recall]

        {SG_CHANGE_TERRAIN 28 46 Gg}
    [/event]

    #start
    [event]
        name=start

        {GENERIC_UNIT 1 Swordsman 31 48}
        {GENERIC_UNIT 1 Longbowman 27 49}

        [message]
            speaker=narrator
            message= _ "Deoran and Urza Afalas led their men quickly from the ruins of Mal M'brin's fortress..."
            image=wesnoth-icon.png
        [/message]

        [message]
            speaker=Deoran
            message= _ "Will this forest ever end? How can we know what path to take?!"
        [/message]
        [message]
            speaker=Urza Afalas
            message= _ "You have to follow me! There are many false paths in these woods. Some are dead ends, others are even worse!"
        [/message]
        [message]
            speaker=Sir Gerrick
            message= _ "Can we trust him? His people are murderers and thieves!"
        [/message]
        [message]
            speaker=Minister Hylas
            message= _ "Do we have any choice? Our food is running out, and it will be winter soon..."
        [/message]

        {MOVE_UNIT (description=Urza Afalas) 20 47}
        [message]
            speaker=Urza Afalas
            message= _ "This way! The only ford is a bit west of here, and the path to the north will lead you into trouble!"
        [/message]
        {PLACE_IMAGE (items/gohere.png) 21 48}

        [message]
            speaker=Sir Gerrick
            message= _ "I think we should head north. The road leads north, and the ford is north. Why does he want us to head west?"
        [/message]
        [message]
            speaker=Minister Hylas
            message= _ "Beware! I sense that there are undead monsters who have escaped Mal M'brin's control running around in that area."
        [/message]

        [objectives]
            side=1
            [objective]
                description= _ "Make your way to the north edge of the woods"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Deoran"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Sir Gerrick"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Minister Hylas"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Urza Afalas"
                condition=lose
            [/objective]
            [objective]
                description= _ "Time runs out"
                condition=lose
            [/objective]
        [/objectives]
    [/event]

    [event]
        name=die
        [filter]
            description=Urza Afalas
        [/filter]
        [message]
            speaker=unit
            image=portraits/urza-afalas.png
            message= _ "Now I pay for my crimes. But how many others will also suffer for them?"
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    # Urza's first leg/

    [event]
        name=moveto
        [filter]
            x,y=21,48
            description=Deoran
        [/filter]

        {MOVE_UNIT (description=Urza Afalas) 13 45}
        [message]
            speaker=Urza Afalas
            message= _ "We have to go even further west. There are elves living to the north, and I don't think they'll receive us too kindly!"
        [/message]
        [removeitem]
            x,y=21,48
        [/removeitem]
        {PLACE_IMAGE (items/gohere.png) 14 45}
#ifdef HARD
        {GENERIC_UNIT 4 (Elvish Marksman) 21 50}
#else
        {GENERIC_UNIT 4 (Elvish Archer) 21 50}
#endif

#ifdef EASY
        {GENERIC_UNIT 4 (Elvish Fighter) 22 50}
#else
        {GENERIC_UNIT 4 (Elvish Hero) 22 50}
#endif

        [message]
            race=elf
            message= _"You humans have kidnaped Mebrin the Sage. You will pay for your crimes."
        [/message]
        [message]
            description=Deoran
            message= _"Your sage Mebrin is the criminal. He practices necromancy and has turned himself into Lich. By the laws of Wesnoth, the punnishment for his crimes is death!"
        [/message]
        [message]
            race=elf
            message= _"It is you who is a criminal and who is in a company of criminals. We will not let you kill Mebrin!"
        [/message]
        [message]
            description=Deoran
            message= _"I was a fool to waste my words on you. Prepare to meet your beloved Mebrin or should I say Mal M'brin in hell, elves !"
        [/message]
    [/event]

    # Urza Afalas moves north - choice two.

    [event]
        name=moveto
        [filter]
            x,y=14,45
            description=Deoran
        [/filter]

        {MOVE_UNIT (description=Urza Afalas) 8 41}
        [message]
            speaker=Urza Afalas
            message= _ "Come on! Hurry!"
        [/message]

        [removeitem]
            x,y=14,45
        [/removeitem]
        {PLACE_IMAGE (items/gohere.png) 9 42}

#ifdef HARD
        {GENERIC_UNIT 4 (Elvish Ranger) 14 47}
#else
        {GENERIC_UNIT 4 (Elvish Archer) 14 47}
#endif

#ifdef EASY
        {GENERIC_UNIT 4 (Elvish Fighter) 15 47}
#else
        {GENERIC_UNIT 4 (Elvish Captain) 15 47}
#endif

#ifdef EASY
        {GENERIC_UNIT 4 (Elvish Scout) 14 48}
#else
        {GENERIC_UNIT 4 (Elvish Rider) 14 48}
#endif

        [message]
            race=elf
            message= _ "Get them !"
        [/message]
    [/event]

    # Urza Afalas moves north - choice two.

    [event]
        name=moveto
        [filter]
            x,y=9,42
            description=Deoran
        [/filter]

        {MOVE_UNIT (description=Urza Afalas) 3 39}
        [message]
            speaker=Urza Afalas
            message= _ "Keep moving!"
        [/message]

        [removeitem]
            x,y=9,42
        [/removeitem]
        {PLACE_IMAGE (items/gohere.png) 3 40}

#ifdef HARD
        {GENERIC_UNIT 4 (Elvish Ranger) 7 43}
#else
        {GENERIC_UNIT 4 (Elvish Archer) 7 43}
#endif

#ifdef EASY
        {GENERIC_UNIT 4 (Elvish Fighter) 10 42}
#else
        {GENERIC_UNIT 4 (Elvish Captain) 10 42}
#endif

#ifdef EASY
        {GENERIC_UNIT 4 (Elvish Shaman) 10 43}
#else
        {GENERIC_UNIT 4 (Elvish Druid) 10 43}
#endif
    [/event]

    # Urza Afalas moves north - choice two.

    [event]
        name=moveto
        [filter]
            x,y=3,40
            description=Deoran
        [/filter]

        {MOVE_UNIT (description=Urza Afalas) 3 34}
        [message]
            speaker=Urza Afalas
            message= _ "We're almost there!"
        [/message]

        [removeitem]
            x,y=3,40
        [/removeitem]
        {PLACE_IMAGE (items/gohere.png) 3 35}

#ifdef HARD
        {GENERIC_UNIT 4 (Elvish Marksman) 3 42}
#else
        {GENERIC_UNIT 4 (Elvish Archer) 3 42}
#endif

#ifdef EASY
        {GENERIC_UNIT 4 (Elvish Fighter) 4 43}
#else
        {GENERIC_UNIT 4 (Elvish Hero) 4 43}
#endif

#ifdef EASY
        {GENERIC_UNIT 4 (Elvish Scout) 4 44}
#else
        {GENERIC_UNIT 4 (Elvish Rider) 4 44}
#endif
    [/event]

    [event]
        name=moveto
        [filter]
            x,y=3,35
            description=Deoran
        [/filter]

        {MOVE_UNIT (description=Urza Afalas) 5 29}
        [message]
            speaker=Urza Afalas
            message= _ "Just a little further!"
        [/message]

        [removeitem]
            x,y=3,35
        [/removeitem]
        {PLACE_IMAGE (items/gohere.png) 5 30}

#ifdef HARD
        {GENERIC_UNIT 4 (Elvish Ranger) 5 33}
#else
        {GENERIC_UNIT 4 (Elvish Archer) 5 33}
#endif

#ifdef EASY
        {GENERIC_UNIT 4 (Elvish Fighter) 5 34}
#else
        {GENERIC_UNIT 4 (Elvish Hero) 5 34}
#endif

#ifdef EASY
        {GENERIC_UNIT 4 (Elvish Shaman) 5 36}
#else
        {GENERIC_UNIT 4 (Elvish Sorceress) 5 36}
#endif
    [/event]

    [event]
        name=moveto
        [filter]
            x,y=5,30
            description=Deoran
        [/filter]

        {MOVE_UNIT (description=Urza Afalas) 9 25}
        [message]
            speaker=Urza Afalas
            message= _ "Hurry! There are bandits in these woods!"
        [/message]
        [message]
            speaker=Deoran
            message= _ "Why should that worry us?! Aren't you their leader?"
        [/message]
        [message]
            speaker=Urza Afalas
            message= _ "We're bandits, after all. Not all of them are loyal to me."
        [/message]

        [removeitem]
            x,y=5,30
        [/removeitem]
        {PLACE_IMAGE (items/gohere.png) 9 26}

#ifdef HARD
        {GENERIC_UNIT 4 (Elvish Marksman) 5 28}
#else
        {GENERIC_UNIT 4 (Elvish Archer) 5 28}
#endif

#ifdef EASY
        {GENERIC_UNIT 4 (Elvish Fighter) 6 28}
#else
        {GENERIC_UNIT 4 (Elvish Hero) 6 28}
#endif

#ifdef EASY
        {GENERIC_UNIT 4 (Elvish Shaman) 5 32}
#else
        {GENERIC_UNIT 4 (Elvish Sorceress) 5 32}
#endif
#ifdef HARD
        {GENERIC_UNIT 4 (Elvish Rider) 5 31}
#else
        {GENERIC_UNIT 4 (Elvish Scout) 5 31}
#endif
    [/event]

    [event]
        name=moveto
        [filter]
            x,y=9,26
            description=Deoran
        [/filter]

        {MOVE_UNIT (description=Urza Afalas) 10 18}
        [message]
            speaker=Urza Afalas
            message= _ "The river is just ahead!"
        [/message]

        [removeitem]
            x,y=9,26
        [/removeitem]
        {PLACE_IMAGE (items/gohere.png) 10 19}

#ifdef HARD
        {GENERIC_UNIT 4 Bandit 5 28}
#else
        {GENERIC_UNIT 4 Thug 5 28}
#endif

#ifdef EASY
        {GENERIC_UNIT 4 Thief 6 28}
#else
        {GENERIC_UNIT 4 Rogue 6 28}
#endif

#ifdef EASY
        {GENERIC_UNIT 4 Footpad 5 32}
#else
        {GENERIC_UNIT 4 Outlaw 5 32}
#endif
#ifdef HARD
        {GENERIC_UNIT 4 Trapper 5 31}
#else
        {GENERIC_UNIT 4 Poacher 5 31}
#endif
        [message]
            type=Trapper
            message= _ "The elves payed us well to kill you."
        [/message]
        [message]
            type=Poacher
            message= _ "The elves payed us well to kill you."
        [/message]
        [message]
            description=Urza Afalas
            message= _ "You bastards!"
        [/message]
        [message]
            type=Thief
            message= _ "You would have done the same to us if you were in our place!"
        [/message]
        [message]
            type=Rogue
            message= _ "You would have done the same to us if you were in our place!"
        [/message]
        [message]
            description=Urza Afalas
            message= _ "I probably would have..."
        [/message]
    [/event]

    [event]
        name=moveto
        [filter]
            x,y=10,19
            description=Deoran
        [/filter]

        [message]
            speaker=Urza Afalas
            message= _ "From here you can see the banks of the river! Across it we will find the sun again, and an end to these cursed trees!"
        [/message]

        [removeitem]
            x,y=10,20
        [/removeitem]
    [/event]

    # Elvish Ambush

    [event]
        name=moveto
        [filter]
            side=1
            x,y=12-15,31-33
        [/filter]

        {SG_GUARD (Elvish Fighter) (Urien) (_"Urien") 4 12 34}
        {SG_GUARD (Elvish Archer) (Jesa) (_"Jesa") 4 15 31}
        {SG_GUARD (Elvish Archer) (Plinth) (_"Plinth") 4 15 34}

        [message]
            speaker=Plinth
            message= _ "We cannot allow you bandits and criminals to pass through our lands!"
        [/message]
        [message]
            speaker=Urza Afalas
            message= _ "But we have slain the undead - we wish only to return to our homes!"
        [/message]
        [message]
            speaker=Plinth
            message= _ "Nevertheless, we will have vengeance for Mebrin!!"
        [/message]
    [/event]

    # Deoran exits the forest.

    [event]
        name=moveto
        [filter]
            description=Deoran
            x,y=16,3
        [/filter]
        [message]
            speaker=Deoran
            message= _ "Thank heaven we have escaped that awful forest!"
        [/message]
        [message]
            speaker=Sir Gerrick
            message= _ "Indeed, Afalas, you've earned my trust today."
        [/message]
        [message]
            speaker=Urza Afalas
            message= _ "I can only hope for mercy when I return to Westin."
        [/message]

        [message]
            speaker=narrator
            message= _ "But there was a dark cloud looming behind Deoran and his men..."
            image=wesnoth-icon.png
        [/message]

        [endlevel]
            bonus=yes
            result=victory
        [/endlevel]
    [/event]
[/scenario]
