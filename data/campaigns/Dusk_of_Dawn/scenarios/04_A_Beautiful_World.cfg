#textdomain wesnoth-dod

[scenario]
    id=04_A_Beautiful_World
    name= _ "A Beautiful World"
    map_file=04_A_Beautiful_World.map
    turns=unlimited
    next_scenario=null
    victory_when_enemies_defeated=no
    theme=Cutscene_Minimal

    {DUSK}

    {SCENARIO_MUSIC nunc_dimittis.ogg}

    [story]
        [part]
            music=revelation.ogg
            {DOD_STORY}
            story= "<i>" + _"Sessa asked the trolls how she could repay them for their help, but the trolls did not know how to speak. They pointed upwards with their hands." + "</i>"
        [/part]
        [part]
            {DOD_STORY}
            story= "<i>" + _"Fortunately, this was not the first time the Nagas had met their kind, and after a while they understood where the trolls were going." + "</i>"
        [/part]
        [part]
            show_title=yes
            {DOD_STORY}
            story= "<i>" + _"The old wose’s directions had been too complicated for Ougl to follow. He had forgotten most of them already. But with a guide, the trolls would surely reach their goal." + "</i>"
        [/part]
    [/story]

    # wmllint: validate-off
    [side]
        side=1
        controller=human
        recruit="Troll Whelp, Fire Guardian, Troll Initiate"
        {GOLD 0 0 0}
        income=0
        team_name=good
        color=brightorange
        user_team_name= _ "Golden Flame Tribe"
        {FLAG_VARIANT6 ragged}
        shroud=yes

        # wmllint: recognize Ougl
        {CHARACTER_STATS_OUGL}

        facing=nw
    [/side]
    # wmllint: validate-on

    [side]
        side=2
        controller=ai
        recruit=""
        {GOLD 0 0 0}
        income=0
        team_name=good
        color=purple
        user_team_name= _ "Purple Eye Naga"
        {FLAG_VARIANT long}

        [unit]
            type=Naga Fighter
            id=IA
            name=_"Ilaja"
            gender=female
            canrecruit=no

            x,y=11,14
            facing=sw

            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_QUICK}
            [/modifications]
        [/unit]
    [/side]

    [side]
        side=3
        controller=ai
        recruit=""
        {GOLD 0 0 0}
        income=0
        team_name=bad
        color=red
        user_team_name= _ "Red Cry Horde"
        {FLAG_VARIANT6 ragged}
    [/side]

    [side]
        side=4
        controller=ai
        recruit=""
        {GOLD 0 0 0}
        income=0
        team_name=bad
        color=lightblue
        user_team_name= _ "Blue Blood Saurians"
        {FLAG_VARIANT6 ragged}
    [/side]

    [side]
        side=5
        controller=ai
        recruit=""
        {GOLD 0 0 0}
        income=0
        team_name=good
        team_name=good
        color=brightorange
        user_team_name= _ "Golden Flame Tribe"
        {FLAG_VARIANT6 ragged}
    [/side]

    [event]
        name=start

        [delay]
            time=500
        [/delay]

        {MOVE_UNIT id=IA 10 9}

        [remove_shroud]
            side=1
            x,y=10,9
            radius=4
        [/remove_shroud]

        [delay]
            time=500
        [/delay]

        {MOVE_UNIT id=OL 11 10}

        [delay]
            time=1000
            accelerate=yes
        [/delay]

        [message]
            speaker=IA
            message= _ "<b>S s a s...</b> (Here we bid farewell, stone friends. Be safe.)"
        [/message]

        {MOVE_UNIT id=IA 12 15}

        [kill]
            id=IA
        [/kill]

        {SCROLL_TO 11 10}

        [delay]
            time=500
        [/delay]

        {MOVE_UNIT id=OL 10 8}

        [delay]
            time=500
        [/delay]

        [message]
            speaker=narrator
            image=wesnoth-icon.png
            message= "<i>" + _"Ougl took a step towards the exit, but hesitated for a moment. He wasn’t sure why." + "</i>"
        [/message]

        [delay]
            time=500
        [/delay]

        {SCROLL_TO 11 7}

        {MOVE_UNIT id=OL 11 7}

        [remove_shroud]
            side=1
            x,y=11,7
            radius=3
        [/remove_shroud]

        [delay]
            time=500
        [/delay]

        {SCROLL_TO 10 4}

        {MOVE_UNIT id=OL 12 6}

        [remove_shroud]
            side=1
            x="10,3,17,10"
            y="4,3,3,2"
            radius=4
        [/remove_shroud]

        {REPLACE_SCENARIO_MUSIC silvan_sanctuary.ogg}

        [unit]
            type=Troll Initiate
            id=WHELP_1
            side=5
            canrecruit=no
            generate_name=yes
            animate=yes
            x,y=13,6
            facing=ne
        [/unit]

        [unit]
            type=Troll Whelp
            id=WHELP_2
            side=5
            canrecruit=no
            generate_name=yes
            animate=yes
            x,y=11,7
            facing=nw
        [/unit]

        [message]
            speaker=narrator
            image=wesnoth-icon.png
            message= "<i>" + _"The outside world was everything Ougl had imagined. Green. Full of sound and life. Ougl and the Golden Flame Tribe were filled with awe." + "</i>"
        [/message]

        [delay]
            time=500
        [/delay]

        {MOVE_UNIT id=OL 8 5}

        [delay]
            time=500
        [/delay]

        {MOVE_UNIT id=OL 10 4}

        [delay]
            time=500
        [/delay]

        [message]
            speaker=narrator
            image=wesnoth-icon.png
            message= "<i>" + _"A bright light shone overhead, brighter than anything Ougl had ever seen. The light hurt to look at. The light made everything hurt to look at, but Ougl kept looking anyway." + "</i>"
        [/message]

        [sound]
            name="data/core/sounds/troll-die-1.ogg"
        [/sound]

        [delay]
            time=500
        [/delay]

        [message]
            speaker=narrator
            image=wesnoth-icon.png
            message= "<i>" + _"Ougl’s voice ran out with joy. He felt that he had fulfilled his greatest dream." + "</i>"
        [/message]

        [message]
            speaker=narrator
            image=wesnoth-icon.png
            message= "<i>" + _"But his happiness did not last very long..." + "</i>"
        [/message]

        {REPLACE_SCENARIO_MUSIC frantic.ogg}

        [unit]
            type=Orcish Warlord
            id=AR
            name= _ "Agnar Red Cry"
            canrecruit=yes
            side=3

            x,y=14,2
            facing=se
            animate=yes

            [modifications]
                {TRAIT_STRONG}
                {TRAIT_SLOW}
            [/modifications]
        [/unit]

        {MOVE_UNIT id=AR 11 5}

        [message]
            speaker=AR
            message= _ "<b>Arg-hah!</b> (Now we've got you! You dumb troll!)"
        [/message]

        [modify_unit]
            [filter]
                id=OL
            [/filter]
            facing=se
        [/modify_unit]

        [message]
            speaker=OL
            message= "<b>" + _"...?" + "</b>"
        [/message]

        [unit]
            type=Saurian Oracle
            id=MZ
            name= _ "Moarxz Blue Blood"
            canrecruit=yes
            side=4

            x,y=7,6
            facing=sw
            animate=yes

            [modifications]
                {TRAIT_RESILIENT}
                {TRAIT_INTELLIGENT}
            [/modifications]
        [/unit]

        {MOVE_UNIT id=MZ 9 4}

        [modify_unit]
            [filter]
                id=MZ
            [/filter]
            facing=se
        [/modify_unit]

        [modify_unit]
            [filter]
                id=OL
            [/filter]
            facing=nw
        [/modify_unit]

        [delay]
            time=500
        [/delay]

        [animate_unit]
            flag=attack
            [filter]
                id=MZ
            [/filter]

            hits=yes

            [facing]
                [filter]
                    id=OL
                [/filter]
            [/facing]

            [animate]
                flag=defend

                [filter]
                    id=OL
                [/filter]

                [facing]
                    [filter]
                        id=MZ
                    [/filter]
                [/facing]
            [/animate]

            [primary_attack]
                range=ranged
            [/primary_attack]
        [/animate_unit]

        {FADE_TO_BLACK}

        [delay]
            time=500
        [/delay]

        {FLASH_RED ()}

        [sound]
            name="data/core/sounds/fire.wav"
        [/sound]

        [modify_side]
            side=1
            user_team_name= _ "Flameless Tribe"
            color=black
        [/modify_side]

        [modify_unit]
            [filter]
                id=OL
            [/filter]
            name=_"Ougl the Flameless"
        [/modify_unit]

        [unit]
            type=Fire Wraith
            id=IF
            name= _ "Spark"
            unrenamable=yes
            canrecruit=no
            side=1

            x,y=9,5
            facing=sw
            animate=yes

            [modifications]
                {TRAIT_LOYAL_HERO}
            [/modifications]
        [/unit]

        [delay]
            time=500
        [/delay]

        [animate_unit]
            flag=attack
            [filter]
                id=MZ
            [/filter]

            hits=yes

            [facing]
                [filter]
                    id=IF
                [/filter]
            [/facing]

            [animate]
                flag=defend

                [filter]
                    id=IF
                [/filter]

                [facing]
                    [filter]
                        id=MZ
                    [/filter]
                [/facing]
            [/animate]

            [primary_attack]
                range=ranged
            [/primary_attack]
        [/animate_unit]

        {REPLACE_SCENARIO_MUSIC the_king_is_dead.ogg}

        {FLASH_RED ()}

        [sound]
            name="data/core/sounds/fire.wav"
        [/sound]

        [kill]
            id=IF
            animate=yes
        [/kill]

        [delay]
            time=500
        [/delay]

        {FADE_IN}

        [delay]
            time=500
        [/delay]

        [message]
            speaker=narrator
            image=wesnoth-icon.png
            message= "<i>" + _"The saurian stole away Ougl’s inner flame and quenched it with magic. Bitter cold cut into Ougl’s stone-like body." + "</i>"
        [/message]

        [message]
            speaker=MZ
            message= _ "<b>S y s s...</b> (You will follow us wherever we go if you want to regain your inner flame, troll.)"
        [/message]

        [message]
            speaker=narrator
            image=wesnoth-icon.png
            message= "<i>" + _"...But Ougl had no intention of giving up so easily." + "</i>"
        [/message]

        [message]
            speaker=narrator
            image=wesnoth-icon.png
            message= "<i>" + _"He suddenly shouted. Trollish words rang out in the evening air." + "</i>"
        [/message]

        [sound]
            name="data/core/sounds/troll-die-1.ogg"
        [/sound]

        [message]
            speaker=OL
            message= "<b>" + _"OUGL... NOT FOLLOW YOU!!!" + "</b>"
        [/message]

        [animate_unit]
            flag=attack
            [filter]
                id=OL
            [/filter]

            hits=yes

            [facing]
                [filter]
                    id=MZ
                [/filter]
            [/facing]

            [animate]
                flag=defend

                [filter]
                    id=MZ
                [/filter]

                [facing]
                    [filter]
                        id=OL
                    [/filter]
                [/facing]
            [/animate]

            [primary_attack]
                range=melee
            [/primary_attack]
        [/animate_unit]

        [kill]
            id=MZ
            animate=yes
        [/kill]

        [message]
            speaker=AR
            message= _ "<b>Arg-hah!</b> (The beast is trying to fight! Archers, to me!)"
        [/message]

        {MOVE_UNIT id=AR 10 6}

        [unit]
            type=Orcish Archer
            id=ARCHER_1
            side=3
            canrecruit=no
            generate_name=yes
            animate=yes
            x,y=9,6
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]

        {MOVE_UNIT id=ARCHER_1 9 5}

        [unit]
            type=Orcish Archer
            id=ARCHER_2
            side=3
            canrecruit=no
            generate_name=yes
            animate=yes
            x,y=11,6
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]

        {MOVE_UNIT id=ARCHER_2 11 5}

        [unit]
            type=Orcish Crossbowman
            id=CROSSBOWMAN
            side=3
            canrecruit=no
            generate_name=yes
            animate=yes
            x,y=10,5
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]

        [animate_unit]
            flag=attack
            [filter]
                id=CROSSBOWMAN
            [/filter]

            hits=yes

            [facing]
                [filter]
                    id=OL
                [/filter]
            [/facing]

            [animate]
                flag=defend

                [filter]
                    id=OL
                [/filter]
            [/animate]

            [primary_attack]
                range=ranged
                type=fire
            [/primary_attack]
        [/animate_unit]

        [harm_unit]
            [filter]
                id=OL
            [/filter]
            amount=14
            kill=no
        [/harm_unit]

        [message]
            speaker=narrator
            image=wesnoth-icon.png
            message= "<i>" + _"When Ougl felt the heat of the fire, he flew into a great rage." + "</i>"
        [/message]

        [animate_unit]
            flag=attack
            [filter]
                id=OL
            [/filter]

            hits=yes

            [facing]
                [filter]
                    id=CROSSBOWMAN
                [/filter]
            [/facing]

            [animate]
                flag=defend

                [filter]
                    id=CROSSBOWMAN
                [/filter]

                [facing]
                    [filter]
                        id=OL
                    [/filter]
                [/facing]
            [/animate]

            [primary_attack]
                range=melee
            [/primary_attack]
        [/animate_unit]

        [kill]
            id=CROSSBOWMAN
            animate=yes
        [/kill]

        [animate_unit]
            flag=attack
            [filter]
                id=WHELP_2
            [/filter]

            hits=yes

            [facing]
                [filter]
                    id=AR
                [/filter]
            [/facing]

            [animate]
                flag=defend

                [filter]
                    id=AR
                [/filter]

                [facing]
                    [filter]
                        id=WHELP_2
                    [/filter]
                [/facing]
            [/animate]

            [primary_attack]
                range=melee
            [/primary_attack]
        [/animate_unit]

        [modify_unit]
            [filter]
                id=WHELP_1
            [/filter]
            facing=nw
        [/modify_unit]

        [animate_unit]
            flag=attack
            [filter]
                id=AR
            [/filter]

            hits=yes

            [facing]
                [filter]
                    id=WHELP_2
                [/filter]
            [/facing]

            [animate]
                flag=defend

                [filter]
                    id=WHELP_2
                [/filter]

                [facing]
                    [filter]
                        id=AR
                    [/filter]
                [/facing]
            [/animate]

            [primary_attack]
                range=melee
            [/primary_attack]
        [/animate_unit]

        [kill]
            id=WHELP_2
            animate=yes
        [/kill]

        [animate_unit]
            flag=attack
            [filter]
                id=ARCHER_1
            [/filter]

            hits=yes

            [facing]
                [filter]
                    id=OL
                [/filter]
            [/facing]

            [animate]
                flag=defend

                [filter]
                    id=OL
                [/filter]
            [/animate]

            [primary_attack]
                range=ranged
                type=fire
            [/primary_attack]
        [/animate_unit]

        [harm_unit]
            [filter]
                id=OL
            [/filter]
            amount=8
            kill=no
        [/harm_unit]

        [animate_unit]
            flag=attack
            [filter]
                id=ARCHER_2
            [/filter]

            hits=yes

            [facing]
                [filter]
                    id=OL
                [/filter]
            [/facing]

            [animate]
                flag=defend

                [filter]
                    id=OL
                [/filter]
            [/animate]

            [primary_attack]
                range=ranged
                type=fire
            [/primary_attack]
        [/animate_unit]

        [harm_unit]
            [filter]
                id=OL
            [/filter]
            amount=8
            kill=no
        [/harm_unit]

        [animate_unit]
            flag=attack
            [filter]
                id=ARCHER_1
            [/filter]

            hits=yes

            [facing]
                [filter]
                    id=OL
                [/filter]
            [/facing]

            [animate]
                flag=defend

                [filter]
                    id=OL
                [/filter]
            [/animate]

            [primary_attack]
                range=ranged
                type=fire
            [/primary_attack]
        [/animate_unit]

        [harm_unit]
            [filter]
                id=OL
            [/filter]
            amount=8
            kill=no
        [/harm_unit]

        [animate_unit]
            flag=attack
            [filter]
                id=ARCHER_2
            [/filter]

            hits=yes

            [facing]
                [filter]
                    id=OL
                [/filter]
            [/facing]

            [animate]
                flag=defend

                [filter]
                    id=OL
                [/filter]
            [/animate]

            [primary_attack]
                range=ranged
                type=fire
            [/primary_attack]
        [/animate_unit]

        [harm_unit]
            [filter]
                id=OL
            [/filter]
            amount=8
            kill=no
        [/harm_unit]

        [message]
            speaker=narrator
            image=wesnoth-icon.png
            message= "<i>" + _"Ougl fell to his knees. The strong troll’s gaze became absent, and his will to fight died out. His drive and vitality had faded away, and only empty space remained in his heart." + "</i>"
        [/message]

        {MOVE_UNIT id=AR 10 5}

        [message]
            speaker=AR
            message= _ "<b>Arg-hah!</b> (You have no chance to win against me. Do you understand? Ha, ha, ha...!)"
        [/message]

        {MOVE_UNIT id=AR 11 6}

        [message]
            speaker=AR
            message= _ "<b>Arg-hah!</b> (Now your leader is under our power. You trolls need a new leader. You will all follow us!)"
        [/message]

        [modify_side]
            side=1,5
            color=red
        [/modify_side]

        {FADE_TO_BLACK}

        [message]
            speaker=narrator
            image=wesnoth-icon.png
            message= "<i>" + _"None of the Golden Flame Tribe were as bright or as bold as Ougl had been. They did not understand the danger of the orcs." + "</i>"
        [/message]

        [message]
            speaker=narrator
            image=wesnoth-icon.png
            message= "<i>" + _"The trolls joined their new leaders, and learned from them. They learned to lust for the sheen of gold and the smell of blood. They learned to spread ruin and death." + "</i>"
        [/message]

        [kill]
            x="1-99"
            y="1-99"
        [/kill]

        [redraw]
        [/redraw]

        [terrain_mask]
            x,y=1,1
            mask="{campaigns/Dusk_of_Dawn/maps/04b_Frozen_Tower.map}"
        [/terrain_mask]

        [delay]
            time=1000
        [/delay]
        [sound]
            name="data/core/sounds/lightning.ogg"
        [/sound]
        [delay]
            time=750
        [/delay]
        [sound]
            name="data/core/sounds/orc-die-2.ogg"
        [/sound]
        [delay]
            time=500
        [/delay]
        [sound]
            name="data/core/sounds/lightning-miss.ogg"
        [/sound]
        [delay]
            time=400
        [/delay]
        [sound]
            name="data/core/sounds/hiss-die.wav"
        [/sound]
        [delay]
            time=1000
        [/delay]
        {SCROLL_TO 10 8}
        [time_area]
            id="DUSK"
            x="0-99"
            y="0-99"
            {DUSK}
        [/time_area]

        [remove_shroud]
            x,y=10,9
            radius=100
        [/remove_shroud]

        [modify_side]
            [filter_side]
                side=1
            [/filter_side]
            fog=yes
        [/modify_side]

        {CLEAR_FOG 1 10 7 3}
        {CLEAR_FOG 1 10 9 3}

        [unit]
            type=Elder Mage
            id=CU
            name= _ "Crelanu"
            side=5
            x,y=10,7
            canrecruit=yes
            facing=se
            [modifications]
                {TRAIT_INTELLIGENT}
                {TRAIT_AGED}
            [/modifications]
        [/unit]

#define HITPOINTS HP
    [+unit]
        hitpoints={HP}
    [/unit]
#enddef
        {GENERIC_UNIT 3 "Troll Initiate" 11 9} {HITPOINTS 5}
        {GENERIC_UNIT 3 "Troll Whelp"    10 9} {HITPOINTS 15}
        {GENERIC_UNIT 3 "Orcish Warrior"  9 9} {HITPOINTS 25}

        {PLACE_IMAGE "units/trolls/whelp-die-6.png~RC(magenta>black)" 8 12}

        {PLACE_IMAGE "units/orcs/grunt-ne-die-8.png~RC(magenta>red)" 9 10}

        {PLACE_IMAGE "units/goblins/spearman-die-4.png~RC(magenta>darkred)" 11 10}

        {PLACE_IMAGE "units/saurians/skirmisher/skirmisher-ne-die4.png~RC(magenta>lightblue)" 10 11}
        {PLACE_IMAGE "units/saurians/augur/augur-ne-die4.png~RC(magenta>lightblue)" 7 15}

        {FADE_IN}

        [message]
            speaker=narrator
            caption=_"Crelanu"
            image=portraits/crelanu.webp
            message= "<i>" + _"Some years later, a few members of the unfortunate Golden Flame Tribe found themselves in the far north, besieging my wizard’s tower as orcs so often do." + "</i>"
        [/message]

        [message]
            speaker=narrator
            caption=_"Crelanu"
            image=portraits/crelanu.webp
            message= "<i>" + _"Their attack failed. I took prisoners, from whom I learned this story. And now you have learned it from me." + "</i>"
        [/message]

        {FADE_TO_BLACK}

        [kill]
            x="1-99"
            y="1-99"
        [/kill]

        [message]
            speaker=narrator
            message= "<i>" + _"Trolls are often thought of as beasts, bloodthirsty monsters who only do bad things. Perhaps many are. But many were not always so." + "</i>"
        [/message]

        [endlevel]
            result=victory
            bonus,linger_mode,carryover_report,replay_save=no,no,no,no
            music=silence.ogg
            {NEW_GOLD_CARRYOVER 0}
        [/endlevel]
    [/event]

    [time_area]
        x="0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20"
        y="9-16,8-16,7-16,8-16,8-16,7-16,6-16,7-16,7-16,8-16,7-16,8-16,7-16,8-16,7-16,7-16,7-16,7-16,7-16,9-16,9-16"
        {UNDERGROUND}
    [/time_area]
[/scenario]
