#textdomain wesnoth-dod

[scenario]
    id=01_First_Steps
    name= _ "First Steps"
    map_data="{~add-ons/Dusk_of_Dawn/maps/East_Passage.map}"
#ifdef NORMAL
	turns=30
#endif
#ifdef HARD
	turns=27
#endif
    next_scenario=02_A_Dream
    victory_when_enemies_defeated=yes
	theme=Default
	
	{DEEP_UNDERGROUND}
	
    {SCENARIO_MUSIC into_the_shadows.ogg}
	{EXTRA_SCENARIO_MUSIC frantic-old.ogg}
	{EXTRA_SCENARIO_MUSIC underground.ogg}
	
	[story]
	    [part]
			music=revelation.ogg
			{DOD_STORY}
            story="<i>" + _"As the first awakened, Ougl became the leader of his tribe." +  _"</i>"
        [/part]
		[part]
			{DOD_STORY}
            story="<i>" +  _"The children of stone moved forward. Their path — not an easy one — led through intricate corridors deep underground. They did not know light, for it never reached these deep places. The air was cold." +  _"</i>"
        [/part]
		[part]
            show_title=yes
			{DOD_STORY}
            story="<i>" +  _"When the Golden Flame Tribe (as I will henceforth call them) entered tunnels that had once belonged to the bearded race, one of the trolls began to behave quite unusually." +  _"</i>"
        [/part]
    [/story]
    
# wmllint: validate-off
    [side]
        side=1
        controller=human
        recruit="Troll Whelp"
        {GOLD 0 100 85}
		income=0
        team_name=good
        color=brightorange
        user_team_name= _ "Golden Flame Tribe"
        {FLAG_VARIANT6 ragged}
		shroud=yes
		fog=yes
		
		# wmllint: recognize Ougl
		{CHARACTER_STATS_OUGL}
		
		facing=se
		animate=yes
		
    [/side]
# wmllint: validate-on

	[side]
        side=2
        controller=ai
        recruit="Fire Wisp, Fire Guardian"
        {GOLD 0 50 65}
#ifdef NORMAL
		income=0
#endif
#ifdef HARD
		income=4
#endif
        team_name=bad_north_west
        color=orange
        user_team_name= _ "Inner Flame"
        {FLAG_VARIANT6 ragged}
		
		[ai]
            grouping=offensive
			passive_leader=yes
			
            {AI_SIMPLE_NIGHT_ASPECT aggression 0.5}
            {AI_SIMPLE_DAY_ASPECT aggression 0.5}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.0}
            
            [goal]
                [criteria]
                    side=1
                [/criteria]
                value=5
            [/goal]
        [/ai]
		
    [/side]
	
	[side]
        side=3
        controller=ai
        recruit="Troll Whelp"
        {GOLD 0 55 70}
#ifdef NORMAL
		income=0
#endif
#ifdef HARD
		income=4
#endif
        team_name=bad_north_east
        color=white
        user_team_name= _ "Ash Flame Tribe"
        {FLAG_VARIANT6 ragged}
		
		[ai]
            grouping=defensive
			passive_leader=no
            
            {AI_SIMPLE_NIGHT_ASPECT aggression 0.5}
            {AI_SIMPLE_DAY_ASPECT aggression 0.5}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.2}
            
            [goal]
                [criteria]
                    side=1
                [/criteria]
                value=5
            [/goal]
        [/ai]
		
    [/side]
	
	[side]
        side=4
        controller=ai
        recruit=""
        {GOLD 0 0 0}
        income=0
        team_name=animals
        color=brown
        user_team_name= _ "Cave Dwellers"
        {FLAG_VARIANT6 ragged}
		
		[ai]
            grouping=defensive
            
            {AI_SIMPLE_NIGHT_ASPECT aggression 0.3}
            {AI_SIMPLE_DAY_ASPECT aggression 0.3}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.3}
        [/ai]
		
		{GENERIC_UNIT 4 (Giant Rat) 10 14 } {GUARDIAN}
		{GENERIC_UNIT 4 (Giant Rat) 13 16 } {GUARDIAN}
		{GENERIC_UNIT 4 (Giant Rat) 9 17 } {GUARDIAN}
		{GENERIC_UNIT 4 (Giant Rat) 16 7 } {GUARDIAN}
		
		{GENERIC_UNIT 4 (Giant Scorpion) 12 9 } {GUARDIAN}
		{GENERIC_UNIT 4 (Giant Scorpling) 21 12 } {GUARDIAN}
		
		{GENERIC_UNIT 4 (Mudcrawler) 24 16 } {GUARDIAN}
		
    [/side]
	
	[event]
        name=prestart
		
		{EVENT_ECHOES_OF_THE_EARTH 13 6 EOTE}
		
		{OBJ_BLUE_POTION 10 11 BP}
		
		[objectives]
            [objective]
                description= _ "Defeat the Inner Flame and Ash Flame leaders"
                condition=win
            [/objective]
			[objective]
                description= _ "Death of Ougl"
                condition=lose
            [/objective]
			
			{TURNS_RUN_OUT}

            [gold_carryover]
                bonus=yes
                carryover_percentage=40
            [/gold_carryover]
			
        [/objectives]
		
	[/event]
	
	[event]
        name=start
		
		[kill]
			side=1
			[not]
				id=OL
			[/not]
		[/kill]
		
		[delay]
            time=1500
            accelerate=yes
        [/delay]
		
		{MOVE_UNIT id=OL 3 17}
		
		[delay]
            time=1000
            accelerate=yes
        [/delay]
		
		[sound]
			name="data/core/sounds/troll-die-1.ogg"
		[/sound]
		
		[message]
            speaker=OL
            message= _ "<b>Ougl ! ! !</b>"
        [/message]
		
		[delay]
            time=500
            accelerate=yes
        [/delay]
        
        [modify_unit]
		    [filter]
		        id=OL
		    [/filter]
		    facing=sw
	    [/modify_unit]
		
		[unit]
		    type=Troll Whelp
            id=AU
			name=Arru
            canrecruit=no
			side=1
			
			x,y=2,17
			animate=yes
			facing=se
			
			[modifications]
                {TRAIT_LOYAL}
				{TRAIT_RESILIENT}
            [/modifications]
		[/unit]
		
		[unit]
		    type=Troll Whelp
            id=GO
			name=Gao
            canrecruit=no
			side=1
			
			x,y=3,18
			animate=yes
			facing=se
			
			[modifications]
                {TRAIT_LOYAL}
				{TRAIT_QUICK}
            [/modifications]
		[/unit]
		
		[unit]
		    type=Troll Whelp
            id=NM
			name=Nuum
            canrecruit=no
			side=1
			
			x,y=2,18
			animate=yes
			facing=se
			
			[modifications]
                {TRAIT_LOYAL}
				{TRAIT_FEARLESS}
            [/modifications]
		[/unit]
		
		[message]
            speaker=narrator
			image=wesnoth-icon.png
            message= _ "<i>Suddenly, one of the trolls began to behave strangely.</i>"
        [/message]
		
		[unit]
		    type=Troll Whelp
            id=UG
            name= _ "Strange Troll"
            canrecruit=no
			side=1
			
			x,y=5,17
			animate=yes
			facing=sw
		[/unit]
		
		[modify_unit]
		    [filter]
		        id=OL
		    [/filter]
		    facing=se
	    [/modify_unit]
		
		[delay]
            time=1500
            accelerate=yes
        [/delay]
		
		[animate_unit]
		    flag=attack
		    [filter]
			    id=UG
			[/filter]
			
		    [facing]
                x,y=5,16
            [/facing]
			
			[primary_attack]
				range=melee
			[/primary_attack]
		[/animate_unit]
		
		[delay]
            time=500
            accelerate=yes
        [/delay]
		
		[terrain]
            x,y=5,16
            terrain=Xur
        [/terrain]
		
		[redraw]
		[/redraw]
		
		{QUAKE (rumble.ogg)}
		
		[delay]
            time=500
            accelerate=yes
        [/delay]
		
		[modify_unit]
		    [filter]
		        id=UG
		    [/filter]
		    facing=sw
	    [/modify_unit]
		
		[delay]
            time=500
            accelerate=yes
        [/delay]
		
		[sound]
			name="data/core/sounds/troll-die-2.ogg"
		[/sound]
		
		[message]
            speaker=UG
            message= _ "<b>Ullg ! ! !</b>"
        [/message]
		
		[delay]
            time=1000
            accelerate=yes
        [/delay]
		
		{FADE_TO_BLACK}
		
		[delay]
            time=1500
            accelerate=yes
        [/delay]
		
		{FLASH_RED ()}
		
		[sound]
			name="data/core/sounds/fire.wav"
		[/sound]
		
		[modify_unit]
		    [filter]
		        id=UG
		    [/filter]
		    side=3
			canrecruit=yes
			name=Ullg the Flameless
	    [/modify_unit]
		
		[unit]
		    type=Fire Guardian
            id=IF
            name= _ "Inner Flame"
            canrecruit=yes
			side=2
			
			x,y=5,17
			animate=yes
			facing=sw
		[/unit]
		
		[delay]
            time=1000
            accelerate=yes
        [/delay]
		
		{FADE_IN}
		
		[delay]
            time=1000
            accelerate=yes
        [/delay]
		
		{MOVE_UNIT id=UG 22 4}
		
		[modify_unit]
		    [filter]
		        id=UG
		    [/filter]
		    facing=sw
	    [/modify_unit]
		
		{SCROLL_TO 22 4}
		
		[delay]
            time=500
            accelerate=yes
        [/delay]
		
		[remove_shroud]
            side=1
            x,y=22,4
            radius=3
        [/remove_shroud]
		
		[delay]
            time=1000
            accelerate=yes
        [/delay]
		
		[message]
            speaker=IF
            message= _ "<b>S s s s . . . !</b>"
        [/message]
		
		{MOVE_UNIT id=IF 7 5}
		
		[modify_unit]
		    [filter]
		        id=IF
		    [/filter]
		    facing=se
	    [/modify_unit]
		
		{SCROLL_TO 7 5}
		
		[delay]
            time=500
            accelerate=yes
        [/delay]
		
		[remove_shroud]
            side=1
            x,y=7,5
            radius=3
        [/remove_shroud]
		
		[delay]
            time=1000
            accelerate=yes
        [/delay]
		
		{SCROLL_TO 3 17}
		
		[delay]
            time=1500
            accelerate=yes
        [/delay]
		
		[message]
            speaker=OL
            message= _ "<b>Ougl ?</b>"
        [/message]
		
		[delay]
            time=500
            accelerate=yes
        [/delay]
		
		[animate_unit]
		    flag=attack
		    [filter]
			    id=OL
			[/filter]
			
		    [facing]
				x,y=3,16
            [/facing]
			
			[primary_attack]
			    range=melee
			[/primary_attack]
		[/animate_unit]
		
		[terrain]
            x,y=3,16
            terrain=Cte^Es
        [/terrain]
		
		[redraw]
		[/redraw]
		
		[delay]
            time=500
            accelerate=yes
        [/delay]
		
		[animate_unit]
		    flag=attack
		    [filter]
			    id=OL
			[/filter]
			
		    [facing]
				x,y=4,16
            [/facing]
			
			[primary_attack]
			    range=melee
			[/primary_attack]
		[/animate_unit]
		
		[terrain]
            x,y=4,16
            terrain=Cte
        [/terrain]
		
		[redraw]
		[/redraw]
		
		[delay]
            time=500
            accelerate=yes
        [/delay]
		
		[animate_unit]
		    flag=attack
		    [filter]
			    id=OL
			[/filter]
			
		    [facing]
				x,y=4,17
            [/facing]
			
			[primary_attack]
			    range=melee
			[/primary_attack]
		[/animate_unit]
		
		[terrain]
            x,y=4,17
            terrain=Cte
        [/terrain]
		
		[redraw]
		[/redraw]
		
		[delay]
            time=500
            accelerate=yes
        [/delay]
		
		[animate_unit]
		    flag=attack
		    [filter]
			    id=OL
			[/filter]
			
		    [facing]
				x,y=4,16
            [/facing]
			
			[primary_attack]
			    range=melee
			[/primary_attack]
		[/animate_unit]
		
		[terrain]
            x,y=3,17
            terrain=Kte
        [/terrain]
		
		[redraw]
		[/redraw]
		
		[delay]
            time=500
            accelerate=yes
        [/delay]
		
		{MOVE_UNIT id=AU 3 16}
		
		[delay]
            time=500
            accelerate=yes
        [/delay]
		
		{MOVE_UNIT id=GO 4 16}
		
		[delay]
            time=500
            accelerate=yes
        [/delay]
		
		{MOVE_UNIT id=NM 4 17}
		
		[delay]
            time=500
            accelerate=yes
        [/delay]
		
	[/event]
	
	[event]
        name=moveto
        first_time_only=yes
        [filter]
            side=1
			id=LA
            x,y=8,10
        [/filter]
		
		[sound]
			name=hiss-die.wav
		[/sound]
		
		[message]
            speaker=unit
            message= _ "<b>H i s s . . . !</b>"
		[/message]
		
		[animate_unit]
		    flag=attack
		    [filter]
			    id=$unit.id
			[/filter]
			
		    [facing]
				x,y=9,11
            [/facing]
			
			[primary_attack]
			    range=ranged
			[/primary_attack]
		[/animate_unit]
		
		[delay]
            time=500
            accelerate=yes
        [/delay]
		
		[terrain]
            x,y=8,10
            terrain=Cfr^Ebn
        [/terrain]
		
		[redraw]
		[/redraw]
		
		[delay]
            time=1000
            accelerate=yes
        [/delay]
		
		{QUAKE (rumble.ogg)}
		
		[terrain]
            x,y=9,11
            terrain=Uh^Dr
        [/terrain]
		
		[redraw]
		[/redraw]
		
		[set_achievement]
            content_for=dusk_of_dawn
            id="dod_sbc"
        [/set_achievement]
        
    [/event]
	
	[event]
        name=moveto
        first_time_only=yes
        [filter]
            side=1
            x,y=25,18
        [/filter]
		
		[message]
            speaker=unit
            message= _ "<b>. . . ?</b>"
		[/message]
		
		[message]
            speaker=narrator
			image=wesnoth-icon.png
            message= _ "<i>The finder of the mysterious egg made a decision without much thought.</i>"
        [/message]
		
		[delay]
            time=500
            accelerate=yes
        [/delay]
		
		[animate_unit]
			flag=attack
			[filter]
				id=$unit.id
			[/filter]
	
			hit=yes
	
			[facing]
				x,y=26,18
			[/facing]
	
			[primary_attack]
				range=melee
			[/primary_attack]
		[/animate_unit]
		
		{REMOVE_IMAGE 25 18}
		
		[sound]
			name=hiss-die.wav
		[/sound]
		
		[unit]
		    type=Fire Ant
            id=LA
            name= _ "Lonely Ant"
            canrecruit=no
			side=1
			
			x,y=25,18
			animate=yes
			passable=yes
			
			[modifications]
				{TRAIT_LOYAL}
			[/modifications]
		[/unit]
		
		[modify_unit]
			[filter]
				id=LA
			[/filter]
			[object]
			    duration=forever
                [effect]
					apply_to=movement_costs
					replace=yes
					[movement_costs]
						cave=1
					[/movement_costs]
				[/effect]
			[/object]
		[/modify_unit]
		
		[delay]
            time=1500
            accelerate=yes
        [/delay]
		
		[message]
            speaker=narrator
			image=wesnoth-icon.png
            message= _ "<i>There are many unexplainable things in this world. This is one — the little ant decided to join the trolls.</i>"
        [/message]
		
	[/event]
	
	[event]
        name=turn 3
		
		[gold]
			side=2
			amount=15
		[/gold]
		
		{GENERIC_UNIT 4 (Vampire Bat) 8 19 }
		{GENERIC_UNIT 4 (Vampire Bat) 27 14 }
		
	[/event]
	
	[event]
        name=turn 5
		
		[gold]
			side=2,3
			amount=15
		[/gold]
		
	[/event]
	
	[event]
        name=turn 12
		
		[gold]
			side=3
			amount=45
		[/gold]
		
		{GENERIC_UNIT 4 (Vampire Bat) 8 19 }
		{GENERIC_UNIT 4 (Vampire Bat) 27 14 }
		
	[/event]
	
	[event]
        name=last breath
		[filter]
            id=IF
        [/filter]
		
		[message]
            speaker=IF
            message= _ "<b>S s s s . . . !</b>"
		[/message]
		
	[/event]
	
	[event]
        name=last breath
		[filter]
            id=UG
        [/filter]
		
		[message]
            speaker=UG
            message= _ "<b>Ullg . . . !</b>"
        [/message]
		
	[/event]
	
	[event]
        name=enemies defeated
		
		[message]
            speaker=OL
            message= _ "<b>. . .</b>"
		[/message]
		
		[message]
            speaker=narrator
			image=wesnoth-icon.png
            message= _ "Ougl has learned how to control his inner flame. You can now recruit <b>Fire Guardians</b>."
        [/message]
		
		[delay]
            time=1000
            accelerate=yes
        [/delay]
		
		[message]
            speaker=narrator
			image=wesnoth-icon.png
            message= _ "Also... some of the trolls, like their leader, began to feel a mysterious connection to fire. You can now recruit <b>Troll Initiates</b>."
        [/message]
		
		[allow_recruit]
            side=1
            type="Fire Guardian, Troll Initiate"
        [/allow_recruit]
		
		[delay]
            time=1000
            accelerate=yes
        [/delay]
		
		{HIGHLIGHT_IMAGE 23 4 scenery/trapdoor-open.png ()}
		
		[message]
            speaker=narrator
            image=wesnoth-icon.png
            message= _ "<i>There is an open trapdoor in the ruined dwarven castle. Do you want to go through it and play the bonus level?</i>"
			[option]
		        label="I will play the bonus scenario."
			    [command]
		            
					[endlevel]
                        next_scenario=Secret
						result=victory
                        bonus=yes
                        {NEW_GOLD_CARRYOVER 40}
                    [/endlevel]
					
			    [/command]
		    [/option]
			[option]
		        label="I don't want to play the bonus scenario."
			    [command]
					
					[endlevel]
                        result=victory
                        bonus=yes
                        {NEW_GOLD_CARRYOVER 40}
                    [/endlevel]
					
			    [/command]
		    [/option]
        [/message]
		
	[/event]
	
	[time_area]
		x="3,3,4,5,6,6,7,7,8,8,9,10,11,12"
		y="5,7,3-7,3-7,2-4,6-7,3-4,7,2-4,6-7,3-7,4-7,4-7,4-5"
		{LAVA}
    [/time_area]
	
	{PLACE_IMAGE "units/monsters/ant/ant_red-egg.png" 25 18}
	
	{PLACE_IMAGE "scenery/rock2.png" 21 10}
	{PLACE_IMAGE "scenery/rock1.png" 9 15}
	
	{PLACE_IMAGE "scenery/trapdoor-open.png" 23 4}
	
	{HERODEATH_OUGL}
	{TIMEOVER}
	
[/scenario]
