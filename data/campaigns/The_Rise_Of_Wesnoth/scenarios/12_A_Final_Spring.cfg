#textdomain wesnoth-trow
[scenario]
    id=A_Final_Spring
    name= _ "A Final Spring"
    map_data="{campaigns/The_Rise_Of_Wesnoth/maps/A_Final_Spring.map}"
    {TURNS 39 36 33}

    {DEFAULT_SCHEDULE}

    next_scenario=Peoples_in_Decline
    bonus=yes

    [music]
        name="wanderer.ogg"
    [/music]
    {VICTORY_AND_DEFEAT_MUSIC}

    {campaigns/The_Rise_Of_Wesnoth/utils/trow-deaths.cfg}

    {A_FINAL_SPRING_BIGMAP}

    [side]
        description=Prince Haldric
        user_description= _ "Prince Haldric"
        side=1
        type=Noble Commander
        unrenamable=yes
        canrecruit=yes
        controller=human
        team_name=Haldric
    [/side]

    {STARTING_VILLAGES 1 12}

    [side]
        side=2
        type=Grand Knight
        description=King Addroran IX
        user_description= _ "King Addroran IX"
        profile="portraits/addroran.png"
        canrecruit=yes
        {GOLD 220 160 120}
        team_name=Haldric
        recruit=Bowman, Horseman, Mage, Spearman, Knight, Swordsman, Peasant
        [ai]
            {NO_SCOUTS}
            recruitment_ignore_bad_movement=yes
            grouping=defensive
            passive_leader=yes
            recruitment_pattern=fighter,fighter,archer,mixed fighter
        [/ai]
    [/side]

    {STARTING_VILLAGES 2 10}

    [side]
        type=Orcish Warlord
        description=Tan-Harak
        user_description= _ "Tan-Harak"
        side=3
        canrecruit=yes
#ifdef EASY
        recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbowman, Goblin Pillager, Goblin Knight, Goblin Spearman
#endif

#ifdef NORMAL
        recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbowman, Goblin Knight, Orcish Slayer, Orcish Warrior, Goblin Spearman
#endif

#ifdef HARD
        recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbowman, Orcish Warrior, Goblin Knight, Goblin Pillager, Orcish Slayer, Goblin Spearman
#endif
        {GOLD 210 250 290}
        team_name=orcs
        [ai]
            #{NO_SCOUTS}
            recruitment_ignore_bad_movement=yes
            recruitment_pattern=scout,fighter,fighter,archer
            {ATTACK_DEPTH 4 5 5}
        [/ai]
        [ai]
            time_of_day=dusk,first_watch,second_watch
            aggression=0.75
            caution=0.0
            grouping=no
        [/ai]
        {INCOME 2 4 8}
    [/side]

    [side]
        type=Orcish Warlord
        description=Tan-Hork
        user_description= _ "Tan-Hork"
        side=4
        canrecruit=yes
#ifdef EASY
        recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbowman, Goblin Pillager, Goblin Knight
#endif

#ifdef NORMAL
        recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbowman, Goblin Knight, Orcish Slayer, Orcish Warrior
#endif

#ifdef HARD
        recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbowman, Orcish Warrior, Goblin Knight, Goblin Pillager, Orcish Slayer
#endif
        {GOLD 210 250 290}
        team_name=orcs
        [ai]
            #{NO_SCOUTS}
            recruitment_ignore_bad_movement=yes
            recruitment_pattern=scout,fighter,fighter,archer
            {ATTACK_DEPTH 4 5 5}
        [/ai]
        [ai]
            time_of_day=dusk,first_watch,second_watch
            aggression=0.75
            caution=0.0
            grouping=no
        [/ai]
        {INCOME 2 4 8}
    [/side]

    [side]
        type=Orcish Warlord
        description=Tan-Gulo
        user_description= _ "Tan-Gulo"
        side=5
        canrecruit=yes
        recruit=Naga Fighter,Vampire Bat
        {GOLD 180 220 260}
        team_name=orcs
        [ai]
            {NO_SCOUTS}
            recruitment_ignore_bad_movement=yes
            recruitment_pattern=fighter,fighter,scout
            {ATTACK_DEPTH 4 5 5}
        [/ai]
        [ai]
            time_of_day=dusk,first_watch,second_watch
            aggression=0.75
            caution=0.0
            grouping=no
        [/ai]
        {INCOME 2 4 8}
    [/side]

    #Time Areas broken - no visible change, use a halo with it
    [time_area]
        x=1,1,1,2,2,2,2,3,3,3,3,3,4,4,4,4,5,5,5				#,6,6
        y=17,18,19,16,17,18,19,16,17,18,19,20,16,17,18,19,17,18,19	#,17,18
        {MORNING}
        {MORNING}
        {AFTERNOON}
        {AFTERNOON}
        {DUSK}
        {DAWN}
    [/time_area]

    [event]
        name=prestart

        #{PLACE_IMAGE (scenery/lighthouse.png) 3 18}
        [item]
            x=3
            y=18
            image=scenery/lighthouse.png
            halo=halo/lighthouse-aura.png
        [/item]

        {PLACE_IMAGE (units/transport/pirate-galleon.png) 17 24}
        {PLACE_IMAGE (units/transport/pirate-galleon.png) 20 22}
        {PLACE_IMAGE (units/transport/galleon.png) 21 25}
        {PLACE_IMAGE (scenery/trapdoor-closed.png) 16 30}
        {PLACE_IMAGE (scenery/signpost.png) 24 24}
        {PLACE_IMAGE (scenery/signpost.png) 30 44}
        {PLACE_IMAGE (scenery/signpost.png) 41 32}
        {PLACE_IMAGE (scenery/signpost.png) 16 4}
        {PLACE_IMAGE (scenery/signpost.png) 39 11}
        {PLACE_IMAGE (scenery/signpost.png) 18 17}

        [recall]
            description=Lady Jessica
            x=12
            y=27
        [/recall]
        [recall]
            description=Burin the Lost
            x=14
            y=27
        [/recall]
        [recall]
            description=Sir Ruddry
            x=12
            y=28
        [/recall]
        [recall]
            description=Sir Ladoc
            x=14
            y=28
        [/recall]
        [recall]
            description=Minister Edmond
            x=13
            y=29
        [/recall]

        {GUARD_UNIT (Swordsman) (Southbay Guard 1) ( _ "Southbay Guard") 2 19 33}
        {GUARD_UNIT (Swordsman) (Southbay Guard 2) ( _ "Southbay Guard") 2 21 30}
        {GUARD_UNIT (Swordsman) (Southbay Guard 3) ( _ "Southbay Guard") 2 28 24}
        {GUARD_UNIT (Swordsman) (Southbay Guard 4) ( _ "Southbay Guard") 2 27 22}
        # wmllint: recognize Southbay Guard 1

        [object]
            description= _ "The Ruby of Fire was imbued with magic in the distant west, and can be used to scorch enemies into submission."
            silent=yes
            duration=forever
            [filter]
                description=Prince Haldric
            [/filter]
            [effect]
                apply_to=new_attack
                name=ruby of fire
                description= _ "ruby of fire"
                icon=attacks/fireball.png
                type=fire
                range=ranged
                [specials]
                    {WEAPON_SPECIAL_MAGICAL}
                [/specials]
                damage=14
                number=4
            [/effect]

            [effect]
                apply_to=new_animation
                [attack_anim]
                    [attack_filter]
                        name=ruby of fire
                    [/attack_filter]

                    {MISSILE_FRAME_FIREBALL}

                    [frame]
                        begin=-200
                        end=0
                        sound=fire.wav
                    [/frame]
                [/attack_anim]
            [/effect]
        [/object]

        [objectives]
            side=1
            [objective]
                description= _ "Defeat all enemy leaders"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Prince Haldric"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Lady Jessica"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of King Addroran IX"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
            [/objective]
        [/objectives]
    [/event]

    [event]
        name=start
        [message]
            speaker=narrator
            message= _ "Several months pass. Jessica has translated Lich-Lord Caror's Book of Fire and Darkness. Prince Haldric is busy probing the secrets of the Ruby of Fire."
            image=wesnoth-icon.png
        [/message]
        [message]
            description=Prince Haldric
            message= _ "I think I've figured something out. Look."
        [/message]
        [sound]
            name=fire.wav
        [/sound]
        [move_unit_fake]
            type=Fireball
            x=13,12,12,14,13,12,13,14
            y=27,26,26,26,26,25,25,25
        [/move_unit_fake]
        [message]
            description=Prince Haldric
            message= _ "Ouch! Hot, hot, hot! Gee, somebody should really attach this thing to a scepter or something! I think I'll save it for closer-ranged combat for now."
        [/message]
        [message]
            description=Lady Jessica
            message= _ "Watch it! Well, at least you're improving."
        [/message]
        [message]
            description=Burin the Lost
            message= _ "Humph. Fool of a boy's just gonna burn us all up. Humans, always playing at being wizards."
        [/message]
        [message]
            description=Southbay Guard 1
            message= _ "Orcs sighted! They've seized the frontier! To arms! To arms!"
        [/message]
        [message]
            description=Sir Ladoc
            message= _ "For the glory of Southbay!"
        [/message]
        [message]
            description=King Addroran IX
            message= _ "Prince Haldric, I'll concentrate on holding Southbay. You must defeat the orcs. The ships aren't ready yet. We must defeat this army of orcs to buy us more time. Try not to kill us all with that ruby!"
        [/message]
        [message]
            description=Prince Haldric
            message= _ "Very well. I'll do my best."
        [/message]
    [/event]

    [event]
        name=turn 5
        [move_unit_fake]
            type=Merman Warrior
            side=1
            x=1,2,3,4
            y=21,20,20,19
        [/move_unit_fake]

        {HERO (Merman Warrior) (Lord Typhon) ( _ "Lord Typhon") 1 4 19 ("portraits/typhon.png")}
        # wmllint: recognize Lord Typhon

        [message]
            description=Lord Typhon
            message= _ "I come seeking the Crown Prince!"
        [/message]
        [message]
            description=King Addroran IX
            message= _ "Who is this fish man?"
        [/message]
        [message]
            description=Lady Jessica
            message= _ "He's a large part of the reason your son made it to the lands of the east. Lord Typhon provided us with pearls and an escort for our voyages in exchange for steel trident points and fishhooks. It's difficult to be a blacksmith when you live underwater."
        [/message]
        [message]
            description=Lord Typhon
            message= _ "Indeed it is. But where is the Prince?"
        [/message]
        [message]
            description=Lady Jessica
            message= _ "The Crown Prince is dead. But we have need of your services again- -"
        [/message]
        [message]
            description=Lord Typhon
            message= _ "Under the same terms?"
        [/message]
        [message]
            description=Lady Jessica
            message= _ "Agreed."
        [/message]
        [message]
            description=Lord Typhon
            message= _ "Good. We need the steel for our own war in the deep. I formally place the might of the Merfolk at your disposal!"
        [/message]

        [allow_recruit]
            type=Merman Fighter
        [/allow_recruit]
        [objectives]
            side=1
            [objective]
                description= _ "Defeat all enemy leaders"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Prince Haldric"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Lady Jessica"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of King Addroran IX"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Lord Typhon"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
            [/objective]
        [/objectives]
    [/event]

    [event]
        name=turn 30
        [message]
            description=King Addroran IX
            message= _ "Make haste. We must secure the frontier or it's all over!"
        [/message]
    [/event]

    [event]
        name=turn 4

        [move_unit_fake]
            type=Blood Bat
            side=5
            x=45,44,43,42
            y=22,22,23,23
        [/move_unit_fake]

        {UNDEAD_INTEL (Blood Bat) (Familiar) ( _ "Familiar") "portraits/familiar.png" 5 42 23}

        [move_unit_fake]
            type=Ancient Lich
            side=5
            x=45,44,43,42,42
            y=22,22,23,23,24
        [/move_unit_fake]

        {UNDEAD_INTEL (Ancient Lich) (Lich-Lord Jevyan) ( _ "Lich-Lord Jevyan") "portraits/jevyan.png" 5 42 24}
        # wmllint: recognize Lich-Lord Jevyan

        [message]
            description=Lich-Lord Jevyan
            message= _ "King Addroran, your day is done. Prepare to be ground to dust. If you're lucky I may raise you from death for my own amusement. Oh, and what's this? I sense, I sense the Ruby of Fire."
        [/message]
        [message]
            description=Lady Jessica
            message= _ "You monster! You've betrayed our people - to ally yourself with these orcs?!"
        [/message]

        {UNDEAD_INTEL (Death Knight) (Fool Prince) ( _ "Fool Prince") "unit_image" 5 43 24}
        # wmllint: recognize Fool Prince

        [message]
            description=Lich-Lord Jevyan
            message= _ "Fool girl! My ambition is boundless; I will survive to rule the orcs and all else. That is more than can be said for you. King Addroran, meet your son - you'll be joining him soon enough."
        [/message]
        [message]
            description=King Addroran IX
            message= _ "NO!"
        [/message]
        [message]
            description=Fool Prince
            message= _ "Fath-er! Join... us..."
        [/message]
        [message]
            description=Lady Jessica
            message= _ "His older brother was more attractive..."
        [/message]

        [kill]
            description=Lich-Lord Jevyan
        [/kill]

        [move_unit_fake]
            type=Ancient Lich
            side=5
            x=42,42,43,44,45
            y=24,23,23,22,22
        [/move_unit_fake]

        {LOYAL_UNDEAD_UNIT 5 (Revenant) 41 22}
        {LOYAL_UNDEAD_UNIT 5 (Bone Shooter) 43 24}
#ifdef NORMAL
        {LOYAL_UNDEAD_UNIT 5 (Chocobone) 42 23}
        {LOYAL_UNDEAD_UNIT 5 (Chocobone) 43 23}
#endif

#ifdef HARD
        {LOYAL_UNDEAD_UNIT 5 (Chocobone) 42 23}
        {LOYAL_UNDEAD_UNIT 5 (Chocobone) 43 23}
        {LOYAL_UNDEAD_UNIT 5 (Necrophage) 44 23}
        {LOYAL_UNDEAD_UNIT 5 (Necrophage) 44 22}
#endif
        [kill]
            description=Familiar
        [/kill]

        [move_unit_fake]
            type=Blood Bat
            side=5
            x=42,43,44,45
            y=23,23,22,22
        [/move_unit_fake]
    [/event]

    [event]
        name=time over
        [message]
            description=Lady Jessica
            message= _ "Their reserves are arriving, and we haven't secured the frontier! We're dead!"
        [/message]
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            x=24
            y=24
        [/filter]

        [redraw]
        [/redraw]

        [message]
            speaker=narrator
            message= _ "Southbay"
            image=wesnoth-icon.png
        [/message]
        [allow_undo]
        [/allow_undo]
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            x=30
            y=44
        [/filter]

        [redraw]
        [/redraw]

        [message]
            speaker=narrator
            message= _ "To Clearwater Port"
            image=scenery/signpost.png
        [/message]
        [allow_undo]
        [/allow_undo]
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            x=41
            y=32
        [/filter]

        [redraw]
        [/redraw]

        [message]
            speaker=narrator
            message= _ "To the Midlands & Oldwood"
            image=scenery/signpost.png
        [/message]
        [allow_undo]
        [/allow_undo]
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            x=16
            y=4
        [/filter]

        [redraw]
        [/redraw]

        [message]
            speaker=narrator
            message= _ "To the Northrun"
            image=scenery/signpost.png
        [/message]
        [allow_undo]
        [/allow_undo]
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            x=39
            y=11
        [/filter]

        [redraw]
        [/redraw]

        [message]
            speaker=narrator
            message= _ "To the Midlands"
            image=scenery/signpost.png
        [/message]
        [allow_undo]
        [/allow_undo]
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            x=18
            y=17
        [/filter]

        [redraw]
        [/redraw]

        [message]
            speaker=narrator
            message= _ "New Southbay"
            image=wesnoth-icon.png
        [/message]
        [allow_undo]
        [/allow_undo]
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            x=16
            y=30
        [/filter]

        [redraw]
        [/redraw]

        [message]
            speaker=narrator
            message= _ "They sealed it, there is no escape for you!"
            image=wesnoth-icon.png
        [/message]
        [allow_undo]
        [/allow_undo]
    [/event]

    [event]
        name=die
        [filter]
            description=King Addroran IX
        [/filter]
        [message]
            speaker=unit
            message= _ "I am finished."
        [/message]
        [message]
            description=Prince Haldric
            message= _ "We needed him to hold Southbay. We're done for!"
            image=portraits/haldric-mad.png
        [/message]

        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    [event]
        name=victory
        [message]
            description=Prince Haldric
            message= _ "We've defeated the orcs. Let's rig the ships and get out of here."
        [/message]
        [message]
            description=King Addroran IX
            message= _ "Oh, for my sons... - As we agreed. I will hold Southbay until my last breath."
        [/message]
        [message]
            description=Lady Jessica
            message= _ "With the help of the Merfolk, and my knowledge of an island that will make a good re-provisioning point, we should be able to embark for the great lands that are to the east."
        [/message]
        [message]
            description=Lady Jessica
            message= _ "What I don't like is the fact that Lich-Lord Jevyan, after whom our very capital is named, betrayed my people. To make matters worse, he knows that you have that ruby."
        [/message]
        [message]
            description=Prince Haldric
            message= _ "There's not much we can do about that now. I dub this fine ship the Eldaric, in honor of my father. About that island..."
        [/message]
        [message]
            description=Burin the Lost
            message= _ "Great, more boats, and now an ocean!"
        [/message]
        [message]
            description=King Addroran IX
            message= _ "After you make it to this new land, send some of the ships back, for there may still be survivors in Southbay."
        [/message]
    [/event]

    [event]
        name=die
        [filter]
            description=Fool Prince
        [/filter]

        [message]
            description=King Addroran IX
            message= _ "My son!"
        [/message]
    [/event]

    [event]
        name=attack

        [filter]
            description=King Addroran IX
        [/filter]

        [message]
            description=King Addroran IX
            message= _ "For the glory of Southbay!"
        [/message]
    [/event]
[/scenario]
