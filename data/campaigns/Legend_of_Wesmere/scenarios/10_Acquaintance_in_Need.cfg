#textdomain wesnoth-low
[scenario]
    id=10_Acquaintance_in_Need
    next_scenario=11_Elves_Last_Stand
    name= _ "Acquaintance in Need"
    {LOW_MAP 09_Acquaintance_in_Need.map}
    victory_when_enemies_defeated=yes
    carryover_percentage=40
    carryover_add=yes
    {DEFAULT_SCHEDULE}
    {TURNS 35 32 29}

    {INTRO_AND_SCENARIO_MUSIC sad.ogg the_king_is_dead.ogg}
    {EXTRA_SCENARIO_MUSIC                     wanderer.ogg}
    {EXTRA_SCENARIO_MUSIC                nunc_dimittis.ogg}

    [story]
        [part]
            # The space at the end stops the last letter from getting cut off. Newlines at the end offset the text to slightly above centered.
            title="<span font_family='WesScript' size='60000'><i>" + _"Chapter Three: Against the Storm" + " </i></span>

"
            title_position=centered
        [/part]
        [part]
            story= _ "No sooner had the heroes run out of the cave than a deafening roar sounded behind them. The dark magic released after the seal’s destruction brought the ceiling crashing down. Lord Erlornas and hundreds of saurians remained buried under a mass of stone..."
        [/part]
        [part]
            background="story/characters/landar.webp"
            scale_background=no
            story={CAPTION ( _ "Landar")} + _ " I can’t believe it was all in vain!"
        [/part]
        [part]
            background="story/characters/cleodil.webp"
            scale_background=no
            story={CAPTION ( _ "Cleodil")} + _ "Erlornas, my lord... is gone..."
        [/part]
        [part]
            background="story/characters/kalenz.webp"
            scale_background=no
            story={CAPTION ( _ "Kalenz")} + _ "He sacrificed himself for us. We must not fail him."
        [/part]
        [part]
            background="story/characters/landar.webp"
            scale_background=no
            story={CAPTION ( _ "Landar")} + _ "What are you going to do, Kalenz?"
        [/part]
        [part]
            background="story/characters/kalenz.webp"
            scale_background=no
            story={CAPTION ( _ "Kalenz")} + _ "The lord expected us to continue his work. If the orcs are preparing a new strike against Wesmere, we must be there."
        [/part]
        [part]
            background="story/characters/landar.webp"
            scale_background=no
            story={CAPTION ( _ "Landar")} + _ "We have shed enough blood for Wesmere, but the Council did nothing to help us! What if they refuse us again? We will waste time and strength, and meanwhile the orcs will continue to ravage our home!"
        [/part]
        [part]
            background="story/characters/cleodil.webp"
            scale_background=no
            story={CAPTION ( _ "Cleodil")} + _ "If you do not go to Wesmere, then we must part ways. I cannot abandon my forest now, when its fate hangs by a thread."
        [/part]
        [part]
            background="story/characters/kalenz.webp"
            scale_background=no
            story={CAPTION ( _ "Kalenz")} + _ "No, Cleodil, I don’t want to lose you too. Listen, this is what Lord Erlornas spoke about. Our fates are linked, but the enemy is trying to divide us. Landar, if Wesmere falls, all those orc hordes will add to the ones besieging our home, and then there will be no hope left. That’s why it’s crucial for us to protect it now."
        [/part]
        [part]
            background="story/characters/landar.webp"
            scale_background=no
            story={CAPTION ( _ "Landar")} + _ "I understand that. I just don’t want to lose my home while defending allies."
        [/part]
        [part]
            background="story/characters/cleodil.webp"
            scale_background=no
            story={CAPTION ( _ "Cleodil")} + _ "I promise, Landar, after we defend Ka’lian, I will follow you and fight for Lintanir as fiercely as you fought for Wesmere."
        [/part]
        [part]
            background="story/characters/landar.webp"
            scale_background=no
            story={CAPTION ( _ "Landar")} + _ "So be it."
        [/part]
    [/story]

    {LOW_TRACK {SCENARIO_9}}

    [side]
        side=1
        {SIDE_1_ESSENTIALS}
        {KALENZ}
        {SIDE_1_GOLD_FIXED 200 120}
        income=-2
        village_gold=1
        fog=no
        shroud=no
        [unit]
            {CLEODIL_COMPANION}
            placement=leader
        [/unit]
#ifndef MULTIPLAYER
        [unit]
            {LANDAR}
            location_id=2
        [/unit]
#endif
    [/side]

    [side]
        side=2
        {SIDE_2_ESSENTIALS}
        {LANDAR}
        gold=120
        income=-2
        village_gold=1
        fog=no
        shroud=no
    [/side]

    [side]
        side=3
        {UNPLAYABLE_SIDE}
        team_name=trolls
        user_team_name= _ "Enemies"
        {FLAG_VARIANT ragged}
        type=Orcish Warlord
        id=Urug-Tar
        name=_ "Urug-Tar"
        canrecruit=yes
        {GOLD 200 240 260}
        {INCOME 5 10 15}
#ifdef EASY
        recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbowman, Goblin Pillager, Goblin Knight
#endif
#ifdef NORMAL
        recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbowman, Goblin Pillager, Goblin Knight, Orcish Slayer
#endif
#ifdef HARD
        recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbowman, Goblin Pillager, Goblin Knight, Orcish Slayer, Orcish Warrior
#endif
        [ai]
            passive_leader=yes
            recruitment_pattern="fighter, archer, scout, fighter, fighter, archer, mixed fighter"
            grouping=offensive
        [/ai]
    [/side]

    [side]
        side=4
        {UNPLAYABLE_SIDE}
        team_name=trolls
        user_team_name= _ "Enemies"
        {FLAG_VARIANT ragged}
        type=Troll Warrior
        id=Traur
        name=_ "Traur"
        canrecruit=yes
        {INCOME 5 10 15}
        {GOLD 160 200 240}
#ifdef EASY
        recruit=Troll Whelp
#endif
#ifdef NORMAL
        recruit=Troll Whelp, Troll, Troll Mentor
#endif
#ifdef HARD
        recruit=Troll Whelp, Troll, Troll Mentor, Troll Pastor, Troll Warrior
#endif
        [ai]
            passive_leader=yes
            recruiment_pattern=fighter,fighter,fighter,mixed fighter
            grouping=no
        [/ai]
    [/side]

#ifndef EASY
    {LIMIT_CONTEMPORANEOUS_RECRUITS 4 "Troll Mentor" 2}
#endif
#ifdef HARD
    {LIMIT_CONTEMPORANEOUS_RECRUITS 4 "Troll Pastor" 1}
#endif

    [side]
        side=5
        {UNPLAYABLE_SIDE}
        team_name=trolls
        user_team_name= _ "Enemies"
        {FLAG_VARIANT ragged}
        type=Orcish Warlord
        id=Graur-Tan
        name=_ "Graur-Tan"
        canrecruit=yes
        {GOLD 200 260 320}
        {INCOME 5 10 15}
#ifdef EASY
        recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbowman, Goblin Knight, Goblin Pillager
#endif
#ifdef NORMAL
        recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbowman, Goblin Knight, Goblin Pillager, Orcish Slayer
#endif
#ifdef HARD
        recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbowman, Goblin Knight, Goblin Pillager, Orcish Slayer, Orcish Warrior
#endif
        [ai]
            passive_leader=yes
            recruitment_pattern="scout,fighter,fighter,archer,mixed fighter"
            grouping=offensive
        [/ai]
    [/side]

    {STARTING_VILLAGES 6 4}

    [side]
        side=6
        {UNPLAYABLE_SIDE}
        persistent=yes
        save_id=Olurf
        team_name=player
        user_team_name= _ "Heroes"
        {FLAG_VARIANT knalgan}
        {OLURF}
        gold=100
        income=8
        recruit=Dwarvish Fighter, Dwarvish Scout, Dwarvish Thunderer, Dwarvish Ulfserker, Dwarvish Guardsman

        [ai]
            recruitment_pattern=fighter,fighter,mixed fighter
            [goal]
                name=target_unit
                [criteria]
                    side=3
                [/criteria]
                value=0.5
            [/goal]
            [goal]
                name=target_unit
                [criteria]
                    side=4
                [/criteria]
                value=1
            [/goal]
            [goal]
                name=target_unit
                [criteria]
                    side=5
                [/criteria]
                value=1
            [/goal]
        [/ai]
    [/side]

    [event]
        name=prestart

        [store_unit]
            [filter]
                side=6
                x,y=recall,recall
                search_recall_list=yes
            [/filter]
            kill=no
            variable=dwarves
        [/store_unit]

        [foreach]
            array=dwarves
            index_var=i

            [do]
                [recall]
                    id=$this_item.id
                    placement=leader
                    show=no
                [/recall]
            [/do]
        [/foreach]
        {CLEAR_VARIABLE dwarves}
        {MODIFY_UNIT side=1,2 facing sw}
    [/event]

    [event]
        name=prestart

        [objectives]
            side=0
            [objective]
                description= _ "Defeat all enemy leaders"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Kalenz"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Landar"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Erlornas"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Cleodil"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Olurf"
                condition=lose
            [/objective]
            {TURNS_RUN_OUT}
            [gold_carryover]
                bonus=yes
                carryover_percentage=40
            [/gold_carryover]
        [/objectives]
    [/event]

    [event]
        name=start

        [message]
            id=Kalenz
            message= _ "What’s this? It appears the orcs have surrounded a dwarvish enclave. And by the sound of the bellowing I hear, I think these are the same dwarves we met on the way to Ka’lian."
        [/message]
        [message]
            id=Olurf
            message= _ "You again? Maybe ye were not completely wrong when ye predicted the orcs would attack us. We ha’ been forced from our home and are now surrounded."
        [/message]
        [message]
            id=Cleodil
            message= _ "Let us give them aid — it’s clear they need it!"
        [/message]
        [message]
            id=Landar
            message= _ "Help them? They would not even let us pass through their land to avoid the trolls. You remember, Kalenz?"
        [/message]
        [message]
            id=Kalenz
            message= _ "Our enemy is the orcs, not the dwarves. Besides, the orcs are in our way. Olurf, we cannot let you have all the fun here!"
        [/message]
        [message]
            id=Olurf
            message= _ "For an elf, you think like a dwarf! I think I like you! " + {WHISPER _"whisper^—For an elf..."}
        [/message]
    [/event]

    [event]
        name=scenario_end
        [filter_condition]
            [proceed_to_next_scenario]
            [/proceed_to_next_scenario]
        [/filter_condition]
        [message]
            id=Olurf
            message= _ "The orcs ha’ been defeated. My lord, we are in your debt."
        [/message]
        [message]
            id=Kalenz
            message= _ "We must put aside our differences and ally against the orcish menace. Olurf, join us!"
        [/message]
        [message]
            id=Olurf
            message= _ "Dwarves, ally with elves? I owe ye a debt, but my kin willna’ be happy at the thought."
        [/message]
        [message]
            id=Kalenz
            message= _ "The orcs are advancing on Wesmere, and a great battle will soon be upon us. If you can cover our flank to the north, you can take the chest for yourself."
        [/message]
        [message]
            id=Olurf
            message= _ "A proper contract for good money? That’s a different matter; I’m sure I can find some o’ my people willing to fight on those terms!"
        [/message]
        [message]
            id=Landar
            message= _ "What? Kalenz, are you out of your mind? Surely you will not throw away three hundreds gold on this scheming mercenary!"
        [/message]
        [message]
            id=Olurf
            message= _ "Where there’s a contract, our honor is involved. We will be there to cover your northern flank or else I will return your gold!"
        [/message]
        [message]
            id=Cleodil
            message=_ "I sense no falsity behind his speech."
        [/message]
        [message]
            id=Kalenz
            message= _ "I, too, believe him. Dwarves may be... rough... by our standards, but they are not liars."
        [/message]
        [message]
            id=Landar
            message= _ "So be it. But if he fails to fulfill his obligations, next time he won’t get any help from us!"
        [/message]

        [store_unit]
            [filter]
                id=Olurf
            [/filter]
            kill=no
            variable=olurf_stored
        [/store_unit]
    [/event]

    [event]
        name=die

        [filter]
            side=3,4,5
            canrecruit=yes
        [/filter]
        [filter_condition]
            [not]
                [have_unit]
                    side=3,4,5
                    canrecruit=yes
                [/have_unit]
            [/not]
        [/filter_condition]

        [kill]
            id=unit.id
            animate=no
        [/kill]

        {HIGHLIGHT_IMAGE $unit.x $unit.y items/chest.png ()}

        [message]
            speaker=second_unit
            message= _ "Look, this chieftain has hidden a huge chest of gold! There are at least three hundred coins here!"
        [/message]
        [message]
            speaker=Landar
            message= _ "This gold is rightfully ours."
        [/message]
    [/event]

    {DEFAULT_VICTORY 0.5}
    {campaigns/Legend_of_Wesmere/utils/deaths.cfg}
[/scenario]
