#textdomain wesnoth-low

[scenario]
    id=27_End_of_War
    next_scenario=28_Epilogue
    name= _ "End of War"
    {LOW_MAP  Kalian.map}
    [event]
        name=prestart

        {campaigns/Legend_of_Wesmere/maps/Kalian_utils.cfg}
        [replace_map_section]
            x=1-55
            y=1-52
            {LOW_MAP_DATA  Kalian.map}
        [/replace_map_section]
        {LOW_MASK_IN_EVENT 25_End_of_War.mask 1 1}
        [item]
            x=36
            y=23
            image=items/archery-target-right.png
        [/item]
    [/event]
    #{RIVER_FAST 30 30 3 6}
    {BIRD_SOUND 19 30}
    {BIRD_SOUND 42 19}
    {BIRD_SOUND 27 19}
    {BIRD_SOUND 43 41}
    {BIRD_SOUND 10 41}
    {DEFAULT_SCHEDULE_DUSK}
    turns=-1

    {INTRO_AND_SCENARIO_MUSIC sad.ogg heroes_rite.ogg}
    {EXTRA_SCENARIO_MUSIC      siege_of_laurelmor.ogg}
    {EXTRA_SCENARIO_MUSIC            elvish-theme.ogg}
    {EXTRA_SCENARIO_MUSIC       weight_of_revenge.ogg}
    {EXTRA_SCENARIO_MUSIC          the_city_falls.ogg}
    {EXTRA_SCENARIO_MUSIC     breaking_the_chains.ogg}
    {EXTRA_SCENARIO_MUSIC       casualties_of_war.ogg}

    [story]
        [part]
            story= _ "Kalenz often recalled Lord Erlornas’ words: <i>...the horror of battle devastates their souls, and they are lost to us just like the fallen. And the deeper this evil takes root in your generation, the more terrible the price of victory will be...</i>"
        [/part]
        [part]
            story= _ "Embittered by war, the elves slaughtered each other as mercilessly as they had once slaughtered the orcs. The rift was so deep that even some of Kalenz’s warriors defected to Landar’s side..."
        [/part]
        [part]
            # wmllint: local spelling Gitamoth
            story= _ "Civil war smoldered on for many more years, neither side mustering enough strength to achieve a decisive victory. Until, eventually, Landar’s increasingly harsh and arrogant ways drove away many of his followers. After assembling all the troops he could, Kalenz marched against his old friend and now mortal enemy, Landar, in the heart of Wesmere forest..."
            {LOW_BIGMAP}
            {NEW_BATTLE 1070 350}
            {NEW_BATTLE 916 618}
            {NEW_BATTLE 200 650}
            {NEW_BATTLE 1150 450}
            {NEW_BATTLE 369 500}
            {NEW_BATTLE 540 650}
            {NEW_BATTLE 180 470}
            {NEW_BATTLE 535 510}
        [/part]
    [/story]

    {LOW_TRACK {SCENARIO_25} }

#define LAST_SCENARIO
#enddef

    [side]
        side=1
        {SIDE_1_ESSENTIALS}
        {KALENZ_LORD}
        x,y=33,10
        {SIDE_1_GOLD_FIXED 350 250}
        income=10
        fog=no
        shroud=no
        [unit]
            {GALTRID_COMPANION}
            placement=leader
        [/unit]
#ifndef MULTIPLAYER
        [unit]
            {CLEODIL_INLOVE}
            x,y=46,15
        [/unit]
        [unit]
            {ERADION_COMPANION}
            placement=leader
        [/unit]
#endif
    [/side]

    [side]
        side=2
        {SIDE_2_ESSENTIALS}
        {CLEODIL_INLOVE}
        x,y=46,15
        gold=250
        income=10
        fog=no
        shroud=no
#ifdef MULTIPLAYER
        [unit]
            {ERADION_COMPANION}
            placement=leader
        [/unit]
#endif
    [/side]

    [side]
        defeat_condition=never
        side=3
        {UNPLAYABLE_SIDE}
        team_name=assassins
        user_team_name= _ "Enemies"
        {FLAG_VARIANT long}
        {GOLD 260 320 380}
        {INCOME 10 15 20}
        no_leader=yes
#ifdef EASY
        recruit=Elvish Archer, Elvish Fighter, Elvish Hero
#endif
#ifdef NORMAL
        recruit=Elvish Archer, Elvish Fighter, Elvish Hero, Elvish Ranger
#endif
#ifdef HARD
        recruit=Elvish Archer, Elvish Fighter, Elvish Hero, Elvish Ranger, Elvish Captain, Elvish Marksman
#endif
        [ai]
            passive_leader=yes
            [avoid]
                terrain=W*
            [/avoid]
        [/ai]
    [/side]

    [side]
        side=4
        {UNPLAYABLE_SIDE}
        team_name=assassins
        user_team_name= _ "Enemies"
        {FLAG_VARIANT long}
        type=Elvish Marshal
        id=Timal-Radas
        name=_ "Timal-Radas"
        x,y=32,31
        {GOLD 260 320 380}
        {INCOME 10 15 20}
#ifdef EASY
        recruit=Elvish Archer, Elvish Fighter, Elvish Hero
#endif
#ifdef NORMAL
        recruit=Elvish Archer, Elvish Fighter, Elvish Hero, Elvish Ranger
#endif
#ifdef HARD
        recruit=Elvish Archer, Elvish Fighter, Elvish Hero, Elvish Ranger, Elvish Captain, Elvish Marksman
#endif
        [ai]
            {NO_SCOUTS}
#ifdef EASY
            recruitment_pattern=fighter, archer, fighter
#else
            recruitment_pattern=fighter, archer, mixed fighter
#endif
            [avoid]
                terrain=W*
            [/avoid]
        [/ai]
    [/side]

    [side]
        side=5
        {UNPLAYABLE_SIDE}
        team_name=assassins
        user_team_name= _ "Enemies"
        {FLAG_VARIANT long}
        type=Elvish Sharpshooter
        id=Adorelan
        name= _ "Adorelan"
        x,y=3,30
        {GOLD 200 240 280}
        {INCOME 3 6 9}
#ifdef EASY
        recruit=Elvish Archer, Elvish Fighter, Elvish Hero, Elvish Scout
#endif
#ifdef NORMAL
        recruit=Elvish Archer, Elvish Fighter, Elvish Hero, Elvish Scout, Elvish Ranger
#endif
#ifdef HARD
        recruit=Elvish Archer, Elvish Fighter, Elvish Hero, Elvish Scout, Elvish Rider, Elvish Ranger, Elvish Captain, Elvish Marksman
#endif
        [ai]
            village_value={ON_DIFFICULTY 3 4 5}
#ifdef EASY
            recruitment_pattern=fighter, archer, scout
#else
            recruitment_pattern=fighter, archer, scout, mixed fighter
#endif
        [/ai]
    [/side]

    [side]
        side=6
        {UNPLAYABLE_SIDE}
        team_name=assassins
        user_team_name= _ "Enemies"
        {FLAG_VARIANT long}
        hidden=yes
#ifdef EASY
        recruit=Elvish Archer, Elvish Fighter, Elvish Hero, Elvish Scout
#endif
#ifdef NORMAL
        recruit=Elvish Archer, Elvish Fighter, Elvish Hero, Elvish Scout, Elvish Ranger
#endif
#ifdef HARD
        recruit=Elvish Archer, Elvish Fighter, Elvish Hero, Elvish Scout, Elvish Rider, Elvish Ranger, Elvish Captain, Elvish Marksman
#endif
        [ai]
            village_value={ON_DIFFICULTY 3 4 5}
#ifdef EASY
            recruitment_pattern=fighter, archer, scout
#else
            recruitment_pattern=fighter, archer, scout, mixed fighter
#endif
        [/ai]
    [/side]

    [side]
        side=7
        {UNPLAYABLE_SIDE}
        {PLAYER_TEAM}
        {FLAG_VARIANT wood-elvish}
        color=white
        {URADREDIA}
        x,y=49,43
        gold=400
        income=30
        recruit=Elvish Fighter, Elvish Scout, Elvish Rider, Elvish Archer, Elvish Shaman, Elvish Hero, Elvish Ranger, Elvish Druid, Elvish Marksman, Elvish Sorceress
        [ai]
            passive_leader=yes
            recruitment_pattern=fighter,fighter,scout,archer,mixed fighter,healer
            village_value=4
        [/ai]
    [/side]

#define LANDAR_DEFECTION SIDE LVL
    [store_unit]
        variable=steal_warrior
        kill=yes
        [filter]
            side={SIDE}
            level={LVL}
            x,y=recall,recall
            race=elf
            [not]
                id=Kalenz
            [/not]
            [not]
                id=Cleodil
            [/not]
            canrecruit=no
            [not]
                {FILTER_LOYALS}
            [/not]
        [/filter]
    [/store_unit]
    {VARIABLE how_many_take $steal_warrior.length}
    {VARIABLE_OP how_many_take divide 3}
    {VARIABLE warriors_taken 0}
    [foreach]
        array=steal_warrior
        [do]
            [if]
                [variable]
                    name=warriors_taken
                    greater_than_equal_to=$how_many_take
                [/variable]
                [then]
                    {VARIABLE this_item.role kalenz_loyal}
                    [unstore_unit]
                        variable=this_item
                        x,y=recall,recall
                    [/unstore_unit]
                [/then]
                [else]
                    {VARIABLE this_item.side 3}
                    {VARIABLE this_item.role landar_loyal}
                    [unstore_unit]
                        variable=this_item
                        x,y=recall,recall
                    [/unstore_unit]
                    [recall]
                        find_in=this_item
                        x,y=30,30
                        show=no
                    [/recall]
                    {VARIABLE_OP warriors_taken add 1}
                [/else]
            [/if]
        [/do]
    [/foreach]
    {CLEAR_VARIABLE warriors_taken}
    {CLEAR_VARIABLE how_many_take}
    {CLEAR_VARIABLE steal_warrior}
#enddef

#ifdef HARD
    {LIMIT_CONTEMPORANEOUS_RECRUITS (3,4,5,6) (Elvish Marksman) 1}
#endif

    [event]
        name=prestart

        [capture_village]
            x=30-55
            side=3
        [/capture_village]
        [capture_village]
            x=1-30
            side=4
        [/capture_village]
        [capture_village]
            x=1-17
            y=25-34
            side=5
        [/capture_village]

        {NEED_LANDAR_STORED 28 31 3}
        {NEED_KALENZ_LORD}
        {NEED_CLEODIL_LEADER}
        {MODIFY_UNIT side=1,2 facing sw}
        {MODIFY_UNIT side=7 facing nw}
        {MODIFY_UNIT side=3,4,5,6 facing ne}

        {LOYAL_UNIT 3 "Elvish Champion"  31 27}{GUARDIAN}
        [+unit]
            facing=ne
        [/unit]
        {LOYAL_UNIT 3 "Elvish Champion"  33 29}{GUARDIAN}
        [+unit]
            facing=ne
        [/unit]
        {LOYAL_UNIT 3 "Elvish Champion" 34 30}{GUARDIAN}
        [+unit]
            facing=ne
        [/unit]
        {LOYAL_UNIT 3 "Elvish Champion"  34 32}{GUARDIAN}
        [+unit]
            facing=se
        [/unit]
        {LOYAL_UNIT 3 "Elvish Champion" 32 34}{GUARDIAN}
        [+unit]
            facing=sw
        [/unit]
        {LOYAL_UNIT 3 "Elvish Avenger"  31 34}{GUARDIAN}
        [+unit]
            facing=sw
        [/unit]
        {LOYAL_UNIT 3 "Elvish Champion"  29 27}{GUARDIAN}
        [+unit]
            facing=nw
        [/unit]
        {LOYAL_UNIT 3 "Elvish Champion"  27 29}{GUARDIAN}
        [+unit]
            facing=nw
        [/unit]
        {LOYAL_UNIT 3 "Elvish Champion" 26 30}{GUARDIAN}
        [+unit]
            facing=nw
        [/unit]
        {LOYAL_UNIT 3 "Elvish Champion"  26 32}{GUARDIAN}
        [+unit]
            facing=sw
        [/unit]

        {LOYAL_UNIT 3 "Elvish Champion" 28 34}{GUARDIAN}
        [+unit]
            facing=se
        [/unit]
        {LOYAL_UNIT 3 "Elvish Avenger"  29 34}{GUARDIAN}
        [+unit]
            facing=se
        [/unit]

        {LOYAL_UNIT 3 "Elvish Champion" 29 37}{GUARDIAN}
        [+unit]
            facing=sw
        [/unit]
        {LOYAL_UNIT 3 "Elvish Champion"  31 37}{GUARDIAN}
        [+unit]
            facing=se
        [/unit]
        {LOYAL_UNIT 3 "Elvish Sharpshooter" 30 29}{GUARDIAN}
        [+unit]
            facing=se
        [/unit]

        {LANDAR_DEFECTION 1 (3,4)} # add Sylphs to the lvl3 pack
        {LANDAR_DEFECTION 2 (3,4)} # add Sylphs to the lvl3 pack
        {LANDAR_DEFECTION 1 2}
        {LANDAR_DEFECTION 2 2}
        {LANDAR_DEFECTION 1 1}
        {LANDAR_DEFECTION 2 1}

        [modify_side]
            side=3
            defeat_condition=no_leader_left
        [/modify_side]
    [/event]
#undef LANDAR_DEFECTION

    [event]
        name=start

        [message]
            id=Kalenz
            message= _ "Landar, let us spill no more elvish blood. Give up. We can help you!"
        [/message]
        [message]
            id=Landar
            message= _ "No! It all ends here!"
        [/message]
        [message]
            id=Uradredia
            message= _ "You have sealed your own fate. Soldiers, begin the assault!"
        [/message]
        [message]
            id=Galtrid
            message= _ "We have defended the citadel of Ka’lian so many times… I cannot believe we are the ones storming it now."
        [/message]
        [message]
            id=Eradion
            message= _ "The orcish gods must be watching this with delight."
        [/message]
        [message]
            id=Cleodil
            message= _ "I pray that this bloody age ends today, and that the hearts of elves find their former peace."
        [/message]

        [objectives]
            side=1,2
            [objective]
                description= _ "Defeat Landar"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Kalenz"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Cleodil"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Eradion"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Galtrid"
                condition=lose
            [/objective]
            [objective]
                [show_if]
                    [have_unit]
                        id=Olurf
                    [/have_unit]
                [/show_if]
                description= _ "Death of Olurf"
                condition=lose
            [/objective]
            {IS_LAST_SCENARIO}
        [/objectives]
    [/event]

    [event]
        name=last breath
        # Second_unit (on kalenz's side) kills unit (on landar's side);
        # both came from the player's recall list and so have fought
        # side by side.
        [filter]
            role=landar_loyal
        [/filter]
        [filter_second]
            role=kalenz_loyal
        [/filter_second]
        [message]
            speaker=second_unit
            message= _ "Forgive me $unit.name|. I will sing your name in praise under the stars!"
        [/message]
        [message]
            speaker=unit
            message= _ "We must all pass, $second_unit.name|. Make your song beautiful..."
        [/message]
    [/event]

    [event]
        name=last breath
        # Same as above but with roles exchanged. One of Landar's men
        # kills his former comrade.
        [filter]
            role=kalenz_loyal
        [/filter]
        [filter_second]
            role=landar_loyal
        [/filter_second]
        [message]
            speaker=second_unit
            message= _ "Forgive me, $unit.name|, this victory brings me no joy."
        [/message]
        [message]
            speaker=unit
            message= _ "Remember me to the trees, $second_unit.name|."
        [/message]
    [/event]

    [event]
        name=last breath

        [filter]
            id=Landar
        [/filter]

        [if]
            [variable]
                name=second_unit.id
                equals=Kalenz
            [/variable]
            [then]
                [set_achievement]
                    content_for=low
                    id=low_ending
                [/set_achievement]
            [/then]
        [/if]

        {INCIDENTAL_MUSIC sad.ogg}

        [message]
            id=Landar
            message= _ "I fall. Perhaps now I can rest!"
        [/message]
        [message]
            id=Kalenz
            message= _ "I am deeply grieved that it came to this, Landar. You were my best friend. I was blind to what the potion was doing to you. I was fighting it myself!"
        [/message]
        [message]
            id=Landar
            message= _ "I know. But you are not at fault, for I did not take just one bottle. I wanted to make sure we could kill the orcish Great Chief, so I went back for a second and drank that one, too. Now I have attacked our dwarvish allies and brought death and disaster to our own people. I have even tried to kill my own friend. I am a disgrace to elven-kind."
        [/message]
        [message]
            id=Kalenz
            message= _ "It was not all your fault. Maybe the curse of Aquagar struck true, or maybe yours was the blood-price fate required of us for victory. Rest well, my friend. Rest well Landar, Hero of the Elves!"
        [/message]

        [scroll_to_unit]
            id=Landar
        [/scroll_to_unit]

        [endlevel]
            result=victory
            bonus=no
            carryover_report=no
            save=no
            carryover_percentage=0
        [/endlevel]
    [/event]

    [event]
        name=turn 8

        [unit]
            side=6
            type=Elvish Ranger
            x,y=47,45
            [status]
                uncovered=yes
            [/status]
        [/unit]
        {MOVE_UNIT x,y=47,45 48 44}

        [unit]
            side=6
            type=Elvish Ranger
            x,y=46,43
            [status]
                uncovered=yes
            [/status]
        [/unit]
        {MOVE_UNIT x,y=46,43 47 43}

        [unit]
            side=6
            type=Elvish Ranger
            x,y=48,40
            [status]
                uncovered=yes
            [/status]
        [/unit]
        {MOVE_UNIT x,y=48,40 48 41}

        [unit]
            side=6
            type=Elvish Ranger
            x,y=51,41
            [status]
                uncovered=yes
            [/status]
        [/unit]
        {MOVE_UNIT x,y=51,41 50 41}

        [unit]
            side=6
            type=Elvish Ranger
            x,y=52,42
            [status]
                uncovered=yes
            [/status]
        [/unit]
        {MOVE_UNIT x,y=52,42 51 43}

        [unit]
            side=6
            type=Elvish Ranger
            x,y=50,45
            [status]
                uncovered=yes
            [/status]
        [/unit]
        {MOVE_UNIT x,y=50,45 50 44}

        [unit]
            side=6
            type=Elvish Avenger
            id=Namil
            name=_ "Namil"
            canrecruit=yes
            x,y=51,42
            [status]
                uncovered=yes
            [/status]
        [/unit]
        {MOVE_UNIT x,y=51,42 50 42}

        [message]
            speaker=Namil
            message=_ "For the elves who fell at Elensiria!"
        [/message]

        [animate_unit]
            flag=attack
            [filter]
                id=Namil
            [/filter]
            [facing]
                x,y=49,43
            [/facing]
            [primary_attack]
                range=melee
            [/primary_attack]
            hits=yes
            [animate]
                flag=defend
                [filter]
                    id=Uradredia
                [/filter]
                hits=yes
            [/animate]
        [/animate_unit]

        [kill]
            id=Uradredia
            animate=yes
            fire_event=yes
        [/kill]
    [/event]

    [event]
        name=last breath

        [filter]
            id=Uradredia
        [/filter]

        {INCIDENTAL_MUSIC the_king_is_dead.ogg}

        [message]
            speaker=unit
            message=_ "I am slain! Kalenz, no matter what happens... you must prevail today..."
        [/message]
        [message]
            speaker=Kalenz
            message=_ "Lord Uradredia! No!"
        [/message]
    [/event]

    [event]
        name=die

        [filter]
            id=Uradredia
        [/filter]

        [kill]
            id=Uradredia
            animate=no
            fire_event=no
        [/kill]

        [message]
            speaker=Landar
            message=_ "North Elves! Behold, the tyrant who forced you to fight for the traitors is dead! I grant you mercy; join me now."
        [/message]
        [message]
            side=6
            message=_ "Silence, villain! Our lord’s blood is on your hands; we will have vengeance! Kalenz, lead us!"
        [/message]

        [store_unit]
            [filter]
                side=7
            [/filter]
            variable=uradredia_elves
        [/store_unit]

        {VARIABLE to_whom 1}
        [foreach]
            array=uradredia_elves
            [do]
                [modify_unit]
                    [filter]
                        id=$this_item.id
                    [/filter]
                    side=$to_whom
                [/modify_unit]
#ifdef MULTIPLAYER
                {VARIABLE to_whom "$(3 - $to_whom)"}
#endif
            [/do]
        [/foreach]
        {CLEAR_VARIABLE uradredia_elves}
        {CLEAR_VARIABLE to_whom}

        [message]
            speaker=Landar
            message=_ "Cursed betrayers! Kill them all!"
        [/message]
        [message]
            speaker=Namil
            message=_ "As you command, my lord."
        [/message]

        {MOVE_UNIT id=Namil 49 43}

        [modify_side]
            side=6
            hidden=no
            {GOLD 200 240 280}
            {INCOME 3 6 9}
        [/modify_side]
    [/event]

    [event]
        name=turn 13

        [if]
            [variable]
                name=olurf_stored.hitpoints
                greater_than_equal_to=1
            [/variable]
            [then]
                [unstore_unit]
                    variable=olurf_stored
                    x,y=15,1
                    animate=no
                    find_vacant=yes
                [/unstore_unit]
            [/then]
            [else]
                [unit]
                    {OLURF}
                    side={MP_LANDAR_SIDE}
                    x,y=15,1
                [/unit]
            [/else]
        [/if]

        {GENERIC_UNIT 1 "Dwarvish Steelclad" 15 1}
        {GENERIC_UNIT {MP_LANDAR_SIDE} "Dwarvish Steelclad" 15 1}
        {GENERIC_UNIT 1 "Dwarvish Steelclad" 15 1}
        {GENERIC_UNIT {MP_LANDAR_SIDE} "Dwarvish Steelclad" 15 1}
        {GENERIC_UNIT 1 "Dwarvish Thunderguard" 15 1}
        {GENERIC_UNIT {MP_LANDAR_SIDE} "Dwarvish Thunderguard" 15 1}
        {GENERIC_UNIT 1 "Dwarvish Berserker" 15 1}
        {GENERIC_UNIT {MP_LANDAR_SIDE} "Dwarvish Berserker" 15 1}
        {GENERIC_UNIT 1 "Dwarvish Scout" 15 1}
        {GENERIC_UNIT {MP_LANDAR_SIDE} "Dwarvish Scout" 15 1}
        {GENERIC_UNIT 1 "Dwarvish Fighter" 15 1}
        {GENERIC_UNIT {MP_LANDAR_SIDE} "Dwarvish Fighter" 15 1}
        {GENERIC_UNIT 1 "Dwarvish Guardsman" 15 1}
        {GENERIC_UNIT {MP_LANDAR_SIDE} "Dwarvish Guardsman" 15 1}
        {MODIFY_UNIT race=dwarf facing s}

        [message]
            speaker=Olurf
            message= _ "Aye, we’re just in time, lads!"
        [/message]
        [message]
            speaker=Kalenz
            message= _ "Olurf! You’re alive!"
        [/message]
        [message]
            speaker=Olurf
            message= _ "I’m nae so easy to kill, though yer wee friend tried hard enough! What scunner got into him? He sends bands into dwarven lands, and they ravage oor villages, sparing none! I’m here tae put an end to it!"
        [/message]
        [message]
            speaker=Cleodil
            message= _ "Is it wise to involve the dwarves in a civil war? This could confuse our supporters and harden Landar’s resistance."
        [/message]
        [message]
            speaker=Kalenz
            message= _ "The dwarves have suffered from Landar’s madness no less than we have, so they have a right to be here. Besides, we need reinforcements if we want to be sure of victory. Let them fight by our side, but let them spare all the elves they can. Olurf, did you hear all that?"
        [/message]
        [message]
            speaker=Olurf
            message= _ "Aye! I’ll try me best tae spare ’em, but my axe willnae stop if any o’ my kin are in danger!"
        [/message]
        [message]
            speaker=Landar
            message= _ "See! Kalenz sold our forests to dwarves! They will cut down our groves and take over our homes if we don’t stop them!"
        [/message]
    [/event]

    [event]
        name=attack

        [filter_second]
            race=dwarf
        [/filter_second]

        [message]
            speaker=unit
            message= _ "Death to the dwarvish invaders!"
        [/message]
    [/event]

    [event]
        name=last breath

        [filter]
            side=4,5,6
            canrecruit=yes
        [/filter]

        [message]
            speaker=Cleodil
            message=_ "Enough blood has been shed today; let us spare his life."
        [/message]
        [message]
            speaker=unit
            message=_ "Silence, I don’t need your pity!"
        [/message]

        [event]
            name=last breath

            [filter]
                side=4,5,6
                canrecruit=yes
            [/filter]

            [message]
                speaker=unit
                message=_ "Fortune has abandoned us for our sins..."
            [/message]
            [message]
                speaker=Landar
                message=_ "Keep formation! Fight! The rebels are taking losses as well. They will shatter their forces against our citadel; we will stand firm!"
            [/message]

            [event]
                name=last breath

                [filter]
                    side=4,5,6
                    canrecruit=yes
                [/filter]

                [message]
                    speaker=unit
                    message=_ "Descendants will curse our names..."
                [/message]
            [/event]
        [/event]
    [/event]

    [event]
        name=victory

#ifdef HARD
        [set_achievement]
            content_for=low
            id=low_hard
        [/set_achievement]
#endif
#ifdef MULTIPLAYER
        [set_achievement]
            content_for=low
            id=low_mp
        [/set_achievement]
#endif
    [/event]
    {campaigns/Legend_of_Wesmere/utils/deaths.cfg}
[/scenario]
