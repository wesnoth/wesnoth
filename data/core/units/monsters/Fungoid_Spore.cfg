#textdomain wesnoth-units

[unit_type]
    id=Fungoid Spore
    name= _ "Fungoid Spore"
    race=monster
    image=units/monsters/orb-small.png
    hitpoints=30
    movement_type=smallfoot
    movement=4
    [resistance]
        blade=100
        pierce=100
        impact=90
        fire=110
        cold=90
        arcane=120
    [/resistance]
    experience=18
    level=1
    alignment=chaotic
    advances_to=Fungoid Stalk
    cost=13
    usage=mixed fighter
    description= _ "This thing is impossible to describe, no one has seen anything like it before."
    die_sound=wail-long.wav

    [abilities]
        {ABILITY_REGENERATES}
        [dummy]
            id=miasma
            name= _ "miasma"
            description=_ "This unit passively harms those not of its side at a distance and rate equal to its level."
        [/dummy]
    [/abilities]
    # Miasma ability.
    [event]
        id=Fungoid Miasma
        name=turn end
        first_time_only=no
        [store_unit]
            [filter]
                type="Fungoid Spore","Fungoid Stalk","Fungoid Body"
            [/filter]
            variable=fungoids
        [/store_unit]
        [foreach]
            array=fungoids
            variable=fungoid
            [do]
                [harm_unit]
                    [filter]
                        [filter_location]
                            [filter]
                                id=$fungoid.id
                            [/filter]
                            radius=$fungoid.level
                        [/filter_location]
                        [not]
                            side=$fungoid.side
                        [/not]
                    [/filter]
                    [filter_second]
                        id=$fungoid.id
                    [/filter_second]
                    amount=$fungoid.level
                    damage_type=cold
                    fire_event=yes
                    animate=yes
                [/harm_unit]
            [/do]
        [/foreach]
    [/event]

    [attack]
        name=consume
        description= _ "consume"
        icon=attacks/fangs-horror.png
        type=blade
        range=melee
        damage=6
        number=2
        [specials]
            {WEAPON_SPECIAL_DRAIN}
        [/specials]
    [/attack]
    [attack]
        name=glow
        description= _ "glow"
        icon=attacks/energyray.png
        type=cold
        range=ranged
        damage=4
        number=3
        [specials]
            {WEAPON_SPECIAL_STUN}
        [/specials]
    [/attack]
    {DEFENSE_ANIM "units/monsters/orb-small-defend.png" units/monsters/orb-small.png wail-sml.wav }
    [attack_anim]
        [filter_attack]
            name=glow
        [/filter_attack]
        missile_start_time=-200
        [missile_frame]
            duration=200
            image="projectiles/darkmissile-n.png"
            image_diagonal="projectiles/darkmissile-ne.png"
        [/missile_frame]
        start_time=-300
        [frame]
            image=units/monsters/orb-small-ranged[1~2].png:[100,250]
        [/frame]
        {SOUND:HIT_AND_MISS magic-dark.ogg magic-dark-miss.ogg -200}
    [/attack_anim]
    [attack_anim]
        [filter_attack]
            name=consume
        [/filter_attack]
        start_time=-200
        [frame]
            image=units/monsters/orb-small-melee[1~2].png:[150,200]
        [/frame]
        {SOUND:HIT_AND_MISS bite-small.ogg {SOUND_LIST:MISS} -50}
    [/attack_anim]
[/unit_type]
