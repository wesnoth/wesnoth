#textdomain wesnoth-units
[unit_type]
    id=Fireship
    name= _ "Fireship"
    race=ship
    image="halo/transport/fireship-back-glow.png~BLIT(units/transport/fireship.png)~BLIT(units/transport/flames/fireship-2.png)"
    profile="portraits/transport/fireship.webp"
    hitpoints=110
    movement_type=ship
    [resistance]
        fire=50
    [/resistance]
    {TRAIT_OCEANGOING_MUSTHAVE}
    movement=6
    experience=100
    level=2
    alignment=chaotic
    advances_to=null
    {AMLA_DEFAULT}
    cost=50
    description= _ "Fireships are generally derelict or doomed ships set ablaze to create chaos in one last act of belligerence. Their main hazard is fiery collision, but they also shed burning embers. Sometimes they have a skeleton crew to guide them, but often they just drift along on unseen winds and currents."
    usage=null
    [abilities]
        [dummy]
            id=deteriorate
            name=_"deteriorate"
            description=_"This unit is deteriorating. It cannot be healed, and loses 10 hitpoints at the start of each of its turns."
            # regenerate doesn't work with negative values, so use [harm_unit] instead
            [event]
                name=side turn
                first_time_only=no
                # if a unit dies from this damage, animate the death so it's obvious to the player what happened
                [harm_unit]
                    [filter]
                        side=$side_number
                        ability=deteriorate
                        formula=(self.hitpoints<=10)
                    [/filter]
                    amount=10
                    animate=yes
                    delay=0
                    kill=yes
                    fire_event=yes
                [/harm_unit]
                # if a unit isn't going to die, skip the animation and coresponding [defend] anim
                [harm_unit]
                    [filter]
                        side=$side_number
                        ability=deteriorate
                        formula=(self.hitpoints>10)
                    [/filter]
                    amount=10
                    animate=no
                    delay=0
                    kill=yes
                    fire_event=yes
                [/harm_unit]
            [/event]
            [event]
                name=unit placed
                first_time_only=no
                [filter]
                    ability=deteriorate
                [/filter]
                [object]
                    [effect]
                        apply_to=status
                        add=unhealable
                    [/effect]
                [/object]
            [/event]
        [/dummy]
    [/abilities]

    [attack]
        name=ram
        description=_"ram"
        icon=attacks/fire-hull.png
        type=fire
        range=melee
        damage=13
        number=3
        specials_list=charge
        [specials]
            {WEAPON_SPECIAL_NAVAL}
        [/specials]
    [/attack]

    [attack_anim]
        [filter_attack]
            name=ram
        [/filter_attack]
        start_time=-850
        boat_start_time=-850
        boat_offset=0:500,0.0~0.7:350,0.7~0.0:250
        offset=     0:500,0.0~0.7:350,0.7~0.0:250
        [boat_frame]
            image="units/transport/fireship-mid.png~BLIT(units/transport/fireship-back-fire2.png)~BLIT(units/transport/flames/fireship-2.png):1100"
            auto_vflip=no
            image_mod=~MASK(units/transport/carrack/pirate-mask.png)
        [/boat_frame]
        [frame]
            image="halo/transport/fireship-back-glow.png:1100"
            layer=9
        [/frame]
        {SOUND:HIT_AND_MISS torch.ogg torch-miss.ogg -150}
    [/attack_anim]

    # we put the sprite on a non-primary frame group so we don't need to worry about effects
    # like submerge or making the ellipse bob
    [standing_anim]
        start_time=0
        terrain_type=W*^*
        boat_start_time=0
        boat_y=-1:250,-1~2:490,2:250,2~-1:490
        flames_start_time=0
        flames_y=-1:250,-1~2:490,2:250,2~-1:490
        flames_directional_x=1:350,0:390,-1:350,0:390
        [frame]
            image="halo/transport/fireship-back-glow.png:1480"
            layer=9
        [/frame]
        [boat_frame]
            image="units/transport/fireship-[port,mid,starboard,mid].png:[350,390,350,390]"
            auto_vflip=no
            image_mod=~MASK(units/transport/pirate-galleon-mask.png)
            primary=yes
            layer=40
        [/boat_frame]
        [fire_frame]
            image="units/transport/fireship-back-fire[1,2,1,2,1,2,1,2].png:[185*8]"
            auto_vflip=no
            layer=41
        [/fire_frame]
        [flames_frame]
            image="units/transport/flames/fireship-[1~9,1~9].png:[82*10,86,82*7]"
            auto_vflip=no
            layer=42
        [/flames_frame]
    [/standing_anim]
    [standing_anim]
        start_time=0
        terrain_type=S*^*
        boat_start_time=0
        boat_y=-1:250,-1~0:490,0:250,0~-1:490
        flames_start_time=0
        flames_y=-1:250,-1~0:490,0:250,0~-1:490
        flames_directional_x=1:350,0:390,-1:350,0:390
        [frame]
            image="halo/transport/fireship-back-glow.png:1480"
            layer=9
        [/frame]
        [boat_frame]
            image="units/transport/fireship-[port,mid,starboard,mid].png:[350,390,350,390]"
            auto_vflip=no
            image_mod=~MASK(units/transport/pirate-galleon-mask.png)
            primary=yes
            layer=40
        [/boat_frame]
        [fire_frame]
            image="units/transport/fireship-back-fire[1,2,1,2,1,2,1,2].png:[185*8]"
            auto_vflip=no
            layer=41
        [/fire_frame]
        [flames_frame]
            image="units/transport/flames/fireship-[1~9,1~9].png:[82*10,86,82*7]"
            auto_vflip=no
            layer=42
        [/flames_frame]
    [/standing_anim]
    [standing_anim]
        start_time=0
        terrain_type=!,W*^*,S*^*
        boat_start_time=0
        flames_start_time=0
        [frame]
            image="halo/transport/fireship-back-glow.png:1480"
            layer=9
        [/frame]
        [boat_frame]
            image="units/transport/fireship-mid.png:1480"
            auto_vflip=no
            image_mod=~MASK(units/transport/pirate-galleon-mask.png)
            primary=yes
            layer=40
        [/boat_frame]
        [fire_frame]
            image="units/transport/fireship-back-fire[1,2,1,2,1,2,1,2].png:[185*8]"
            auto_vflip=no
            layer=41
        [/fire_frame]
        [flames_frame]
            image="units/transport/flames/fireship-[1~9,1~9].png:[82*10,86,82*7]"
            auto_vflip=no
            layer=42
        [/flames_frame]
    [/standing_anim]
    [movement_anim]
        start_time=0
        boat_start_time=0
        boat_y=0~-2:320,-2~0:320,0~2:320,2~0:320
        boat_offset="0~1:200,0~1:200,0~1:200,0~1:200,0~1:200,0~1:200,0~1:200"
        [frame]
            image="halo/transport/fireship-back-glow.png:1280"
            layer=9
        [/frame]
        [boat_frame]
            image="units/transport/fireship-mid.png~BLIT(units/transport/fireship-back-fire2.png)~BLIT(units/transport/flames/fireship-2.png):1280"
            auto_vflip=no
            image_mod=~MASK(units/transport/pirate-galleon-mask.png)
            primary=yes
        [/boat_frame]
    [/movement_anim]
    [defend]
        hits=hit,kill
        start_time=-40
        boat_start_time=-40
        boat_y=-1~2:330,2~-1:330
        flames_start_time=-40
        flames_y=-1~2:330,2~-1:330
        [frame]
            image="halo/transport/fireship-back-glow.png:660"
            layer=9
        [/frame]
        [boat_frame]
            halo="projectiles/fireball-impact-[5~16].png:60"
            image="units/transport/fireship-mid.png~BLIT(units/transport/fireship-back-fire2.png):660"
            auto_vflip=no
            image_mod=~MASK(units/transport/pirate-galleon-mask.png)
            primary=yes
        [/boat_frame]
        [flames_frame]
            image="units/transport/flames/fireship-[1~7].png:[96,94*6]"
            auto_vflip=no
            layer=42
        [/flames_frame]
    [/defend]
    [death]
        start_time=0
        boat_start_time=-0
        # boat_y=0~-3:80,-3~0:80,0~20:840
        boat_y=0~-3:80,-3~0:80,0~6:400,6~20:440
        boat_alpha=1.0:200,1.0~0.0:800
        smoke_start_time=100
        smoke_y=0~-10:900
        [frame]
            image="misc/blank-hex.png:1000"
        [/frame]
        [boat_frame]
            image="units/transport/fireship-mid.png~BLIT(units/transport/fireship-back-fire2.png):39"
            auto_vflip=no
            image_mod=~MASK(units/transport/pirate-galleon-mask.png)
            primary=yes
        [/boat_frame]
        [boat_frame]
            image="units/transport/fireship-sink.png:960"
            submerge=0.0~0.2:400,0.2~0.65:560
            auto_vflip=no
            primary=yes
        [/boat_frame]
        [boat_frame]
            image="misc/blank-hex.png:1"
        [/boat_frame]
        [smoke_frame]
            image="halo/transport/smoke-[1,2,3].png:[100,150,650]"
            alpha=1.0:200,1.0~0.0:500,0.0:200
            auto_vflip=no
        [/smoke_frame]
    [/death]
    [defend]
        hits=miss
        start_time=-80
        boat_start_time=-80
        [frame]
            image="halo/transport/fireship-back-glow.png:120"
            layer=9
        [/frame]
        [boat_frame]
            image="units/transport/fireship-mid.png~BLIT(units/transport/fireship-back-fire2.png)~BLIT(units/transport/flames/fireship-2.png):120"
            auto_vflip=no
            image_mod=~MASK(units/transport/pirate-galleon-mask.png)
            primary=yes
        [/boat_frame]
    [/defend]
[/unit_type]
