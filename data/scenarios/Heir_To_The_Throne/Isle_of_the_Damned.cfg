[scenario]
	{DAWN}
	{MORNING}
	{AFTERNOON}
	{DUSK}
	{FIRST_WATCH}
	{SECOND_WATCH}

	id=Isle_of_the_Damned
	next_scenario=The_Siege_of_Elensefar
	name=Isle of the Damned
	map=isle_damned
	turns=24

	music="wesnoth-3.ogg"

	objectives="
Victory:
@Defeat both enemy leaders
@Resist until the end of the turns
Defeat:
#Death of Konrad"

	disallow_recall=yes

	[bigmap]
	image=misc/map.png
		{DOT 162 367}
		{DOT 158 372}
		{DOT 151 379}
		{DOT 137 385}
		{DOT 122 383}
		{DOT 109 377}
		{DOT 99 369}
		{DOT 94 374}
		{CROSS 93 386}
	[/bigmap]

	[side]
	description=Konrad
	type=Commander
	side=1
	canrecruit=1
	recruit=Thug,Poacher,Footpad
	controller=human
		[unit]
		description=Kalba
		type=Merman
		side=1
		x=25
		y=10
		[/unit]
		[unit]
		description=Gnaba
		type=Merman
		side=1
		x=29
		y=12
		[/unit]
	[/side]
	[side]
	description=Haf-Mal
	type=Lich
	side=2
	canrecruit=1
	team_name=undead
	recruit=Skeleton,Vampire Bat,Ghost,Dark Adept,Chocobone
	recruitment_pattern=scout,scout,fighter
	{GOLD 80 140 200}
	[/side]
	[side]
	description=Jarmal-Gorg
	type=Lich
	side=3
	canrecruit=1
	team_name=undead
	recruit=Skeleton,Skeleton Archer,Walking Corpse,Vampire Bat,Ghost,Dark Adept
	{GOLD 80 140 200}
	[/side]

	[story]
		[part]
		id=isledamn_1a
		story="But the voyage did not go as smoothly as had been hoped. A storm blew up and bore down on the ship. Though all hands were on deck working desperately, a sudden gust of wind flung Konrad overboard as he attempted to secure the sails..."
		image="misc/story9.png"
		[/part]
		[part]
		id=isledamn_2a
		story="The mermen finally saved Konrad from the sea, but were unable to get him back to the ship. With great effort though, they reached a nearby island..."
		image="misc/map.png"
		[/part]
	[/story]

	[event]
	name=start

		#reset gold held to 100
		[store_gold]
		side=1
		variable=isle_damned_starting_gold
		[/store_gold]
		{VARIABLE_OP isle_damned_starting_gold multiply -1}
		[gold]
		side=1
		amount=$isle_damned_starting_gold
		[/gold]
		[gold]
		side=1
		amount=100
		[/gold]
		{VARIABLE_OP isle_damned_starting_gold multiply -1}

		[message]
		description=Konrad
		id=isledamn_3
		message="Whew, I survived. But now where am I? Is this island inhabited?"
		[/message]
		[message]
		description=Kalba
		id=isledamn_4a
		message="We have heard only the worst things about this place, my lord. It is said that the fiends of the undead have come in great numbers and turned the island into an ugly wasteland."
		[/message]
		[message]
		description=Konrad
		id=isledamn_5
		message="Let's hope these rumors are not true! I have none of my men with me! How could I defend myself?"
		[/message]
		[message]
		description=Kalba
		id=isledamn_6
		message="There are still some bands of humans hiding on the island, my lord. If you recruit some of them to help, we might have some hope of holding off the undead hordes!"
		[/message]
		[unit]
		description=Bob
		type=Outlaw
		side=1
		x=18
		y=10
		[/unit]
		[message]
		description=Bob
		id=isledamn_7
		message="Maybe we can make a deal! Help us defeat those evil creatures!"
		[/message]
		[disallow_recruit]
		side=1
		type=Elvish Fighter
		[/disallow_recruit]
		[disallow_recruit]
		side=1
		type=Elvish Archer
		[/disallow_recruit]
		[disallow_recruit]
		side=1
		type=Elvish Scout
		[/disallow_recruit]
		[disallow_recruit]
		side=1
		type=Elvish Shaman
		[/disallow_recruit]
		[disallow_recruit]
		side=1
		type=Horseman
		[/disallow_recruit]
		[disallow_recruit]
		side=1
		type=Mage
		[/disallow_recruit]
	[/event]

#define ISLE_GALLEON_ARRIVE
		[command]
			[move_unit_fake]
			type=Galleon
			x=23,23,23,23,23,24
			y=1,2,3,4,5,5
			[/move_unit_fake]
		[/command]
		[command]
			[item]
			x=24
			y=5
			image=galleon.png
			[/item]
		[/command]
		[allow_recruit]
		side=1
		type=Elvish Fighter
		[/allow_recruit]
		[allow_recruit]
		side=1
		type=Elvish Archer
		[/allow_recruit]
		[allow_recruit]
		side=1
		type=Elvish Scout
		[/allow_recruit]
		[allow_recruit]
		side=1
		type=Elvish Shaman
		[/allow_recruit]
		[allow_recruit]
		side=1
		type=Horseman
		[/allow_recruit]
		[allow_recruit]
		side=1
		type=Mage
		[/allow_recruit]
		[disallow_recruit]
		side=1
		type=Thug
		[/disallow_recruit]
		[disallow_recruit]
		side=1
		type=Poacher
		[/disallow_recruit]
		[disallow_recruit]
		side=1
		type=Footpad
		[/disallow_recruit]

#		[message]
#		description=Banditboss
#		id=isledamn_8
#		message="Hey boss! Can we go with you? We are sick of this awfull island."
#		[/message]
#		[message]
#		id=isledamm_9
#		description=Konrad
#		message=Hmm...I have to consider this...
#			[option]
#			id=accept_bandits
#			message="Yes, on board!."
#			[/option]
#			[option]
#			id=reject_bandits
#			message="I'm not truly trust in you, bandits are treacherous."
#				[command]
#					[message]
#					id=msg5_14a
#					description=Banditboss
#					message=""
#					[/message]
#					[kill]
#					type=Thug
#					[/kill]
#					[kill]
#					type=Poacher
#					[/kill]
#					[kill]
#					type=Outlaw
#					[/kill]
#					[kill]
#					type=Bandit
#					[/kill]
#				[/command]
#			[/option]
#		[/message]
#enddef

#define ISLE_RESTORE_GOLD
	[gold]
	side=1
	amount=$isle_damned_starting_gold
	[/gold]
#enddef

	[event]
	name=enemies defeated
		[command]
			[message]
			id=isle_wrested_control
			description=Konrad
			message="We have wrested control of the island from the evil undead! Now all we have to do is wait for the ship to arrive, so we can make our way to Elensefar!"
			[/message]
		[/command]

		{ISLE_GALLEON_ARRIVE}
		{ISLE_RESTORE_GOLD}

	[/event]

	[event]
	name=time over
		{ISLE_GALLEON_ARRIVE}
		{ISLE_RESTORE_GOLD}
		[command]
			[message]
			id=isle_damned_found1
			speaker=narrator
			image=elvish-fighter.png
			message="Thank goodness we have found you, sir! Come aboard quickly, we shall take you away from this horrible island!"
			[/message]
		[/command]
		[command]
			[message]
			id=isle_damned_found2
			description=Konrad
			message="It's a shame complete victory could not be ours, but thank goodness I am rescued! On to Elensefar!"
			[/message]
		[/command]
		[command]
			[endlevel]
			result=victory
			[/endlevel]
		[/command]
	[/event]
[/scenario]
