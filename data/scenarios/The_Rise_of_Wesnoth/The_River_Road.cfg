[scenario]
	id=The_River_Road
	textdomain=wesnoth-trow
	name= _ "The Swamp of Esten"
	map_data="{maps/The_Rise_of_Wesnoth/The_River_Road}"
	turns=36
	
	{scenarios/The_Rise_of_Wesnoth/trow-nohome.cfg}
	
	{DAWN}
	{MORNING}
	{AFTERNOON}
	{DUSK}
	{FIRST_WATCH}
	{SECOND_WATCH}

	next_scenario=The_Oldwood
	bonus=yes
	
	music=wesnoth-8.ogg
	
	objectives= _ "
Victory:
@Defeat All Enemies
Defeat:
#Death of Prince Haldric or
#Turns run out"

	{scenarios/The_Rise_of_Wesnoth/trow-deaths.cfg}
	{scenarios/The_Rise_of_Wesnoth/trow-macros.cfg}

	[story]
		[part]
			background=maps/the_green_isle.png
			show_title=yes
			{DOT 300 290}
			{DOT 310 290}
			{DOT 320 300}
			{DOT 335 305}
			{DOT 350 305}
			{CROSS 360 306}
		[/part]
	[/story]

	[side]
		type=Noble Commander
		description=Prince Haldric
		side=1
		canrecruit=1
		controller=human
		team_name=Haldric
		fog=yes
	[/side]
	
	[side]
		type=Necromancer
		description=Cleon
		#This is the nearest enemy, make him softer.
		side=2
		canrecruit=1
		#He's fodder boy
		recruit=Vampire Bat, Walking Corpse, Dark Adept
		[ai]
			{NO_SCOUTS}
			recruitment_pattern=scout,fighter,fighter,fighter,archer
			recruitment_ignore_bad_movement=yes
		[/ai]
		{GOLD 80 120 180}
		team_name=cult
	[/side]
	
	[side]
		type=Necromancer
		description=Lollyra
		side=3
		canrecruit=1
		{GOLD 130 170 230}
		[ai]
			{NO_SCOUTS}
			recruitment_ignore_bad_combat=yes
			recruitment_pattern=scout,fighter,mixed fighter,fighter,fighter,archer
		[/ai]
#ifdef EASY
		recruit=Dark Adept, Thief, Thug, Skeleton, Skeleton Archer, Vampire Bat, Walking Corpse
#endif
#ifdef NORMAL
		recruit=Dark Adept, Rogue, Thug, Skeleton, Skeleton Archer, Vampire Bat, Walking Corpse, Ghost
#endif
#ifdef HARD
		recruit=Dark Adept, Rogue, Thug, Revenant, Skeleton Archer, Vampire Bat, Ghost, Walking Corpse
#endif
		team_name=cult
	[/side]
	
	[side]
		type=Necromancer
		description=Clurka
		side=4
		canrecruit=1
		{GOLD 130 170 230}
		[ai]
			{NO_SCOUTS}
			recruitment_ignore_bad_movement=yes
			recruitment_pattern=scout,fighter,mixed fighter,fighter,fighter,archer
		[/ai]

#ifdef EASY
		recruit=Dark Adept, Thief, Thug, Skeleton, Skeleton Archer, Vampire Bat, Giant Scorpion, Walking Corpse
#endif
#ifdef NORMAL
		recruit=Dark Adept, Thief, Bandit, Skeleton, Skeleton Archer, Vampire Bat, Giant Scorpion, Walking Corpse
#endif
#ifdef HARD
		recruit=Dark Adept, Thief, Bandit, Skeleton, Bone Shooter, Vampire Bat, Giant Scorpion, Walking Corpse
#endif
		team_name=cult
	[/side]

	[event]
		name=prestart

		{PUT_IMG (items/signpost.png) 15 31}
		{PUT_IMG (terrain/temple.png) 19 5}
		{PUT_IMG (terrain/temple.png) 30 10}
		{PUT_IMG (terrain/temple.png) 34 36}
		{PUT_IMG (terrain/temple.png) 1 26}
		{PUT_IMG (terrain/temple.png) 5 12}

		{GUARD_UNIT (Giant Scorpion) (Scorpion) 2 26 4}
		{GUARD_UNIT (Giant Scorpion) (Scorpion) 3 32 27}
		{GUARD_UNIT (Giant Scorpion) (Scorpion) 4 17 35}
#ifdef NORMAL
		{GUARD_UNIT (Giant Scorpion) (Scorpion) 2 13 8}
		{GUARD_UNIT (Giant Scorpion) (Scorpion) 3 32 31}
		{GUARD_UNIT (Giant Scorpion) (Scorpion) 4 9 34}
#endif
#ifdef HARD
		{GUARD_UNIT (Giant Scorpion) (Scorpion) 2 13 8}
		{GUARD_UNIT (Giant Scorpion) (Scorpion) 2 15 3}
		{GUARD_UNIT (Giant Scorpion) (Scorpion) 3 32 31}
		{GUARD_UNIT (Giant Scorpion) (Scorpion) 3 33 36}
		{GUARD_UNIT (Giant Scorpion) (Scorpion) 4 9 34}
		{GUARD_UNIT (Giant Scorpion) (Scorpion) 4 20 32}
#endif
		[recall]
			description=Lady Outlaw
		[/recall]
		
		[recall]
			description=Burin the Lost
		[/recall]
	[/event]
	
	[event]
		name=start
		[message]
			id=msgT3a_1
			speaker=narrator
			message= _ "With great trepidation Prince Haldric leads his refugee band into the Swamp of Esten. In the centre of that very swamp a shroud of fog descends over Young Prince Haldric."
		[/message]
		
		[message]
			id=msgT3a_2
			speaker=Prince Haldric
			message= _ "I have a very bad feeling about this. This awful swamp and it's crazy cult. . . Before these troubles started we used to have to clear the swamp every spring and fall."
		[/message]
		
		[message]
			id=msgT3a_3
			speaker=Prince Haldric
			message= _ "I suppose with the rampaging bands of murderous Orcs roaming about that hasn't been done in a while."
		[/message]
		
		[message]
			id=msgT3a_4
			speaker=Burin the Lost
			message= _ "I miss the Orcs. . . We go all this way, and (SNIFF) what a lovely smell we have discovered."
		[/message]
		
		[message]
			id=msgT3a_5
			speaker=Lady Outlaw
			message= _ "This is too quiet. I don't like this one bit, not one bit at all."
		[/message]
		
		[message]
			id=msgT3a_6
			speaker=Prince Haldric
			message= _ "Wait, I think I hear Something. . . To Arms!"
		[/message]
	
	[/event]
	
	[event]
	name=moveto
		[filter]	
			x=13
			y=6
			side=1
		[/filter]
		{UNIT (Giant Scorpion) (Scorpion) 2 16 5}
	[/event]
	
	[event]
	name=moveto
		[filter]	
			x=10
			y=25
			side=1
		[/filter]
		{UNIT (Giant Scorpion) (Scorpion) 3 10 27}
	[/event]
	
	[event]
	name=moveto
		[filter]
			x=28
			y=33
			side=1
		[/filter]
		{UNIT (Giant Scorpion) (Scorpion) 4 32 33}
	[/event]
	
#define TEMPLE_HELP X Y
	[event]
	name=moveto
		[filter]
			side=1
			x={X}
			y={Y}
		[/filter]
		[message]
			id=msgT3a_7
			speaker=Prince Haldric
			message= _ "Careful, you don't know what's lurking in there!"
		[/message]
		[unit]
			description=Minister Edmond
			side=1
			type=White Mage
			x={X}
			y={Y}
		[/unit]
		[message]
			id=msgT3a_8
			description=Minister Edmond
			message= _ "Back you vile--- Oh, sorry I thought you were undead. When are those goofs in Clearwater Port Going to clear the swamp again?"
		[/message]
		[message]
			id=msgT3a_9
			speaker=Prince Haldric
			message= _ "Maybe they'll clear it SOME TIME AFTER THE APOCALYPSE is over!"
		[/message]
		[message]
			id=msgT3a_10
			description=Minister Edmond
			message= _ "Oooh! I take it you wouldn't mind if I helped out?"
		[/message]
	[/event]
#enddef

#define TEMPLE_TRAP X Y
	[event]
	name=moveto
		[filter]
			side=1
			x={X}
			y={Y}
		[/filter]
		[message]
			id=msgT3a_11
			speaker=unit
			message= _ "Hey, there's somebody hidden in the temple. Ack! Hold there!"
		[/message]
		[unit]
			side=2
			type=Vampire Bat
			x={X}
			y={Y}
		[/unit]
		[unit]
			side=3
			type=Walking Corpse
			x={X}
			y={Y}
		[/unit]
		[unit]
			side=4
			type=Walking Corpse
			x={X}
			y={Y}
		[/unit]
#ifdef HARD
		[unit]
		side=2
		type=Ghost
		x={X}
		y={Y}
		[/unit]
#endif
	[/event]
#enddef

#define TEMPLE_LOOT X Y
	[event]
	name=moveto
	[filter]
		side=1
		x={X}
		y={Y}
	[/filter]
	[command]
		[gold]
			side=1
			amount=50
		[/gold]
	[/command]
	
	[command]
		[message]
			id=gold_temple
			speaker=narrator
			message= _ "You find treasure worth 50 pieces of gold in the temple"
		[/message]
	[/command]
	
	[/event]
#enddef

	[event]
	name=start
		{RANDOM 1..3}
		[if]
			[variable]
			name=random
			numerical_equals=1
			[/variable]
			[then]
				{TEMPLE_HELP 5 12}
				{TEMPLE_TRAP 34 36}
				{TEMPLE_TRAP 19 5}
				{TEMPLE_LOOT 1 26}
				{TEMPLE_LOOT 30 10}
			[/then]
		[/if]
		[if]
			[variable]
			name=random
			numerical_equals=2
			[/variable]
			[then]
				{TEMPLE_HELP 1 26}
				{TEMPLE_TRAP 34 36}
				{TEMPLE_TRAP 5 12}
				{TEMPLE_LOOT 19 5}
				{TEMPLE_LOOT 30 10}
			[/then]
		[/if]
		[if]
			[variable]
			name=random
			numerical_equals=3
			[/variable]
			[then]
				{TEMPLE_HELP 19 5}
				{TEMPLE_TRAP 34 36}
				{TEMPLE_TRAP 1 26}
				{TEMPLE_LOOT 5 12}
				{TEMPLE_LOOT 30 10}
			[/then]
		[/if]
	[/event]

	
	
	[event]
		name=moveto
		[filter]
			side=1
			x=15
			y=31
		[/filter]
		[message]
			id=msgT3a_12
			speaker=narrator
			message= _ "SW - The Oldwood Forest. Enter at Your Own Risk!"
		[/message]
	[/event]
	
	[event]
        name=die
		[filter]
                	description=Lollyra
                [/filter]
		[message]
			id=msgT3a_13
			speaker=Lollyra
			message= _ "May I live forever in Undeath!"
		[/message]
	[/event]
	
	[event]
        name=die
		[filter]
                	description=Clurka
                [/filter]
		[message]
			id=msgT3a_14
			speaker=Clurka
			message= _ "Ohhh! To be risen again!"
		[/message]
	[/event]
	
	[event]
        name=die
		[filter]
                	description=Cleon
                [/filter]
		[message]
			id=msgT3a_15
			speaker=Cleon
			message= _ "A prayer for life immortal!"
		[/message]
	[/event]
	
	[event]
	name=victory
		
		[move_unit_fake]
			type=Knight
			x=35,34,33,32,31,30
			y=35,34,35,34,34,33
		[/move_unit_fake]
		
		{UNIT (Knight) (Sir Ruddry) 1 30 33}
		
		[scroll_to_unit]
			description=Sir Ruddry
			side=1
		[/scroll_to_unit]
		
		[message]
			description=Sir Ruddry
			id=msgT3a_16
			message= _ "I don't know who you are, but you can't continue down this road! There is an army of those Orcs bigger than any army I've ever seen just down the road!"
		[/message]
		
		[message]
			description=Prince Haldric
			id=msgT3a_17
			message= _ "I'm Haldric, my father was King Eldaric IV in the lands North-West of here. Soldier have you deserted your post?"
		[/message]
		
		[message]
			description=Sir Ruddry
			id=msgT3a_18
			message= _ "No Sir! I'm the sole survivor of the Clearwater Port expeditionary force. Trust me, you can't continue down this road sir. Especially with the refugees, you'll be slaughtered."
		[/message]
		
		[message]
			description=Prince Haldric
			id=msgT3a_19
			message= _ "Tell me, does Clearwater Port still stand? Is the port free?"
		[/message]
		
		[message]
			description=Sir Ruddry
			id=msgT3a_20
			message= _ "As far as I know Sir. We have a large army, and they were pressing all able bodied men and boys into service when I left. That Orcish army is huge, but they haven't met the main body of our forces yet."
		[/message]
		
		[message]
			description=Prince Haldric
			id=msgT3a_21
			message= _ "Well, we can't go back, and the road ahead is blocked. I guess we'll have to risk it and go through the Oldwood forest, then make a break for Clearwater Port or Southbay."
		[/message]
		
		[message]
			id=msgT3a_22
			speaker=Burin the Lost
			message= _ "Oh great, now a Forest. . . I should have stayed at home and took my chances with the Orcs!"
		[/message]
		
		[message]
			description=Sir Ruddry
			id=msgT3a_23
			message= _ "Sir, if you don't mind, I'll go with you."
		[/message]
		
		[message]
			id=msgT3a_24
			speaker=Lady Outlaw
			message= _ "On we go. . ."
		[/message]
		[set_variable]
			name=last_done
			value="River"
		[/set_variable]

		{CLEAR_VARIABLE random}
	[/event]
	
	[event]
	name=time over
		[message]
			id=msg4_25
			description=King Eldaric IV
			message= _ "We have run out of time. . . We'll be trapped in this swamp when winter arrives!"
		[/message]
	[/event]
	
[/scenario]
