[scenario]
	id=The_Vanguard
	textdomain=wesnoth-trow
	name= _ "The Vanguard"
	map_data="{maps/The_Rise_of_Wesnoth/The_Vanguard}"
	turns=38

	{DAWN}
	{MORNING}
	{AFTERNOON}
	{DUSK}
	{FIRST_WATCH}
	{SECOND_WATCH}

	next_scenario=Return_of_the_Fleet
	bonus=yes
	
	music=wesnoth-3.ogg
	
	objectives= _ "
Victory:
@Defeat all Enemies
Defeat:
#Death of Prince Haldric or
#Death of Lt. Aethyr or
#Turns run out"

	{scenarios/The_Rise_of_Wesnoth/trow-deaths.cfg}
	{scenarios/The_Rise_of_Wesnoth/trow-macros.cfg}

	[story]
		[part]
			background=maps/the_great_continent.png
			show_title=yes
			{DOT 310 176}
			{DOT 310 191}
			{DOT 300 200}
			{DOT 290 207}
			{CROSS 274 212}
		[/part]
	[/story]

	[side]
		description=Prince Haldric
		side=1
		type=Noble Commander
		canrecruit=1
		controller=human
		team_name=Haldric
		fog=yes
	[/side]

	[side]
		type=Orcish Warlord
		description=Tan-Erirt
		side=2
		canrecruit=1
#ifdef EASY
		recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbow, Goblin Pillager, Goblin Knight
#endif

#ifdef NORMAL	
		recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbow, Goblin Pillager, Goblin Knight, Orcish Slayer, Orcish Warrior
#endif

#ifdef HARD
		recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbow, Orcish Warrior, Goblin Knight, Goblin Pillager, Orcish Slayer
#endif
		{GOLD 160 200 260}
		team_name=orcs
		[ai]
			{NO_SCOUTS}
			recruitment_ignore_bad_movement=yes
			recruitment_pattern=scout,fighter,fighter,archer
		[/ai]
		[ai] 
			time_of_day=dusk,first_watch,second_watch 
			aggression=0.75
			caution=0.0
			grouping=no
		[/ai]
		{INCOME 4 8 12}
	[/side]
	
	[side]
		type=Orcish Warlord
		description=Tan-Gagar
		side=3
		canrecruit=1
#ifdef EASY
		recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbow, Goblin Pillager, Goblin Knight
#endif

#ifdef NORMAL	
		recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbow, Goblin Knight, Orcish Slayer, Orcish Warrior
#endif

#ifdef HARD
		recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbow, Orcish Warrior, Goblin Knight, Goblin Pillager, Orcish Slayer
#endif
		{GOLD 160 200 260}
		team_name=orcs
		[ai]
			{NO_SCOUTS}
			recruitment_ignore_bad_movement=yes
			recruitment_pattern=scout,fighter,fighter,archer
		[/ai]
		[ai] 
			time_of_day=dusk,first_watch,second_watch 
			aggression=0.75
			caution=0.0
			grouping=no
		[/ai]
		{INCOME 4 8 12}
	[/side]

	[side]
		type=Troll Warrior
		description=Thruf
		side=4
		canrecruit=1
#ifdef EASY
		recruit=Troll Whelp
#endif

#ifdef NORMAL	
		recruit=Troll Whelp,Troll
#endif

#ifdef HARD
		recruit=Troll Whelp,Troll,Troll Warrior
#endif

		{GOLD 120 160 220}
		team_name=orcs
		[ai]
			{NO_SCOUTS}
			recruitment_ignore_bad_movement=yes
			recruitment_pattern=fighter,fighter,scout
			grouping=no
		[/ai]

		{INCOME 4 8 12}
	[/side]

	[event]
	name=prestart

		{STARTING_VILLAGES 2 8}
		{STARTING_VILLAGES 3 8}
		{STARTING_VILLAGES 4 8}

		{PUT_IMG (items/fire.png) 4 24}
		{PUT_IMG (items/fire.png) 8 25}
		{PUT_IMG (items/fire.png) 26 9}
		{PUT_IMG (items/fire.png) 25 17}

		{VARIABLE_OP xx1 random 13..25} 
		{VARIABLE_OP yy1 random 7..8}

		{PUT_IMG (items/chest-plain-closed.png) $xx1 $yy1}

		[recall]
			description=Lady Jessica
		[/recall]
		[recall]
			description=Lt. Aethyr
		[/recall]

		#OK Get rid of the Ruby of Fire
		[store_unit]
			variable=haldric_store
			kill=yes
			[filter]
			description=Prince Haldric
			[/filter]
		[/store_unit]

		[unit]
			type=$haldric_store.type
			description=$haldric_store.description
			side=1
			x=$haldric_store.x
			y=$haldric_store.y
			canrecruit=1
			experience=$haldric_store.experience
			user_description=$haldric_store.user_description
		[/unit]

		{CLEAR_VARIABLE haldric_store}
	[/event]

	[event]
		name=start
		[message]
			id=msgT18_1
			speaker=narrator
			message= _ "Haldric and his companions race across the plains to confront the resurgent Orcish threat. On the eve of battle Lady Jessica catches up with Haldric on a fog covered plain."
		[/message]
		[message]
			id=msgT18_2
			description=Lady Jessica
			message= _ "Haldric, the Elves, we can't trust them!"
		[/message]

		[message]
			id=msgT18_3
			description=Prince Haldric
			message= _ "I could have told you that."
		[/message]
		[message]
			id=msgT18_4
			description=Lady Jessica
			message= _ "Haldric, it's bad. The Elves are having second thoughts. They think we might be more trouble than we're worth. We have to defeat these Orcs decisively."
		[/message]
		[message]
			id=msgT18_5
			description=Prince Haldric
			message= _ "Well, that sounds reasonable."
		[/message]
		[message]
			id=msgT18_6
			description=Lady Jessica
			message= _ "More Orcs will follow after these, that Ruby guarantees it. If more Orcs follow us here the Elves seem content to let us fight it out. Then they said they would 'deal with the survivors'."
		[/message]
		[message]
			id=msgT18_7
			description=Lady Jessica
			message= _ "Jevyan is here. . . His familiar, that bat. He won't let such a lucrative prize as the Ruby of Fire just slip away. Especially when he sees that he has the advantage."
		[/message]
		[message]
			id=msgT18_8
			description=Prince Haldric
			message= _ "I have a plan. Jessica, remember that Troll Hole? Here, take the Ruby of Fire, hide it in the hole."
		[/message]
		[message]
			id=msgT18_12
			description=Lady Jessica
			message= _ "Haldric! What! Why?"
		[/message]
		[message]
			id=msgT18_13
			description=Prince Haldric
			message= _ "Just do it."
		[/message]
		[message]
			id=msgT18_13b
			description=Prince Haldric
			message= _ "Lt. Aethyr, did these Orcs come on our ships, did they capture the fleet we sent out?"
		[/message]
		[message]
			id=msgT18_14
			description=Lt. Aethyr
			message= _ "No Sir! They must have seized all of remaining boats on the Green Isle. Our fleet should be returning any day now."
		[/message]
		[message]
			id=msgT18_15
			description=Prince Haldric
			message= _ "We are a refugee people, we must push back their vanguard, and secure our beachhead. If they capture our ships all is lost. We will be crushed under a tide of Orcs."
		[/message]

		[store_unit]
			variable=jessica_store
			kill=yes
			[filter]
			description=Lady Jessica
			[/filter]
		[/store_unit]

		[message]
			id=msgT18_16
			speaker=narrator
			message= _ "Lady Jessica soon departs. In the distance a voice booms:"
		[/message]

		[recall]
			description=Burin the Lost
		[/recall]
		[recall]
			description=Sir Ruddry
		[/recall]
		[recall]
			description=Sir Ladoc
		[/recall]
		[recall]
			description=Minister Edmond
		[/recall]

		[message]
			id=msgT18_17
			description=Tan-Gagar
			message= _ "Drop the gold where it is! We've payed our friends enough. There are humans about, I can smell 'em!"
		[/message]

	[/event]

	[event]
	name=time over
		[message]
			id=msgT18_18
			description=Prince Haldric
			message= _ "We have run out of time. . . We'll never beat the Orcs to the beach"
		[/message]
	[/event]

	[event]
		name=moveto
		[filter]
			side=1
			x=$xx1
			y=$yy1
		[/filter]
		[message]
			id=msgT18_19
			speaker=unit
			message= _ "I've found the Orcs' chest! It's filled with gold."
		[/message]

		[removeitem]
		[/removeitem]

		{PUT_IMG (items/chest-plain-open.png) $xx1 $yy1}

#ifdef EASY
		{LOOT 125 1}
#endif

#ifdef NORMAL
		{LOOT 100 1}
#endif

#ifdef HARD
		{LOOT 75 1}
#endif

	[/event]

	[event]
	name=attack
		[filter_second]
			description=Tan-Erirt
		[/filter_second]
		
		{UNIT (Soul Shooter) (Rabbin) 2 1 28}

		[message]
			id=msgT18_20
			description=Rabbin
			message= _ "You will be felled by by hand you useless fleashbags!"
		[/message]

		{UNIT (Chocobone) (Rider) 2 1 29}
		{UNIT (Chocobone) (Rider) 2 1 27}
#ifdef HARD
		{UNIT (Chocobone) (Rider) 2 2 28}
#endif
	[/event]
	
	[event]
	name=attack
		[filter_second]
		#The Forest Orc
			description=Tan-Gagar
		[/filter_second]
		
		{UNIT (Death Knight) (General Kafka) 3 35 19}
		
		[message]
			id=msgT18_22
			description=General Kafka
			message= _ "Never trust the living to do the job of the undead. Prepare to meet the inevitable!"
		[/message]

		[message]
			id=msgT18_23
			description=Minister Edmond
			message= _ "The only job of the dead is to remain dead. Prepare to be reunited with the ground."
		[/message]
		
		{UNIT (Chocobone) (Rider) 3 35 18}
		{UNIT (Chocobone) (Rider) 3 35 20}
#ifdef HARD
		{UNIT (Chocobone) (Rider) 3 35 17}
		{UNIT (Chocobone) (Rider) 3 35 21}
#endif
	[/event]
	
	[event]
		name=die
		[filter]
			description=Tan-Erirt
		[/filter]
		
		[filter_second]
			side=1
		[/filter_second]

		[message]
			description=Tan-Gagar
			id=msgT18_24
			message= _ "We must block the human advance!"
		[/message]
		
		[gold]
			side=3
			amount=80
		[/gold]
	[/event]
	
	[event]
		name=die
		[filter]
			description=Tan-Gagar
		[/filter]
		
		[filter_second]
			side=1
		[/filter_second]

		[message]
			description=Tan-Erirt
			id=msgT18_25
			message= _ "Reserves! We can't let them get to their landing site."
		[/message]
		
		[gold]
			side=2
			amount=80
		[/gold]
	[/event]

	[event]
		name=victory

		[message]
			description=Prince Haldric
			id=msgT18_26
			message= _ "We've defeated their vanguard. We have to meet the fleet before Jevyan destroys them, and captures the ships. I hope Jessica makes it back soon."
		[/message]

		{CLEAR_VARIABLE xx1}
		{CLEAR_VARIABLE yy1}
	[/event]

	[event]
		name=die
		[filter]
			description=Lt. Aethyr
		[/filter]
		
		[message]
			id=msgT18_27
			speaker=Lt. Aethyr
			message= _ "Oh, to join my family again! Do not mourn my passing."
		[/message]
		
		[endlevel]
			result=defeat
		[/endlevel]
	[/event]
	
	[event]
		name=attack
		[filter]
			description=Burin the Lost
		[/filter]
		
		[message]
			id=msgT18_28
			speaker=Burin the Lost
			message= _ "Ahh, it's great to be home! I'm not much for the politics, but it's great to be home!"
		[/message]
	[/event]
[/scenario]
