[scenario]
	id=A_Final_Spring
	textdomain=wesnoth-trow
	name= _ "A Final Spring"
	map_data="{maps/The_Rise_of_Wesnoth/A_Final_Spring}"
	turns=36

	{DAWN}
	{MORNING}
	{AFTERNOON}
	{DUSK}
	{FIRST_WATCH}
	{SECOND_WATCH}

	next_scenario=Peoples_in_Decline
	bonus=yes
	
	music=wesnoth-7.ogg
	
	objectives= _ "
Victory:
@Defeat the Orcs
Defeat:
#Death of Prince Haldric or
#Death of King Addroran IX or
#Death of Lady Jessica or
#Turns run out"

	{scenarios/The_Rise_of_Wesnoth/trow-deaths.cfg}
	{scenarios/The_Rise_of_Wesnoth/trow-macros.cfg}

	[story]
		[part]
			background=campaigns/The_Rise_of_Wesnoth/maps/the_green_isle.png
			show_title=yes
			{CROSS 191 407}
		[/part]
	[/story]

	[side]
		description=Prince Haldric
		side=1
		type=Noble Commander
		unrenamable=yes
		canrecruit=1
		controller=human
		team_name=Haldric
	[/side]

	[side]
		type=Grand Knight
		description=King Addroran IX
		side=2
		canrecruit=1
		{GOLD 220 160 120}
		team_name=Haldric
		recruit=Bowman, Horseman, Mage, Spearman, Knight, Swordsman, Peasant
		[ai]
			{NO_SCOUTS}
			recruitment_ignore_bad_movement=yes
			grouping=defensive
			passive_leader=yes
			recruitment_pattern=fighter,fighter,archer,mixed fighter
		[/ai]
	[/side]
	
	[side]
		type=Orcish Warlord
		description=Tan-Harak
		side=3
		canrecruit=1
#ifdef EASY
		recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbowman, Goblin Pillager, Goblin Knight, Goblin Spearman
#endif

#ifdef NORMAL	
		recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbowman, Goblin Knight, Orcish Slayer, Orcish Warrior, Goblin Spearman
#endif

#ifdef HARD
		recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbowman, Orcish Warrior, Goblin Knight, Goblin Pillager, Orcish Slayer, Goblin Spearman
#endif
		{GOLD 210 250 310}
		team_name=orcs
		[ai]
			{NO_SCOUTS}
			recruitment_ignore_bad_movement=yes
			recruitment_pattern=scout,fighter,fighter,archer
			{ATTACK_DEPTH 4 5 6}
		[/ai]
		[ai] 
			time_of_day=dusk,first_watch,second_watch 
			aggression=0.75
			caution=0.0
			grouping=no
		[/ai]
		{INCOME 4 8 12}
	[/side]
	
	[side]
		type=Orcish Warlord
		description=Tan-Hork
		side=4
		canrecruit=1
#ifdef EASY
		recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbowman, Goblin Pillager, Goblin Knight
#endif

#ifdef NORMAL	
		recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbowman, Goblin Knight, Orcish Slayer, Orcish Warrior
#endif

#ifdef HARD
		recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider, Orcish Crossbowman, Orcish Warrior, Goblin Knight, Goblin Pillager, Orcish Slayer
#endif
		{GOLD 210 250 310}
		team_name=orcs
		[ai]
			{NO_SCOUTS}
			recruitment_ignore_bad_movement=yes
			recruitment_pattern=scout,fighter,fighter,archer
			{ATTACK_DEPTH 4 5 6}
		[/ai]
		[ai] 
			time_of_day=dusk,first_watch,second_watch 
			aggression=0.75
			caution=0.0
			grouping=no
		[/ai]
		{INCOME 4 8 12}
	[/side]

	[side]
		type=Orcish Warlord
		description=Tan-Gulo
		side=5
		canrecruit=1
		recruit=Sea Orc, Vampire Bat
		{GOLD 180 220 280}
		team_name=orcs
		[ai]
			{NO_SCOUTS}
			recruitment_ignore_bad_movement=yes
			recruitment_pattern=fighter,fighter,scout
			{ATTACK_DEPTH 4 5 6}
		[/ai]
		[ai] 
			time_of_day=dusk,first_watch,second_watch 
			aggression=0.75
			caution=0.0
			grouping=no
		[/ai]
		{INCOME 4 8 12}
	[/side]

#Time Areas broken - no visible change, use a halo with it
	[time_area] 
		x=1,1,1,2,2,2,2,3,3,3,3,3,4,4,4,4,5,5,5				#,6,6
		y=17,18,19,16,17,18,19,16,17,18,19,20,16,17,18,19,17,18,19	#,17,18
		{MORNING} 
		{MORNING} 
		{AFTERNOON} 
		{AFTERNOON} 
		{DUSK} 
		{DAWN}
	[/time_area] 

	[event]
	name=prestart

		{STARTING_VILLAGES 1 12}
		{STARTING_VILLAGES 2 10}

		#{PUT_IMG (items/lighthouse.png) 3 18}
		[item]
			x=3
			y=18
			image=items/lighthouse.png
			halo=halo/lighthouse-aura.png
		[/item]
		
		{PUT_IMG (pirate-galleon.png) 17 24}
		{PUT_IMG (pirate-galleon.png) 20 22}
		{PUT_IMG (galleon.png) 21 25}
		{PUT_IMG (misc/trapdoor.png) 16 30}
		{PUT_IMG (items/signpost.png) 24 24}
		{PUT_IMG (items/signpost.png) 30 44}
		{PUT_IMG (items/signpost.png) 41 32}
		{PUT_IMG (items/signpost.png) 16 4}
		{PUT_IMG (items/signpost.png) 39 11}
		{PUT_IMG (items/signpost.png) 18 17}

		[recall]
			description=Lady Jessica
			x=12
			y=27
		[/recall]
		[recall]
			description=Burin the Lost
			x=14
			y=27
		[/recall]
		[recall]
			description=Sir Ruddry
			x=12
			y=28
		[/recall]
		[recall]
			description=Sir Ladoc
			x=14
			y=28
		[/recall]
		[recall]
			description=Minister Edmond
			x=13
			y=29
		[/recall]

		{GUARD_UNIT (Swordsman) (Southbay Guard) 2 19 33}
		{GUARD_UNIT (Swordsman) (Southbay Guard) 2 21 30}
		{GUARD_UNIT (Swordsman) (Southbay Guard) 2 28 24}
		{GUARD_UNIT (Swordsman) (Southbay Guard) 2 27 22}

		[object]
			#Thanks to Dave for helping me
			silent=yes
			[filter]
				type=Noble Commander,Noble Lord
				x=13
				y=28
			[/filter]
			[effect]
				apply_to=new_attack
				name= _ "Ruby of Fire"
				icon=projectiles/fireball.png
				description= _ "The Ruby of Fire was imbued with magic in the distant West, and can be used to scorch enemies into submission."
				image=projectiles/fireball.png
				duration=forever
				type=fire
				range=long
				special=magical
				damage=14
				number=4
				[sound]
					time=-200
					sound=fire.wav
				[/sound]
				[missile_frame]
					begin=-100
					end=0
					image=projectiles/fireball.png
					image_diagonal=projectiles/fireball.png
					halo=halo/fireball1.png,halo/fireball2.png,halo/fireball3.png,halo/fireball4.png,halo/fireball5.png,halo/fireball6.png
					halo_x,halo_y=14,-14
				[/missile_frame]
			[/effect]
		[/object]
	[/event]

	[event]
		name=start
		[message]
			id=msgT11_1
			speaker=narrator
			message= _ "Several months pass. Jessica has translated Lich-Lord Caror's Book. Prince Haldric is busy trying to understand the secrets of the Ruby of Fire."
		[/message]
		[message]
			id=msgT11_2
			description=Prince Haldric
			message= _ "I think I've figured something out. Look."
		[/message]
		[move_unit_fake]
			type=Fireball
			x=13,12,12,14,13,12,13,14
			y=27,26,26,26,26,25,25,25
		[/move_unit_fake]
		[message]
			id=msgT11_3
			description=Prince Haldric
			message= _ "Ouch! Hot, hot, hot! Gee, somebody should really attach this thing to a sceptre or something! I think I'll save it for closer ranged combat for now."
		[/message]
		[message]
			id=msgT11_4
			description=Lady Jessica
			message= _ "Watch it! Well, at least you're improving."
		[/message]
		[message]
			id=msgT11_5
			description=Burin the Lost
			message= _ "Humph. Fool of a boy's just gonna burn us all up. Humans, always playing at being Wizards."
		[/message]
		[message]
			id=msgT11_6
			description=Southbay Guard
			message= _ "Orcs Sighted! They've seized the frontier! To arms! To arms!"
		[/message]
		[message]
			id=msgT11_7
			description=Sir Ladoc
			image="portraits/The_Rise_of_Wesnoth/knight.png"
			message= _ "For the glory of Southbay!"
		[/message]
		[message]
			id=msgT11_8
			description=King Addroran IX
			message= _ "Prince Haldric, I'll concentrate on holding Southbay. You must defeat the Orcs. The ships aren't ready yet. We must defeat this army of Orcs to buy us more time. Try not to kill us all with that ruby!"
		[/message]
		[message]
			id=msgT11_9
			description=Prince Haldric
			message= _ "Very well. I'll do my best."
		[/message]
	[/event]
	
	[event]
		name=turn 5
		[move_unit_fake]
			type=Merman Warrior
			x=1,2,3,4
			y=21,20,20,19
		[/move_unit_fake]

		{HERO (Merman Warrior) (Lord Typhon) 1 4 19}

		[message]
			id=msgT11_10
			description=Lord Typhon
			image="portraits/The_Rise_of_Wesnoth/typhon.png"
			message= _ "I come seeking the Crown Prince!"
		[/message]
		[message]
			id=msgT11_11
			description=King Addroran IX
			message= _ "Who is this fish man?"
		[/message]
		[message]
			id=msgT11_12
			description=Lady Jessica
			message= _ "He's a big part of the reason your son made it to the lands of the East. Lord Typhon provided us with pearls and an escort for our voyages, in exchange for steel trident points and fishhooks. It's difficult to be a blacksmith when you live underwater."
		[/message]
		[message]
			id=msgT11_13
			description=Lord Typhon
			image="portraits/The_Rise_of_Wesnoth/typhon.png"
			message= _ "Indeed it is. But where is the Prince?"
		[/message]
		[message]
			id=msgT11_14
			description=Lady Jessica
			message= _ "The Crown Prince is dead. But we have need of your services again- -"
		[/message]
		[message]
			id=msgT11_15
			description=Lord Typhon
			image="portraits/The_Rise_of_Wesnoth/typhon.png"
			message= _ "Under the same terms?"
		[/message]
		[message]
			id=msgT11_16
			description=Lady Jessica
			message= _ "Agreed."
		[/message]
		[message]
			id=msgT11_17
			description=Lord Typhon
			image="portraits/The_Rise_of_Wesnoth/typhon.png"
			message= _ "Good. We need the steel for our own war in the deep. I formally place the might of the Merfolk at your disposal!"
		[/message]

		[allow_recruit]
			type=Merman Fighter
		[/allow_recruit]
	[/event]

	[event]
	name=turn 30
		[message]
			id=msgT11_18
			description=King Addroran IX
			message= _ "Make haste. We must secure the frontier or it's all over!"
		[/message]
	[/event]
	
	[event]
	name=attack
		[filter_second]
			team=Haldric
		[/filter_second]

		[move_unit_fake]
			type=Blood Bat
			x=45,44,43,42
			y=22,22,23,23
		[/move_unit_fake]

		{UNIT (Blood Bat) (Familiar) 5 42 23}

		[move_unit_fake]
			type=Ancient Lich
			x=45,44,43,42,42
			y=22,22,23,23,24
		[/move_unit_fake]

		{UNIT (Ancient Lich) (Lich-Lord Jevyan) 5 42 24}

		[message]
			id=msgT11_19
			description=Lich-Lord Jevyan
			message= _ "King Addroran your day is done. Prepare to be ground to dust. If you're lucky I may raise you from death for my own amusement. Oh, and what's this? I sense, I sense the Ruby of Fire."
		[/message]
		[message]
			id=msgT11_20
			description=Lady Jessica
			message= _ "You monster! You've betrayed our people- - to ally youself with these Orcs?!"
		[/message]

		{UNIT (Death Knight) (Fool Prince) 5 43 24}

		[message]
			id=msgT11_21
			description=Lich-Lord Jevyan
			message= _ "Fool girl! My ambition extends in to infinity. I will survive. That is more than can be said for you. King Addroran, meet your son, you'll be joining him soon enough."
		[/message]
		[message]
			id=msgT11_22
			description=King Addroran IX
			message= _ "NO!"
		[/message]
		[message]
			id=msgT11_23
			description=Fool Prince
			message= _ "Fath-er! Join. . . us. . ."
		[/message]
		[message]
			id=msgT11_24
			description=Lady Jessica
			message= _ "His older brother was more attractive. . ."
		[/message]

		[kill]
			description=Lich-Lord Jevyan
		[/kill]

		[move_unit_fake]
			type=Ancient Lich
			x=42,42,43,44,45
			y=24,23,23,22,22
		[/move_unit_fake]

		{UNIT (Revenant) (Undead) 5 41 22}
		{UNIT (Bone Shooter) (Undead) 5 43 24}
#ifdef NORMAL	
		{UNIT (Chocobone) (Undead) 5 42 23}
		{UNIT (Chocobone) (Undead) 5 43 23}
#endif

#ifdef HARD
		{UNIT (Chocobone) (Undead) 5 42 23}
		{UNIT (Chocobone) (Undead) 5 43 23}
		{UNIT (Necrophage) (Undead) 5 44 23}
		{UNIT (Necrophage) (Undead) 5 44 22}
#endif
		[kill]
			description=Familiar
		[/kill]

		[move_unit_fake]
			type=Blood Bat
			x=42,43,44,45
			y=23,23,22,22
		[/move_unit_fake]
	[/event]
	
	[event]
		name=time over
		[message]
			id=msgT11_25
			description=Lady Jessica
			message= _ "Their reserves are arriving and we haven't secured the frontier! We're dead!"
		[/message]
	[/event]

	[event]
		name=moveto
		[filter]
			side=1
			x=24
			y=24
		[/filter]
		[message]
			id=msgT11_26
			speaker=narrator
			message= _ "Southbay"
		[/message]
	[/event]

	[event]
		name=moveto
		[filter]
			side=1
			x=30
			y=44
		[/filter]
		[message]
			id=msgT11_27
			speaker=narrator
			message= _ "To Clearwater Port"
		[/message]
	[/event]

	[event]
		name=moveto
		[filter]
			side=1
			x=41
			y=32
		[/filter]
		[message]
			id=msgT11_28
			speaker=narrator
			message= _ "To the Midlands & Oldwood"
		[/message]
	[/event]

	[event]
		name=moveto
		[filter]
			side=1
			x=16
			y=4
		[/filter]
		[message]
			id=msgT11_29
			speaker=narrator
			message= _ "To the Northrun"
		[/message]
	[/event]

	[event]
		name=moveto
		[filter]
			side=1
			x=39
			y=11
		[/filter]
		[message]
			id=msgT11_30
			speaker=narrator
			message= _ "To the Midlands"
		[/message]
	[/event]

	[event]
		name=moveto
		[filter]
			side=1
			x=18
			y=17
		[/filter]
		[message]
			id=msgT11_31
			speaker=narrator
			message= _ "New Southbay"
		[/message]
	[/event]

	[event]
		name=moveto
		[filter]
			side=1
			x=16
			y=30
		[/filter]
		[message]
			id=msgT11_32
			speaker=narrator
			message= _ "They sealed it, there is no escape for you!"
		[/message]
	[/event]

	[event]
		name=die
		[filter]
		description=King Addroran IX
		[/filter]
		[message]
			id=msg_Addroran_die
			speaker=unit
			message= _ "I am finished."
		[/message]
		[message]
			id=msgT11_33
			description=Prince Haldric
			message= _ "We needed him to hold Southbay. We're done for!"
		[/message]
		
		[endlevel]
			result=defeat
		[/endlevel]
	[/event]

	[event]
		name=victory
		[message]
			id=msgT11_34
			description=Prince Haldric
			message= _ "We've defeated the Orcs. Let's rig the Ships and get out of here."
		[/message]
		[message]
			id=msgT11_35
			description=King Addroran IX
			message= _ "My sons- - As we agreed. I will hold Southbay until my last breath."
		[/message]
		[message]
			id=msgT11_36
			description=Lady Jessica
			message= _ "With the help of the Merfolk, and my knowledge of an island that will make a good re-provisioning point, we should be able to embark for the great lands that are to the East."
		[/message]
		[message]
			id=msgT11_37
			description=Lady Jessica
			message= _ "What I don't like is the fact that Lich-Lord Jevyan, whom our capital is named after, betrayed my people. To make matters worse he knows that you have that ruby."
		[/message]
		[message]
			id=msgT11_38
			description=Prince Haldric
			message= _ "There's not much we can do about that now. I dub this fine ship the Eldaric, in honour of my father. About that island. . ."
		[/message]
		[message]
			id=msgT11_39
			description=Burin the Lost
			message= _ "Great, more boats, and now an Ocean!"
		[/message]
		[message]
			id=msgT11_40
			description=King Addroran IX
			message= _ "After you make it to this new land, send some of the ships back, for there may still be survivors in Southbay."
		[/message]
	[/event]
	
	[event]
		name=die
		[filter]
		description=Fool Prince
		[/filter]

		[message]
			id=msgT11_41
			description=King Addroran IX
			message= _ "My Son!"
		[/message]
	[/event]
	
	[event]
		name=attack

		[filter]
		description=King Addroran IX
		[/filter]

		[message]
			id=msgT11_42
			description=King Addroran IX
			message= _ "For the glory of Southbay!"
		[/message]
	[/event]

[/scenario]
