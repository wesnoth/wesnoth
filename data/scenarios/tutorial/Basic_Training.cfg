{./utils.cfg}
[tutorial]
id=tutorial
name= _ "Basic Training"
map_data="{maps/Tutorial/Basic_Training}"
turns=12
music=wesnoth-4.ogg
experience_modifier=50

	{DAWN}
	{MORNING}
	{AFTERNOON}
	{DUSK}
	{FIRST_WATCH}
	{SECOND_WATCH}

victory_when_enemies_defeated=no
	
	[side]
	type=Fighter
	description=Konrad
	canrecruit=1
	side=1
	recruit=Elvish Fighter
	controller=human
	[/side]

	[side]
	type=Elder Mage
	description=Delfador
	canrecruit=1
	side=2
	team_name=1
		[ai]
		passive_leader=yes
		[/ai]
	[/side]

	[side]
	no_leader=yes
	side=3
		[ai]
		passive_leader=yes
		aggression=1
		caution=0
		leader_value=0
			[target]
			type=Elvish Fighter
			value=100
			[/target]
			[target]
			description=Delfador
			value=.1
			[/target]
			[target]
			description=Konrad
			value=.1
			[/target]
			[avoid]
			x=15-18
			y=7-11
			[/avoid]
		[/ai]
	[/side]

	[event]
	name=start

		[message]
		description=Konrad
		message= _ "I am here to learn how to fight in a battle. As an experienced elder mage, surely you can explain the art of combat to me..."
		[/message]

		[message]
		message= _ "Before entering any battle, you need to recruit units. To recruit a unit, right click on the castle tile on which you wish to recruit the unit. Then select Recruit, and select 'OK'. You can only recruit units on castle tiles connected to the keep your leader is on."
		[/message]

		{SET_OBJECTIVE (_"Recruit a unit")}
	[/event]

	[event]
	name=recruit
		[message]
		description=Delfador
		message= _ "Excellent! You have recruited an Elvish Fighter."
		[/message]

		{QUESTION_OPTIONS_START (_"What do I do next?")}

#define RECRUIT_QUESTIONS
{QUESTION_OPTION (_"How do I recruit units?") (_"To recruit a unit, right click on the castle tile on which you wish to recruit the unit. Then select Recruit, or just hold your cursor over the tile and press 'Ctrl-R'. Next, select the type of unit that you want to recruit, and select 'OK'. In order to recruit faster, you can use 'Ctrl-Shift-R' to re-recruit the last type of unit you recruited.")}
{QUESTION_OPTION (_"What's a leader?") (_"A leader is a unit that can recruit. This means that when the leader is on a keep, he can recruit units on the surrounding castle tiles. Leaders are usually powerful units that each side only controls one of. Also, your leader is usually the first unit that your side controls, and starts on a keep. You can select your leader quickly by pressing 'l'. If your leader dies, you lose the game. You can win most scenarios by defeating all enemy leaders.")}
{QUESTION_OPTION (_"How should I choose what kind of units to recruit?") (_"You have to carefully review their skills, which are displayed to the left of the unit selection box,  and cost, which is displayed after the name of the unit. You will learn more about these statistics throughout the tutorial.")}
{QUESTION_OPTION (_"What happens when I recruit a unit?") (_"When you recruit a unit, it appears at full health on a castle tile of your choice. It also receives two traits, which will be discussed later. It cannot move or attack until you end your turn.")}
#enddef
		{RECRUIT_QUESTIONS}
		{QUESTION_OPTIONS_END}
		
		#will be changed once 'role' bug is fixed
		[set_recruit]
		recruit=Elvish Archer,Elvish Shaman
		[/set_recruit]

		[message]
		description=Delfador
		message= _ "Since units cannot move on the turn they are recruited, you must end your turn. To do this, simply click the 'End Turn' button in the lower-right hand corner."
		[/message]

		{SET_OBJECTIVE (_"End your turn")}

		[event]
		name=new turn

		[message]
		description=Delfador
		message= _ "You have successfully ended your turn."
		[/message]

		{QUESTION_OPTIONS_START (_"What do I do next?")}

#define TURN_QUESTIONS
{QUESTION_OPTION (_"How do I end my turn?") (_"One way to end your turn is to press 'Alt-E'. Alternatively, you can right-click and select End Turn, or select the End Turn button in the lower-right hand corner.")}
{QUESTION_OPTION (_"What happens when I end my turn?") (_"When you end your turn, it becomes another side's turn and only that side has the right to move, until that side ends its turn. After all sides end their turns, the next turn begins. This has various effects, including causing all units to regain their full movement potential. The number of the current turn is displayed on the status bar next to the image of a flag. When this number exceeds the maximum number of turns, you lose the game.")}
#enddef
		{TURN_QUESTIONS}
		{QUESTION_OPTIONS_END}

		[message]
		description=Delfador
		message= _ "Your next task is to move your Elvish Fighter. To move a unit, first select it, then select his destination. In this case, his destination is the forest next to the Elvish Shaman, Merle."
		[/message]

		{SET_OBJECTIVE (_"Move your Elvish Fighter next to Merle")}

		[move_unit_fake]
		x=09,10,10,11,11
		y=04,04,05,06,07
		type=Elvish Shaman
		[/move_unit_fake]

		[unit]
		description=Merle
		type=Elvish Shaman
		x,y=11,7
		side=3
		canrecruit=1
		[/unit]

		[event]
		name=moveto
		[filter]
		x=10,10,11,11,12,12
		y=06,07,06,08,06,07
		type=Elvish Fighter
		[/filter]

		[message]
		description=Delfador
		message= _ "Excellent! You have successfully moved your Elvish Fighter. However, since he moved next to an enemy unit, he has lost all his movement for this turn; this is called the 'zone of control'."
		[/message]

		{QUESTION_OPTIONS_START (_"What do I do next?")}
#define MOVE_QUESTIONS
{QUESTION_OPTION (_"How far can my Elvish Fighter move?") (_"Your Elvish Fighter begins with a certain number of move points each turn; this is called his speed. When your Elvish Fighter moves along a path, each hex he goes through costs him move points; this includes his destination. When you select your Elvish Fighter, all hexes he can't move onto within one turn will be shaded. If the destination is far enough away that he needs more than one turn to reach it, a number will appear showing how many turns it will take him. Clicking on a far-away space will set the unit on a course for that space, which means it automatically moves as far as it can towards that space every turn. If you accidentally set a unit on a course, select it twice to remove the course.")}
{QUESTION_OPTION (_"What's the zone of control?") (_"A unit's zone of control is the location consisting of all hexes the unit is adjacent to. Units cannot move through opponent's zones of control; they can only move into it. When they do this, they lose all of their remaining movement. Zones of control can be used to block enemies from reaching your weak and wounded units.")}
{QUESTION_OPTION (_"How do I tell who is allied and who is an enemy?") (_"Units you control have a green, yellow, or red energy circle above their health bar, the green vertical bar next to them. Units with full movement have green: ones with some movement yellow, ones with no movement red. Units controlled by the enemy do not have an energy circle. Allied units you do not control, like me, have a blue energy circle. Also, the option 'Show Team Colors', in Preferences, causes the color of a unit's controller is displayed as a disc below the unit.")}
#enddef
		{MOVE_QUESTIONS}
		{QUESTION_OPTIONS_END}

		[message]
		description=Delfador
		message= _ "Now, you need to attack with your fighter. To attack, first select a unit, then select its target, which must be next to the attacking unit. You will then see the attack options box, where you must select an attack to use."
		[/message]

		{SET_OBJECTIVE (_"Attack Merle")}
		
		[event]
		name=attack
		
		[kill]
		description=Merle
		[/kill]

		[unit]
		type=Elvish Shaman
		description=Merle
		x,y=11,7
		side=3
		[/unit]

		[message]
		description=Delfador
		message= _ "You have successfully attacked Merle."
		[/message]
		
		{QUESTION_OPTIONS_START (_"What do I do next?")}
#define ATTACK_QUESTIONS
{QUESTION_OPTION (_"Can Merle retaliate from my attack?") (_"Whenever a unit is attacked, it retaliates with one of their own weapons. This means that after each blow from the attacker, the defender retaliates with one blow. This continues until one side runs out of blows, in which case the other unit continues attacking until its blows are depleted as well. However, any unit can only retaliate by using a weapon of the same range as the one used to attack. This means that a ranged attack can only be countered by a ranged attack and a melee attack can only be countered by a melee attack. Most units have more powerful melee attacks than ranged attacks. Units with strong ranged attacks are useful in retaliation against melee oriented units. Some melee units without ranged attacks won't be able to retaliate at all. However ranged units cannot shoot across multiple hexes; this is one of the distinctive features of Wesnoth.")}
{QUESTION_OPTION (_"How can you tell how powerful a unit's attacks are?") (_"Every attack does a certain amount of damage per hit, and can be used a certain number of times per battle. These numbers, called the attack's damage and strike numbers, are displayed in order under the name of the attack on the unit's status table and next to it on the attack options menu. To quickly find the maximum damage an attack can inflict, multiply the damage by the number of strikes. For example, my lightning attack does 14 damage per blow and has 4 blows, so it can deal up to 56 damage in a single combat.")}
{QUESTION_OPTION (_"Will my fighter hit every time when he attacks?") (_"Units have the ability to block blows. The chance that a unit has to hit is based on the defender's skill at defending blows, and is listed on the attack options menu after the damage and strike numbers for the bow attack.")}
#enddef
		{ATTACK_QUESTIONS}
		{QUESTION_OPTIONS_END}

		[message]
		description=Delfador
		message= _ "End your turn, and wait for Merle to attack you."
		[/message]

		[event]
		name=new turn

		[message]
		description=Delfador
		message= _ "Your fighter has survived Merle's attack. Whenever a unit survives a battle, it gets experience from the combat. Once a unit gains enough experience, it advances to the next level, and becomes more powerful."
		[/message]
		
		{QUESTION_OPTIONS_START (_"What do I do next?")}
#define XP_QUESTIONS
{QUESTION_OPTION (_"What's experience?") (_"When a unit fights another unit, it gains experience, denoted 'XP', from the combat. The amount of experience gained is equal to the opponent's level, which is usually a representation of that unit's power. However, much more experience is gained from defeating an enemy unit. The amount of XP gained from killing an enemy is equal to 8 times the enemy's level.")}
{QUESTION_OPTION (_"What happens when a unit advances?") (_"When a unit advances, it transforms into a different unit type. This unit type is dependent on what the unit was originally, but occasionally there will be more than one choice of what to advance into. Advanced units are usually more powerful and 1 level higher than they were originally. Also, when a unit advances, it is healed completely and any handicaps that have been cast on it are removed. This is known as 'advance-heal'.")}
#enddef
		{XP_QUESTIONS}
		{QUESTION_OPTIONS_END}

		[message]
		description=Delfador
		message= _ "Move your fighter onto a village."
		[/message]

		{SET_OBJECTIVE (_"Move your fighter onto a village.")}

		[event]
		name=moveto
		
		[filter]
#		terrain=v
		x=01,09,16,22,19,13,16,21,06
		y=01,04,05,06,08,09,11,15,20
		type=Elvish Fighter
		[/filter]

		[message]
		description=Delfador
		message= _ "Villages heal the units on them."
		[/message]

		{QUESTION_OPTIONS_START (_"What do I do next?")}
#define VILLAGE_QUESTIONS
{QUESTION_OPTION (_"What happens when a unit moves onto a village?") (_"Whenever a unit moves onto a village, he flags the village for his side. This action takes all of the unit's remaining movement. Villages flagged for a side give the side several benefits, including giving the side an extra gold coin every turn, and reducing the total upkeep cost of that side's units by one. The total number of villages you control is also displayed on the status bar after the picture of a house. In addition to the economic benefit of villages, villages can be used in battle. Villages heal the units on them 8 HP per turn.")}
{QUESTION_OPTION (_"How do I heal when there aren't any villages nearby?") (_"There are ways to heal even without villages. If a unit does not move or attack for 1 turn, he heals 2 HP from resting. However if an enemy attacks him he cannot receive rest-heal. Also, there are some units which heal the units surrounding them. The Elvish Shaman is one such unit; units next to an Elvish Shaman are healed 4 HP per turn. Finally, whenever you beat a scenario all of your units are fully healed.")}
#enddef
		{VILLAGE_QUESTIONS}
		{QUESTION_OPTIONS_END}

		[message]
		description=Delfador
		message= _ "Now, you must defeat Merle by reducing her to 0 HP or lower. Just attack repeatedly."
		[/message]

		{SET_OBJECTIVE (_"Defeat Merle")}

		[/event]
		[/event]
		[/event]
		[/event]
		[/event]
	[/event]

	[event]
	name=moveto
	first_time_only=no

		[filter]
		description=Konrad
		[/filter]

		[message]
		description=Delfador
		message= _ "Oops! You moved your leader off of the keep. Remember, when your leader is not on a keep, you cannot recruit. Also remember that if your leader dies, you lose. In order to continue the tutorial, I will have to teleport you back onto your keep."
		[/message]

		[teleport]
			[filter]
			description=Konrad
			[/filter]
		x,y=17,10
		[/teleport]
	[/event]

	[event]
	name=die
		[filter]
		description=Konrad
		[/filter]

		[message]
		description=Delfador
		message= _ "Unfortunately, you lost, because your leader was defeated. Hopefully you have gained wisdom from my teachings anyway."
		[/message]
	[/event]

	[event]
	name=time over
		[message]
		description=Delfador
		message= _ "Unfortunately, you lost, because you ran out of time. Hopefully you have gained wisdom from my teachings anyway."
		[/message]
	[/event]

	[event]
	name=die
		[filter]
		side=3
		[/filter]

		[message]
		description=Delfador
		message= _ "You have successfully completed the first training scenario."
		[/message]

		{QUESTION_OPTIONS_START (_"Hooray!")}
#define VICTORY_QUESTIONS
{QUESTION_OPTION (_"How do I know how to complete a scenario? Will you always tell me?") (_"Sometimes it is not clear how to win a scenario just by listening to the dialog. In this case you need to look at the scenario objectives, which appear after the opening dialog. It can also be accessed by clicking 'Objectives' on the menu. The scenario objectives are a list of victory conditions and defeat conditions, and when any of the conditions are met, the scenario is over. Hopefully, it was a victory condition that was met.")}
{QUESTION_OPTION (_"What happens when I win a scenario?") (_"When you win a scenario, all of your units survive and are revived to full health, and you do not have to pay them for the remaining turns. Also, if your army remains in the area after you win, all villages surrender to you immediately after you win. However between scenarios, 20% of your gold is lost.")}
#enddef
		{VICTORY_QUESTIONS}
		{QUESTION_OPTIONS_END}

		[message]
		description=Delfador
		message= _ "Do you want to review any of the skills learned in this scenario?"

			[option]
			message= _ "Yes"
			[command]
				{QUESTION_OPTIONS_START (_"I'm done reviewing skills!")}
				{RECRUIT_QUESTIONS}
				{TURN_QUESTIONS}
				{MOVE_QUESTIONS}
				{ATTACK_QUESTIONS}
				{XP_QUESTIONS}
				{VILLAGE_QUESTIONS}
				{VICTORY_QUESTIONS}
				{QUESTION_OPTIONS_END}
			[/command]

			[/option]

			[option]
			message= _ "No"
			[/option]
		[/message]

		[message]
		description=Delfador
		message= _ "Although you have completed your first scenario, your training is not yet over. We will now proceed to the next scenario, in which you will fight me in a mock battle."
		[/message]

		[endlevel]
		next_scenario=tutorial-2
		bonus=yes
		[/endlevel]
	[/event]
[/tutorial]
